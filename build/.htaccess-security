# Prevenir ejecución de PHP en directorio de uploads
php_flag engine off

# Deshabilitar listado de directorio
Options -Indexes

# Deshabilitar ejecución de CGI
Options -ExecCGI

# Definir handlers para prevenir ejecución
AddHandler cgi-script .php .php3 .php4 .php5 .phtml .pl .py .jsp .asp .htm .shtml .sh .cgi

# Denegar acceso a archivos de backup y temporales
<FilesMatch "\\.(bak|backup|old|tmp|temp|~|swp)$">
    Require all denied
</FilesMatch>

# Denegar acceso a archivos de debug, test y diagnóstico
<FilesMatch "^(debug|test|diagnostico|fix|demo)">
    Require all denied
</FilesMatch>

# Denegar acceso a archivos de configuración
<FilesMatch "\\.(env|ini|conf|config)$">
    Require all denied
</FilesMatch>

# Permitir solo archivos de imagen y documento
<FilesMatch "\\.(jpg|jpeg|png|gif|webp|pdf|doc|docx|xls|xlsx|txt)$">
    Require all granted
</FilesMatch>
