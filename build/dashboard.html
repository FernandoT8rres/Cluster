<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="apple-touch-icon" sizes="76x76" href="./assets/img/apple-icon.png" />
  <link rel="icon" type="image/png" href="./assets/img/favicon.png" />
  <title>Clúster Intranet</title>
  <!--     Fonts and icons     -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet" />
  <!-- Font Awesome Icons - Multiple sources for reliability -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.1/css/all.css" />
  <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous" defer></script>

  <!-- Nucleo Icons -->
  <link href="./assets/css/nucleo-icons.css" rel="stylesheet" />
  <link href="./assets/css/nucleo-svg.css" rel="stylesheet" />
  <!-- Porsche-inspired Typography -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- Popper -->
  <script src="https://unpkg.com/@popperjs/core@2"></script>

  <!-- Swiper CSS and JS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

  <!-- GSAP for scroll animations -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
  <!-- Main Styling -->
  <link href="./assets/css/argon-dashboard-tailwind.css?v=1.0.1" rel="stylesheet" />

  <!-- Fix para evitar scaling de contenido y proteger diseño centrado -->
  <style>
    /* CSS Fix para evitar que el contenido se "agrande" por animaciones GSAP */

    /* PROTECCIÓN PRINCIPAL: Contenedores centrados inmutables */
    .max-w-7xl.mx-auto {
      transform: none !important;
      transition: none !important;
      will-change: auto !important;
      max-width: 80rem !important;
      margin-left: auto !important;
      margin-right: auto !important;
      padding-left: 1.5rem !important;
      padding-right: 1.5rem !important;
    }

    @media (min-width: 1024px) {
      .max-w-7xl.mx-auto {
        padding-left: 2rem !important;
        padding-right: 2rem !important;
      }
    }

    /* Proteger elementos hijos de max-w-7xl */
    .max-w-7xl .px-6,
    .max-w-7xl .lg\:px-8,
    .max-w-7xl * {
      transform: none !important;
      transition: none !important;
      will-change: auto !important;
    }

    /* Estabilizar elementos que tienen animaciones */
    .apple-card,
    .claut-card,
    .stats-option {
      transform-origin: center center !important;
      backface-visibility: hidden !important;
      will-change: opacity, transform !important;
    }

    /* Prevenir scaling no deseado en contenedores flexbox */
    .flex.flex-wrap.max-w-7xl,
    .w-full.max-w-full.px-3 {
      transform: none !important;
      scale: none !important;
    }

    /* Override para elementos que pueden tener conflictos */
    .apple-space-responsive.max-w-7xl {
      transform: none !important;
      transition-property: opacity !important;
    }

    /* Asegurar que no hay overflow por escalado */
    .max-w-7xl {
      overflow-x: hidden !important;
    }

    /* PROTECCIÓN CONTRA SCRIPTS CONFLICTIVOS */
    .max-w-7xl.mx-auto,
    .max-w-7xl.mx-auto * {
      /* Estos valores NO pueden ser sobrescritos por JavaScript posterior */
      margin-left: auto !important;
      margin-right: auto !important;
      padding-left: 1.5rem !important;
      padding-right: 1.5rem !important;
      width: auto !important;
      max-width: 80rem !important;
    }

    @media (min-width: 1024px) {

      .max-w-7xl.mx-auto,
      .max-w-7xl.mx-auto * {
        padding-left: 2rem !important;
        padding-right: 1rem !important;
        padding-top: 10px;
      }
    }
  </style>
  <style>
    /* Tema Oscuro Premium con Rojo Claut como Principal */
    :root {
      /* Paleta oscura premium */
      --claut-bg-main: #0a0a0a;
      /* Fondo principal negro profundo */
      --claut-bg-surface: #1a1a1a;
      /* Cards/tarjetas gris muy oscuro */
      --claut-bg-secondary: #242424;
      /* Superficie secundaria */
      --claut-bg-header: rgba(26, 26, 26, 0.95);
      /* Header oscuro con blur */
      --claut-bg-nav: rgba(36, 36, 36, 0.98);
      /* Nav superior con blur */

      /* Colores de texto - alta legibilidad en oscuro */
      --claut-text-primary: #ffffff;
      /* Texto principal blanco puro */
      --claut-text-secondary: #e5e5e7;
      /* Texto secundario gris claro */
      --claut-text-tertiary: #a1a1a6;
      /* Texto terciario gris medio */
      --claut-text-muted: #6e6e73;
      /* Texto deshabilitado */
      --claut-text-inverse: #1a1a1a;
      /* Texto sobre fondos claros */

      /* Color principal Claut oficial */
      --claut-red: #C7252B;
      /* Rojo Claut oficial */
      --claut-red-hover: #E8353B;
      /* Rojo hover más brillante */
      --claut-red-light: rgba(199, 37, 43, 0.2);
      /* Rojo con transparencia */
      --claut-red-dark: #A01E23;
      /* Rojo más oscuro */

      /* Colores de acento complementarios */
      --claut-accent-secondary: #28a745;
      /* Verde para success */
      --claut-accent-warning: #ffc107;
      /* Amarillo para warnings */
      --claut-accent-info: #17a2b8;
      /* Cyan para información */

      /* Bordes y separadores oscuros */
      --claut-border-light: rgba(255, 255, 255, 0.1);
      /* Bordes sutiles blancos */
      --claut-border-medium: rgba(255, 255, 255, 0.2);
      /* Bordes más visibles */
      --claut-divider: rgba(255, 255, 255, 0.08);
      /* Líneas divisorias */

      /* Sombras premium para tema oscuro */
      --claut-shadow-subtle: 0 1px 3px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.2);
      --claut-shadow-soft: 0 4px 12px rgba(0, 0, 0, 0.4), 0 2px 4px rgba(0, 0, 0, 0.3);
      --claut-shadow-medium: 0 8px 24px rgba(0, 0, 0, 0.5), 0 4px 8px rgba(0, 0, 0, 0.4);
      --claut-shadow-large: 0 16px 48px rgba(0, 0, 0, 0.6), 0 8px 16px rgba(0, 0, 0, 0.5);
      --claut-shadow-red: 0 4px 20px rgba(199, 37, 43, 0.3);
      /* Sombra roja para elementos destacados */

      /* Sistema tipográfico */
      --claut-font-system: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Inter', system-ui, sans-serif;
      --claut-font-mono: 'SF Mono', Monaco, 'Cascadia Code', monospace;

      /* Pesos tipográficos Apple */
      --apple-font-thin: 100;
      --apple-font-light: 300;
      --apple-font-regular: 400;
      --apple-font-medium: 500;
      --apple-font-semibold: 600;
      --apple-font-bold: 700;
      --apple-font-heavy: 800;
      --apple-font-black: 900;

      /* Sistema de espaciado Apple (8pt grid) */
      --space-1: 4px;
      /* 0.25rem */
      --space-2: 8px;
      /* 0.5rem */
      --space-3: 12px;
      /* 0.75rem */
      --space-4: 16px;
      /* 1rem */
      --space-5: 20px;
      /* 1.25rem */
      --space-6: 24px;
      /* 1.5rem */
      --space-8: 32px;
      /* 2rem */
      --space-10: 40px;
      /* 2.5rem */
      --space-12: 48px;
      /* 3rem */
      --space-16: 64px;
      /* 4rem */
      --space-20: 80px;
      /* 5rem */

      /* Border radius Apple */
      --radius-xs: 4px;
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --radius-xl: 20px;
      --radius-2xl: 24px;
      --radius-3xl: 32px;

      /* Transiciones Apple naturales */
      --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
      --transition-normal: 250ms cubic-bezier(0.4, 0, 0.2, 1);
      --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);
      --transition-spring: 400ms cubic-bezier(0.175, 0.885, 0.32, 1.275);

      /* Heights estándar */
      --header-height: 64px;
      --sidebar-width: 280px;
    }

    /* Reset y tipografía base - Tema oscuro */
    * {
      font-family: var(--claut-font-system) !important;
    }

    body {
      font-weight: var(--apple-font-regular);
      line-height: 1.47;
      letter-spacing: -0.022em;
      background: var(--claut-bg-main);
      /* Fondo negro profundo */
      color: var(--claut-text-primary);
      /* Texto blanco */
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }

    /* Correcciones de legibilidad para tema oscuro */
    .text-white {
      color: var(--claut-text-primary) !important;
    }

    .text-gray-600,
    .text-gray-700 {
      color: var(--claut-text-secondary) !important;
    }

    .text-gray-400,
    .text-gray-300 {
      color: var(--claut-text-tertiary) !important;
    }

    .text-gray-800,
    .text-gray-900,
    .text-black {
      color: var(--claut-text-primary) !important;
    }

    /* Asegurar que TODOS los textos sean legibles */
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      color: var(--claut-text-primary) !important;
    }

    p,
    span,
    div {
      color: var(--claut-text-secondary);
    }

    /* Correcciones adicionales para texto legible */
    .text-slate-500,
    .text-slate-600,
    .text-slate-700 {
      color: var(--claut-text-secondary) !important;
    }

    .text-slate-800,
    .text-slate-900 {
      color: var(--claut-text-primary) !important;
    }

    .text-xs,
    .text-sm,
    .text-base,
    .text-lg {
      color: inherit !important;
    }

    /* Asegurar legibilidad de labels y contenido */
    label,
    .label,
    .form-label {
      color: var(--claut-text-primary) !important;
    }

    /* Elementos de interfaz oscuros */
    input,
    textarea,
    select {
      background: var(--claut-bg-secondary) !important;
      color: var(--claut-text-primary) !important;
      border-color: var(--claut-border-light) !important;
    }

    /* Botones con tema oscuro */
    .btn {
      background: var(--claut-bg-secondary) !important;
      color: var(--claut-text-primary) !important;
      border-color: var(--claut-border-light) !important;
    }

    .btn-primary {
      background: var(--claut-red) !important;
      color: white !important;
    }

    .btn-secondary {
      background: var(--claut-bg-surface) !important;
      color: var(--claut-text-primary) !important;
    }

    /* Tipografía Premium para Tema Oscuro */
    .claut-title-hero {
      font-size: clamp(2.5rem, 5vw, 4rem);
      font-weight: var(--apple-font-heavy);
      line-height: 1.05;
      letter-spacing: -0.025em;
      color: var(--claut-text-primary);
    }

    .claut-title-large {
      font-size: clamp(1.75rem, 3vw, 2.5rem);
      font-weight: var(--apple-font-bold);
      line-height: 1.1;
      letter-spacing: -0.022em;
      color: var(--claut-text-primary);
    }

    .claut-title {
      font-size: clamp(1.25rem, 2vw, 1.75rem);
      font-weight: var(--apple-font-semibold);
      line-height: 1.2;
      letter-spacing: -0.018em;
      color: var(--claut-text-primary);
    }

    .claut-headline {
      font-size: 1.125rem;
      font-weight: var(--apple-font-semibold);
      line-height: 1.3;
      letter-spacing: -0.014em;
      color: var(--claut-text-primary);
    }

    .claut-body {
      font-size: 1rem;
      font-weight: var(--apple-font-regular);
      line-height: 1.47;
      letter-spacing: -0.011em;
      color: var(--claut-text-secondary);
    }

    .claut-caption {
      font-size: 0.875rem;
      font-weight: var(--apple-font-regular);
      line-height: 1.4;
      letter-spacing: -0.006em;
      color: var(--claut-text-tertiary);
    }

    /* Header Horizontal Premium con Menú Integrado */
    .claut-header {
      position: fixed !important;
      top: 0 !important;
      left: 0;
      right: 0;
      height: var(--header-height);
      background: rgba(26, 26, 26, 0.95);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 var(--space-6);
      transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
      box-shadow:
        0 1px 3px rgba(0, 0, 0, 0.3),
        0 4px 12px rgba(0, 0, 0, 0.15),
        0 0 0 1px rgba(255, 255, 255, 0.05) inset;
      will-change: transform, backdrop-filter;
      transform: translateY(0px) !important;
    }

    /* Header scroll effects */
    .claut-header.scrolled {
      background: rgba(26, 26, 26, 0.98) !important;
      box-shadow:
        0 2px 8px rgba(0, 0, 0, 0.4),
        0 8px 24px rgba(0, 0, 0, 0.25),
        0 0 0 1px rgba(255, 255, 255, 0.1) inset;
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      transform: translateY(0px) !important;
      position: fixed !important;
      top: 0 !important;
    }

    /* Logo area - usando el logo existente del sidebar */
    .claut-header-logo {
      display: flex;
      align-items: center;
      gap: var(--space-3);
      font-weight: var(--apple-font-bold);
      font-size: 1.25rem;
      color: rgba(255, 255, 255, 0.9);
      text-decoration: none;
      padding: var(--space-2);
      border-radius: 12px;
      transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
      position: relative;
      overflow: hidden;
    }

    .claut-header-logo:hover {
      color: var(--claut-red);
      background: rgba(var(--claut-red-rgb, 199, 37, 43), 0.08);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(var(--claut-red-rgb, 199, 37, 43), 0.15);
    }

    .claut-header-logo:hover img {
      transform: scale(1.05) rotate(2deg);
      filter: brightness(1.1);
    }

    .claut-header-logo img {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    /* Logo Hero Section - Profesional y elegante */
    .claut-hero-logo-container {
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    .claut-hero-logo {
      width: 220px;
      height: 220px;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      background: transparent;
      filter: drop-shadow(0 4px 8px rgba(199, 37, 43, 0.1));
    }

    /* Efecto de brillo sutil en el logo */
    .claut-hero-logo::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg,
          transparent 30%,
          rgba(255, 255, 255, 0.1) 50%,
          transparent 70%);
      transition: transform 0.6s ease;
      transform: translateX(-100%) translateY(-100%) rotate(45deg);
      z-index: 1;
    }

    /* Hover effects para el logo */
    .claut-hero-logo:hover {
      transform: scale(1.05) translateY(-4px);
      filter: brightness(1.1) hue-rotate(10deg) drop-shadow(0 8px 16px rgba(199, 37, 43, 0.2));
    }

    .claut-hero-logo:hover::before {
      transform: translateX(100%) translateY(100%) rotate(45deg);
    }

    /* Animación de pulsación eliminada - logo estático */

    /* Responsive del logo */
    @media (max-width: 768px) {
      .claut-hero-logo {
        width: 180px;
        height: 180px;
      }
    }

    @media (max-width: 480px) {
      .claut-hero-logo {
        width: 160px;
        height: 160px;
      }
    }

    /* Mejoras responsive adicionales */
    @media (max-width: 1024px) {
      .claut-title-hero {
        font-size: clamp(2rem, 4vw, 3rem);
        margin-bottom: 1rem;
      }

      .claut-hero-logo-container {
        margin-top: 20px !important;
      }
    }

    @media (max-width: 768px) {
      .claut-title-hero {
        font-size: clamp(1.75rem, 5vw, 2.5rem);
        text-align: center;
        padding: 0 1rem;
      }

      .claut-hero-logo-container {
        margin-top: 15px !important;
      }

      /* Mejorar spacing en mobile */

      /* Fix navbar responsivo */
      .porsche-navbar {
        margin: 0 !important;
        padding: 0 var(--space-3) !important;
        width: 100% !important;
        max-width: 100% !important;
      }

      .porsche-navbar .flex-wrap-inherit {
        padding: 0 !important;
      }
    }

    @media (max-width: 480px) {
      .claut-title-hero {
        font-size: clamp(1.5rem, 6vw, 2rem);
        line-height: 1.2;
      }

      .claut-hero-logo-container {
        margin-top: 10px !important;
        margin-bottom: 1.5rem !important;
      }

      /* Optimizar tarjetas estadísticas en móvil */
      .stats-cards-reveal {
        flex-direction: column;
        gap: 1rem;
      }

      .stats-cards-reveal>div {
        width: 100% !important;
        max-width: 100% !important;
      }
    }

    /* Navegación horizontal principal */
    .claut-header-nav {
      display: none;
      /* Hidden en mobile */
      flex: 1;
      justify-content: center;
      align-items: center;
      gap: var(--space-2);
      max-width: 100%;
      margin: 0 var(--space-1);
    }

    .claut-nav-item {
      display: flex;
      align-items: center;
      gap: var(--space-2);
      padding: var(--space-3) var(--space-4);
      border-radius: 12px;
      color: rgba(255, 255, 255, 0.8);
      text-decoration: none;
      font-weight: var(--apple-font-medium);
      font-size: 0.875rem;
      transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(10px);
      border: 1px solid transparent;
    }

    .claut-nav-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
      border-radius: inherit;
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: -1;
    }

    .claut-nav-item i {
      font-size: 0.875rem;
      opacity: 0.8;
      color: rgba(255, 255, 255, 0.8);
      transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
    }

    .claut-nav-item:hover {
      background: rgba(255, 255, 255, 0.12);
      color: rgba(255, 255, 255, 1);
      transform: translateY(-2px) scale(1.02);
      border-color: rgba(var(--claut-red-rgb, 199, 37, 43), 0.4);
      box-shadow:
        0 4px 16px rgba(0, 0, 0, 0.2),
        0 0 0 1px rgba(255, 255, 255, 0.15) inset;
    }

    .claut-nav-item:hover::before {
      opacity: 1;
    }

    .claut-nav-item:hover i {
      opacity: 1;
      transform: scale(1.1);
      color: var(--claut-red);
    }

    .claut-nav-item.active {
      background: linear-gradient(135deg, var(--claut-red), rgba(var(--claut-red-rgb, 199, 37, 43), 0.9));
      color: white;
      box-shadow:
        0 4px 16px rgba(var(--claut-red-rgb, 199, 37, 43), 0.3),
        0 8px 32px rgba(var(--claut-red-rgb, 199, 37, 43), 0.2),
        0 0 0 1px rgba(255, 255, 255, 0.2) inset;
      border-color: rgba(255, 255, 255, 0.2);
      transform: translateY(-1px);
    }

    .claut-nav-item.active i {
      opacity: 1;
      color: white;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    }

    /* Actions area */
    .claut-header-actions {
      display: flex;
      align-items: center;
      gap: var(--space-3);
    }

    .claut-header-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      border-radius: var(--radius-lg);
      background: transparent;
      border: none;
      color: rgba(255, 255, 255, 0.7);
      cursor: pointer;
      transition: all var(--transition-fast);
      position: relative;
    }

    .claut-header-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      color: rgba(255, 255, 255, 1);
      transform: scale(1.05);
    }

    .claut-header-btn.active {
      background: var(--claut-red);
      color: var(--claut-text-primary);
      box-shadow: var(--claut-shadow-red);
    }

    /* Responsive navigation */
    @media (min-width: 768px) {
      .claut-header-nav {
        display: flex;
      }
    }

    /* Mobile menu button */
    @media (max-width: 767px) {
      .claut-mobile-menu-btn {
        display: flex !important;
      }

      .claut-header-nav {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: var(--claut-bg-nav);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid var(--claut-border-light);
        flex-direction: column;
        padding: var(--space-4);
        gap: var(--space-1);
        transform: translateY(-100%);
        opacity: 0;
        visibility: hidden;
        transition: all var(--transition-normal);
      }

      .claut-header-nav.show {
        transform: translateY(0);
        opacity: 1;
        visibility: visible;
      }

      .claut-nav-item {
        width: 100%;
        justify-content: flex-start;
        padding: var(--space-3) var(--space-4);
      }
    }

    /* Sistema de Cards Premium para Tema Oscuro */
    .claut-card {
      background: var(--claut-bg-surface);
      border-radius: var(--radius-xl);
      box-shadow: var(--claut-shadow-soft);
      border: 1px solid var(--claut-border-light);
      transition: all var(--transition-slow);
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
    }

    .claut-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--claut-red), transparent);
      opacity: 0;
      transition: opacity var(--transition-normal);
    }

    .claut-card:hover {
      transform: translateY(-4px) scale(1.01);
      box-shadow: var(--claut-shadow-medium);
      border-color: var(--claut-border-medium);
    }

    .claut-card:hover::before {
      opacity: 1;
    }

    .claut-card-content {
      padding: var(--space-8);
    }

    /* Cards de estadísticas con tema oscuro */
    .claut-stat-card {
      background: var(--claut-bg-surface);
      border-radius: var(--radius-xl);
      border: 1px solid var(--claut-border-light);
      box-shadow: var(--claut-shadow-soft);
      transition: all var(--transition-slow);
      position: relative;
      overflow: hidden;
      padding: var(--space-8);
    }

    .claut-stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: var(--claut-red);
      transform: scaleX(0);
      transform-origin: left;
      transition: transform var(--transition-spring);
    }

    .claut-stat-card:hover {
      transform: translateY(-6px);
      box-shadow: var(--claut-shadow-large);
      border-color: var(--claut-red);
    }

    .claut-stat-card:hover::before {
      transform: scaleX(1);
    }

    /* Actualizaciones de compatibilidad para elementos existentes */
    .apple-card {
      background: var(--claut-bg-surface) !important;
      border: 1px solid var(--claut-border-light) !important;
      box-shadow: var(--claut-shadow-soft) !important;
    }

    .apple-stat-card {
      background: var(--claut-bg-surface) !important;
      border: 1px solid var(--claut-border-light) !important;
      box-shadow: var(--claut-shadow-soft) !important;
    }

    /* Apple-style Hero Sections */
    .apple-hero {
      min-height: 60vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, var(--apple-background) 0%, var(--apple-background-secondary) 100%);
      position: relative;
      overflow: hidden;
    }

    .apple-hero::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: radial-gradient(circle at 50% 50%, rgba(199, 37, 43, 0.05) 0%, transparent 50%);
      pointer-events: none;
    }

    /* Apple-style Animations */
    @keyframes appleSlideUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes appleScale {
      from {
        opacity: 0;
        transform: scale(0.95);
      }

      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    @keyframes appleFade {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    .apple-animate-slide-up {
      animation: appleSlideUp 0.8s var(--apple-transition-spring) forwards;
    }

    .apple-animate-scale {
      animation: appleScale 0.6s var(--apple-transition) forwards;
    }

    .apple-animate-fade {
      animation: appleFade 0.4s var(--apple-transition) forwards;
    }

    /* Scroll Animation Observer */
    .apple-scroll-reveal {
      opacity: 1 !important;
      transform: translateY(0) !important;
      transition: all 0.8s var(--apple-transition-spring);
    }

    .apple-scroll-reveal.revealed {
      opacity: 1;
      transform: translateY(0);
    }

    /* Force visibility for claut-scroll-reveal elements */
    .claut-scroll-reveal {
      opacity: 1 !important;
      transform: translateY(0) !important;
    }

    /* Ensure feature cards are fully visible */
    .apple-card.apple-scroll-reveal.claut-card.claut-scroll-reveal {
      opacity: 1 !important;
      visibility: visible !important;
      transform: translateY(0) !important;
      display: block !important;
      position: relative !important;
      z-index: 1 !important;
    }

    /* Social Media Icons Styles */
    .social-media-container {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      gap: 20px;
      padding: 40px 0;
    }

    .icon-box {
      display: inline-block;
      margin: 20px;
      cursor: pointer;
    }

    .icon-box a {
      display: block;
      background: var(--claut-bg-surface);
      border: 1px solid var(--claut-border-light);
      padding: 20px;
      position: relative;
      transform: perspective(1000px) rotate(-30deg) skew(25deg) translate(0, 0);
      box-shadow: -20px 20px 10px rgba(0, 0, 0, 0.3);
      transition: all 0.5s ease-in-out;
      border-radius: 8px;
    }

    .icon-box a::before {
      display: block;
      content: "";
      position: absolute;
      width: 20px;
      height: 100%;
      left: -20px;
      top: 10px;
      background: rgba(0, 0, 0, 0.5);
      transform: rotate(0deg) skewY(-45deg);
      border-radius: 0 0 8px 8px;
    }

    .icon-box a::after {
      display: block;
      content: "";
      position: absolute;
      bottom: -20px;
      left: -10px;
      height: 20px;
      width: 100%;
      background: rgba(0, 0, 0, 0.5);
      transform: rotate(0deg) skewX(-45deg);
      border-radius: 8px 0 0 0;
    }

    .icon-box a:hover {
      transform: perspective(1000px) rotate(-30deg) skew(25deg) translate(20px, -20px);
      box-shadow: -50px 50px 30px rgba(0, 0, 0, 0.4);
    }

    .icon-box a svg {
      color: white;
      font-size: 30pt;
      width: 30px;
      height: 30px;
    }

    .icon-box:nth-child(1) a svg {
      color: #CD201F;
    }

    .icon-box:nth-child(2) a svg {
      color: #1DA1F2;
    }

    .icon-box:nth-child(3) a svg {
      color: #FFFFFF;
    }

    .icon-box:nth-child(4) a svg {
      color: #0A66C2;
    }

    .icon-box:nth-child(5) a svg {
      color: #FF0063;
    }

    .icon-box:nth-child(6) a svg {
      color: #1877F2;
    }

    /* Forzar z-index máximo para el modal de mensajes */
    #messageModal {
      z-index: 999999 !important;
      position: fixed !important;
    }

    #messageContainer {
      z-index: 999999 !important;
      position: fixed !important;
    }

    /* Asegurar que no sea tapado por ningún elemento */
    #messageModal.show,
    #messageModal:not(.hidden) {
      z-index: 999999 !important;
    }

    /* Mejoras visuales para el buzón más grande */
    #messageModal #messagesContainer {
      scrollbar-width: thin;
      scrollbar-color: var(--claut-red) transparent;
    }

    #messageModal #messagesContainer::-webkit-scrollbar {
      width: 6px;
    }

    #messageModal #messagesContainer::-webkit-scrollbar-track {
      background: transparent;
    }

    #messageModal #messagesContainer::-webkit-scrollbar-thumb {
      background: var(--claut-red);
      border-radius: 3px;
    }

    #messageModal #messagesContainer::-webkit-scrollbar-thumb:hover {
      background: #A01E23;
    }

    /* Estilos específicos para imágenes en el buzón de mensajes */
    #messageModal img,
    #messageContainer img,
    #messagesList img,
    .comite-image-message img,
    .usuario-image-message img {
      max-width: 120px !important;
      max-height: 80px !important;
      width: auto !important;
      height: auto !important;
      object-fit: cover !important;
      border-radius: 8px !important;
      border: 1px solid rgba(199, 37, 43, 0.2) !important;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
      transition: all 0.2s ease !important;
    }

    /* Hover effect para las imágenes del buzón */
    #messageModal img:hover,
    #messageContainer img:hover,
    #messagesList img:hover {
      transform: scale(1.05) !important;
      box-shadow: 0 4px 12px rgba(199, 37, 43, 0.3) !important;
      cursor: pointer !important;
    }

    /* Contenedores de imágenes en mensajes */
    .comite-image-message,
    .usuario-image-message {
      max-width: 100% !important;
    }

    .comite-image-message img,
    .usuario-image-message img {
      display: block !important;
      margin: 0.5rem 0 !important;
    }

    /* Clase específica para imágenes en el buzón */
    .mailbox-image {
      max-width: 100px !important;
      max-height: 70px !important;
      width: auto !important;
      height: auto !important;
      object-fit: cover !important;
      border-radius: 6px !important;
      border: 1px solid rgba(199, 37, 43, 0.3) !important;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1) !important;
      transition: all 0.2s ease !important;
      display: inline-block !important;
      margin: 0.25rem 0 !important;
    }

    .mailbox-image:hover {
      transform: scale(1.1) !important;
      box-shadow: 0 4px 12px rgba(199, 37, 43, 0.4) !important;
      cursor: pointer !important;
      border-color: var(--claut-red) !important;
    }

    /* Para el modal de detalle de mensaje, mantener tamaño más grande */
    #messageDetailModal img,
    .detail-modal-image {
      max-width: 300px !important;
      max-height: 200px !important;
    }

    /* Asegurar que las imágenes del buzón se vean pequeñas en cualquier contexto */
    #messagesList .mailbox-image,
    #messagesContainer .mailbox-image {
      max-width: 90px !important;
      max-height: 60px !important;
    }

    /* Modal para ampliar imágenes */
    .image-preview-modal {
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      background: rgba(0, 0, 0, 0.9) !important;
      z-index: 9999999 !important;
      display: none !important;
      align-items: center !important;
      justify-content: center !important;
      backdrop-filter: blur(5px) !important;
    }

    .image-preview-modal.show {
      display: flex !important;
    }

    .image-preview-modal img {
      max-width: 80vw !important;
      max-height: 80vh !important;
      object-fit: contain !important;
      border-radius: 12px !important;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5) !important;
    }

    .image-preview-close {
      position: absolute !important;
      top: 20px !important;
      right: 20px !important;
      width: 40px !important;
      height: 40px !important;
      background: rgba(255, 255, 255, 0.2) !important;
      border: none !important;
      border-radius: 50% !important;
      color: white !important;
      font-size: 18px !important;
      cursor: pointer !important;
      backdrop-filter: blur(10px) !important;
      transition: all 0.2s ease !important;
    }

    .image-preview-close:hover {
      background: rgba(255, 255, 255, 0.3) !important;
    }

    /* Estilos específicos para el modal de detalle de mensaje */
    #messageDetailModal {
      z-index: 999999 !important;
    }

    #messageDetailContent {
      color: var(--claut-text-primary) !important;
    }

    #messageDetailContent p,
    #messageDetailContent div,
    #messageDetailContent span {
      color: var(--claut-text-primary) !important;
    }

    #messageDetailContent .text-gray-600,
    #messageDetailContent .text-gray-900,
    #messageDetailContent .text-sm {
      color: var(--claut-text-secondary) !important;
    }

    /* Asegurar que las imágenes del modal de detalle mantengan su tamaño correcto */
    #messageDetailContent .detail-modal-image {
      max-width: 300px !important;
      max-height: 200px !important;
      border-radius: 8px !important;
      border: 1px solid var(--claut-border-light) !important;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
    }

    /* Mejorar la apariencia de los enlaces en el modal */
    #messageDetailContent a {
      color: var(--claut-red) !important;
      text-decoration: underline !important;
    }

    #messageDetailContent a:hover {
      color: #b91c1c !important;
    }

    /* Apple-style Button System */
    .apple-btn {
      background: var(--apple-accent);
      color: var(--claut-text-primary);
      border: none;
      border-radius: var(--apple-radius-md);
      padding: var(--apple-space-md) var(--apple-space-xl);
      font-size: 1rem;
      font-weight: var(--apple-weight-medium);
      line-height: 1.2;
      transition: all 0.3s var(--apple-transition);
      cursor: pointer;
      position: relative;
      overflow: hidden;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
      min-height: 48px;
    }

    .apple-btn:hover {
      background: #0056cc;
      transform: translateY(-1px);
      box-shadow: var(--apple-shadow-md);
    }

    .apple-btn:active {
      transform: translateY(0);
      transition: transform 0.1s var(--apple-transition);
    }

    .apple-btn-secondary {
      background: var(--apple-surface);
      color: var(--apple-accent);
      border: 1px solid var(--apple-border);
    }

    .apple-btn-secondary:hover {
      background: var(--apple-accent);
      color: var(--claut-text-primary);
      border-color: var(--apple-accent);
    }

    /* Apple-style Layout System */
    .apple-layout {
      background: var(--apple-background);
      min-height: 100vh;
    }

    .apple-main {
      background: var(--apple-background-secondary);
      border-radius: var(--apple-radius-xl);
      box-shadow: var(--apple-shadow-sm);
      margin: var(--apple-space-md);
      transition: all 0.4s var(--apple-transition);
    }

    /* Enhanced Apple Responsive Design */
    @media (max-width: 768px) {
      .apple-title-hero {
        font-size: clamp(2rem, 8vw, 3rem);
        line-height: 1.1;
      }

      .apple-hero {
        min-height: 50vh;
        padding: var(--apple-space-xl) var(--apple-space-md);
      }

      .apple-card {
        margin-bottom: var(--apple-space-lg);
      }

      .apple-features-grid {
        grid-template-columns: 1fr;
        gap: var(--apple-space-lg);
      }
    }

    @media (max-width: 640px) {
      .apple-space-responsive {
        padding-left: var(--apple-space-md);
        padding-right: var(--apple-space-md);
      }
    }

    /* Apple-style Statistics Enhancements */
    .apple-stat-card {
      background: var(--apple-surface);
      border-radius: var(--apple-radius-lg);
      border: 1px solid var(--apple-border);
      box-shadow: var(--apple-shadow-sm);
      transition: all 0.4s var(--apple-transition);
      position: relative;
      overflow: hidden;
      padding: var(--apple-space-xl);
    }

    .apple-stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--apple-accent), var(--apple-accent-secondary));
      transform: scaleX(0);
      transform-origin: left;
      transition: transform 0.4s var(--apple-transition);
    }

    .apple-stat-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--apple-shadow-lg);
    }

    .apple-stat-card:hover::before {
      transform: scaleX(1);
    }

    /* Porsche-inspired Button System */
    .porsche-btn {
      background: var(--porsche-black);
      color: var(--claut-text-primary);
      border: none;
      border-radius: var(--porsche-radius-sm);
      padding: var(--porsche-space-xs) var(--porsche-space-md);
      font-size: 0.875rem;
      font-weight: var(--porsche-font-weight-medium);
      letter-spacing: 0.025em;
      text-transform: uppercase;
      transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    .porsche-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transition: left 0.6s;
    }

    .porsche-btn:hover {
      background: var(--porsche-charcoal);
      transform: translateY(-1px);
    }

    .porsche-btn:hover::before {
      left: 100%;
    }

    .porsche-btn-outline {
      background: transparent;
      color: var(--porsche-black);
      border: 1px solid var(--porsche-black);
    }

    .porsche-btn-outline:hover {
      background: var(--porsche-black);
      color: var(--claut-text-primary);
    }

    .porsche-btn-accent {
      background: var(--porsche-accent);
      color: var(--claut-text-primary);
    }

    .porsche-btn-accent:hover {
      background: #C7252B;
    }

    /* Porsche-inspired Statistics Cards */
    .porsche-stat-card {
      background: var(--claut-text-primary);
      border-radius: var(--porsche-radius-lg);
      border: 1px solid rgba(0, 0, 0, 0.04);
      box-shadow: var(--porsche-shadow-subtle);
      transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
      position: relative;
      overflow: hidden;
      padding: var(--porsche-space-lg);
    }

    .porsche-stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--porsche-accent), var(--porsche-charcoal));
      transform: scaleX(0);
      transform-origin: left;
      transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
    }

    .porsche-stat-card:hover {
      transform: translateY(-6px);
      box-shadow: var(--porsche-shadow-large);
    }

    .porsche-stat-card:hover::before {
      transform: scaleX(1);
    }

    .porsche-stat-number {
      font-size: 2.5rem;
      font-weight: var(--porsche-font-weight-bold);
      color: var(--porsche-black);
      letter-spacing: -0.03em;
      line-height: 1;
      margin-bottom: var(--porsche-space-xs);
    }

    .porsche-stat-label {
      font-size: 0.875rem;
      font-weight: var(--porsche-font-weight-medium);
      color: var(--porsche-silver);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* Porsche-inspired Layout System */
    .porsche-layout {
      background: linear-gradient(135deg, var(--porsche-light-gray) 0%, var(--claut-text-primary) 100%);
      min-height: 100vh;
    }

    .porsche-main {
      background: var(--claut-text-primary);
      border-radius: var(--porsche-radius-xl);
      box-shadow: var(--porsche-shadow-medium);
      margin: var(--porsche-space-sm);
      transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
    }

    /* Apple Sidebar Premium - Solucionando contraste y legibilidad */
    .apple-sidebar {
      background: var(--apple-bg-sidebar);
      /* Gris muy claro, no negro */
      border-radius: var(--radius-2xl);
      box-shadow: var(--apple-shadow-medium);
      border: 1px solid var(--apple-border-light);
      z-index: 999 !important;
      position: fixed !important;
      top: var(--header-height) !important;
      /* Debajo del header */
      left: 0 !important;
      height: calc(100vh - var(--header-height)) !important;
      width: var(--sidebar-width) !important;
      max-width: var(--sidebar-width) !important;
      transform: translateX(-100%) !important;
      transition: transform var(--transition-normal) !important;
      margin: var(--space-4) !important;
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
    }

    /* Sidebar visible state */
    .apple-sidebar.sidenav-show,
    .apple-sidebar[aria-expanded="true"] {
      transform: translateX(0) !important;
    }

    /* Logo y header del sidebar */
    .apple-sidebar .sidebar-header {
      padding: var(--space-6);
      border-bottom: 1px solid var(--apple-divider);
      background: var(--apple-bg-surface);
      border-radius: var(--radius-2xl) var(--radius-2xl) 0 0;
    }

    .apple-sidebar .apple-logo {
      color: var(--apple-text-primary);
      /* Texto oscuro, no blanco */
      font-weight: var(--apple-font-bold);
      font-size: 1.25rem;
      letter-spacing: -0.02em;
    }

    /* Navigation items del sidebar */
    .apple-nav-item {
      color: var(--apple-text-secondary);
      /* Siempre legible */
      transition: all var(--transition-fast);
      border-radius: var(--radius-md);
      margin: var(--space-1) var(--space-4);
      padding: var(--space-3) var(--space-4);
      display: flex;
      align-items: center;
      gap: var(--space-3);
      text-decoration: none;
      font-weight: var(--apple-font-medium);
    }

    .apple-nav-item:hover {
      background: var(--apple-border-light);
      /* Fondo sutil en hover */
      color: var(--apple-text-primary);
      transform: translateX(4px);
    }

    .apple-nav-item.active {
      background: var(--apple-accent);
      color: var(--apple-text-inverse);
      font-weight: var(--apple-font-semibold);
    }

    .apple-nav-item i {
      width: 20px;
      text-align: center;
    }

    /* Sidebar visible state */
    .porsche-sidebar.sidenav-show,
    .porsche-sidebar[aria-expanded="true"] {
      transform: translateX(0) !important;
    }

    /* Desktop sidebar */
    @media (min-width: 1280px) {
      .porsche-sidebar {
        transform: translateX(0) !important;
        position: fixed !important;
        z-index: 10 !important;
      }

      .porsche-main {
        margin-left: 272px !important;
      }
    }

    /* Mobile responsive */
    @media (max-width: 1279px) {
      .porsche-sidebar {
        transform: translateX(-100%) !important;
        z-index: 999 !important;
        width: 280px !important;
        max-width: 75vw !important;
      }

      .porsche-main {
        margin-left: 0 !important;
        width: 100% !important;
        padding-left: 0.5rem !important;
        padding-right: 0.5rem !important;
      }

      /* Mejorar navbar en móvil */
      .porsche-navbar {
        margin-left: 0 !important;
        margin-right: 0 !important;
        border-radius: var(--porsche-radius-md) !important;
      }

      /* Mejorar cards en móvil */
      .porsche-card {
        margin-left: 0 !important;
        margin-right: 0 !important;
      }

      /* Mejorar breadcrumb en móvil */
      .porsche-breadcrumb {
        margin-right: 0 !important;
      }

      /* Ajustar padding del contenido principal */
      main .w-full.px-6 {
        padding-left: 1rem !important;
        padding-right: 1rem !important;
      }
    }

    /* Tablet responsive */
    @media (max-width: 1023px) and (min-width: 768px) {
      .porsche-sidebar {
        width: 260px !important;
      }

      /* Ajustar grid en tablet */
      .flex.flex-wrap.-mx-3>div {
        padding-left: 0.5rem !important;
        padding-right: 0.5rem !important;
      }
    }

    /* Small mobile responsive */
    @media (max-width: 640px) {
      .porsche-sidebar {
        width: 80vw !important;
        max-width: 320px !important;
      }

      /* Ocultar texto en botones pequeños */
      .hidden.sm\\:inline {
        display: none !important;
      }

      /* Ajustar navbar */
      .porsche-navbar .flex-wrap-inherit {
        flex-direction: column !important;
        align-items: flex-start !important;
      }

      /* Hacer las tarjetas stack verticalmente */
      .lg\\:w-7\\/12,
      .lg\\:w-5\\/12 {
        width: 100% !important;
      }

      /* Ajustar spacing en móvil pequeño */
      main .w-full.px-6 {
        padding-left: 0.5rem !important;
        padding-right: 0.5rem !important;
      }

      /* Mejorar user menu en móvil */
      #userMenuContent {
        right: 0.5rem !important;
        left: 0.5rem !important;
        width: auto !important;
      }

      /* Ajustar botón hamburger */
      .xl\\:hidden {
        display: flex !important;
      }

      /* Mejorar responsividad de los gráficos */
      canvas {
        max-width: 100% !important;
        height: auto !important;
      }
    }

    /* Overlay for mobile */
    .sidenav-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      z-index: 998;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .sidenav-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .porsche-sidebar .porsche-logo {
      color: var(--claut-text-primary);
      font-weight: var(--porsche-font-weight-bold);
      font-size: 1.5rem;
      letter-spacing: -0.02em;
    }

    .porsche-nav-item {
      color: rgba(255, 255, 255, 0.8);
      transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
      border-radius: var(--porsche-radius-md);
      margin: var(--porsche-space-xs) 0;
    }

    .porsche-nav-item:hover {
      background: rgba(255, 255, 255, 0.1);
      color: var(--claut-text-primary);
      transform: translateX(4px);
    }

    .porsche-nav-item.active {
      background: var(--porsche-accent);
      color: var(--claut-text-primary);
    }

    /* Porsche-inspired Loading System */
    .porsche-loader {
      background: linear-gradient(90deg, var(--porsche-light-gray) 25%, #e8e8e8 50%, var(--porsche-light-gray) 75%);
      background-size: 400% 100%;
      animation: porscheShimmer 2s infinite;
      border-radius: var(--porsche-radius-md);
    }

    .porsche-spinner {
      width: 40px;
      height: 40px;
      border: 3px solid var(--porsche-light-gray);
      border-top: 3px solid var(--porsche-accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    /* Porsche-inspired Navbar */
    .porsche-navbar {
      background: rgba(26, 26, 26, 0.95);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 16px;
      padding: 16px 24px;
      margin: 0 24px 16px 24px;
      box-shadow:
        0 4px 16px rgba(0, 0, 0, 0.15),
        0 8px 32px rgba(0, 0, 0, 0.1),
        0 0 0 1px rgba(255, 255, 255, 0.05) inset;
      position: relative;
      z-index: 999;
    }

    .porsche-breadcrumb {
      font-size: 0.75rem;
      font-weight: var(--porsche-font-weight-medium);
      color: rgba(255, 255, 255, 0.7);
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .porsche-breadcrumb a {
      color: rgba(255, 255, 255, 0.5);
    }

    .porsche-welcome {
      font-size: 1.5rem;
      font-weight: var(--porsche-font-weight-bold);
      color: var(--claut-text-primary);
      letter-spacing: -0.02em;
    }

    /* Navbar content styling */
    .porsche-navbar .apple-user-info {
      color: var(--claut-text-primary);
    }

    .porsche-navbar .apple-nav-link {
      color: rgba(255, 255, 255, 0.8);
    }

    .porsche-navbar .apple-nav-link:hover {
      color: var(--claut-text-primary);
    }

    /* Fix layout issues - prevent content shifting */
    main.relative {
      margin-top: 0 !important;
      padding-top: 0 !important;
    }

    /* Reduce navbar padding to minimize spacing */
    nav.apple-navbar {
      padding-top: 0.25rem !important;
      padding-bottom: 0.25rem !important;
      margin-bottom: 0 !important;
    }

    /* Compact main content container */
    .w-full.px-6.pt-2.pb-6.mx-auto {
      margin-top: 0 !important;
      padding-top: 0.5rem !important;
    }

    /* Reduce breadcrumb spacing */
    .flex.flex-wrap.pt-1 {
      padding-top: 0.25rem !important;
    }

    /* Compact welcome message */
    #welcomeMessage {
      margin-bottom: 0.5rem !important;
    }

    /* Aggressive spacing fixes */
    .flex-wrap-inherit {
      padding-top: 0 !important;
      padding-bottom: 0 !important;
    }

    /* Remove any large margins from main elements */
    main>* {
      margin-top: 0 !important;
    }

    /* Ensure navbar doesn't create gaps */
    nav[navbar-main] {
      margin-bottom: 0 !important;
    }

    /* Fix any Tailwind spacing conflicts */
    .py-2 {
      padding-top: 0.25rem !important;
      padding-bottom: 0.25rem !important;
    }

    /* Sidebar fixes - remove margins that cause displacement */
    .sidebar-enhanced {
      margin: 0 !important;
      top: 0 !important;
      bottom: 0 !important;
    }

    aside.sidebar-enhanced {
      margin-top: 0 !important;
      margin-bottom: 0 !important;
      margin-left: 0 !important;
      margin-right: 0 !important;
    }

    /* Ensure main content doesn't inherit sidebar spacing */
    main.xl\\:ml-68 {
      margin-top: 0 !important;
    }

    /* Sidebar should NOT have modern-card effects */
    .sidebar-enhanced.modern-card,
    aside.modern-card {
      background: var(--claut-bg-surface) !important;
      border-radius: 1rem !important;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25) !important;
      transform: none !important;
      margin: 0 !important;
      position: fixed !important;
      top: 0 !important;
      bottom: 0 !important;
    }

    /* Prevent modern-card hover effects on sidebar */
    .sidebar-enhanced:hover,
    aside:hover {
      transform: none !important;
    }

    /* Ensure cards maintain proper spacing */
    .modern-card {
      margin-bottom: 0 !important;
    }

    /* Override any transforms that might cause layout issues */
    .modern-card:not(:hover) {
      transform: none !important;
    }

    /* Navbar fixes */
    .apple-navbar {
      position: relative !important;
      z-index: 10 !important;
    }

    /* Modern icons with hover effects */
    .icon-modern {
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      padding: 8px;
      border-radius: 12px;
      background: var(--clúster-red-alpha);
      color: var(--clúster-red);
    }

    .icon-modern:hover {
      background: var(--clúster-red);
      color: var(--claut-text-primary);
      transform: scale(1.1);
    }

    /* Floating elements */
    .float-element {
      animation: float 6s ease-in-out infinite;
    }

    @keyframes float {

      0%,
      100% {
        transform: translateY(0px);
      }

      50% {
        transform: translateY(-10px);
      }
    }

    /* Page entrance animation */
    .page-enter {
      animation: fadeInUp 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    /* Admin Panel Button Styles */
    #adminPanelButton a {
      background: linear-gradient(135deg, #c9302c, #a02622);
      box-shadow: 0 2px 8px rgba(201, 48, 44, 0.3);
      transition: all 0.3s ease;
    }

    #adminPanelButton a:hover {
      background: linear-gradient(135deg, #a02622, #8b1e1c);
      box-shadow: 0 4px 12px rgba(201, 48, 44, 0.5);
      transform: translateY(-1px);
    }

    /* Responsive design for admin button */
    @media (max-width: 1023px) {
      #adminPanelButton span {
        display: none !important;
      }

      #adminPanelButton a {
        padding: 0.5rem !important;
      }
    }

    .page-enter-delay-1 {
      animation: fadeInUp 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.1s both;
    }

    .page-enter-delay-2 {
      animation: fadeInUp 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.2s both;
    }

    .page-enter-delay-3 {
      animation: fadeInUp 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.3s both;
    }

    /* Modern table styling */
    .modern-table {
      border-collapse: separate;
      border-spacing: 0 8px;
    }

    .modern-table tr {
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
      transition: all 0.3s ease;
    }

    .modern-table tr:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    }

    .menu-icon {
      transition: opacity 0.3s ease;
    }

    .notification-toast {
      animation: slideIn 0.3s ease-out;
    }

    /* Estilos para secciones bloqueadas */
    /* Sección restringida eliminada - causaba bloqueos */

    .menu-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      border-radius: inherit;
      backdrop-filter: blur(5px);
    }

    .menu-message {
      background: white;
      padding: 2rem;
      border-radius: 1rem;
      text-align: center;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      max-width: 300px;
    }

    /* Transición suave para el menú de usuario */
    #userMenuContent {
      transition: all 0.2s ease;
      transform-origin: top right;
    }

    #userMenuContent.hidden {
      transform: scale(0.95);
      opacity: 0;
    }



    /* 🔧 SOLUCIÓN PERMANENTE DEL CARRUSEL - Forzar dimensiones desde CSS */
    #bannersSlider {
      width: 100% !important;
      height: 500px !important;
      min-height: 500px !important;
      max-height: 500px !important;
      position: relative !important;
      display: block !important;
      overflow: hidden !important;
      border-radius: 1rem !important;
    }

    /* Responsive heights */
    @media (max-width: 1024px) {
      #bannersSlider {
        height: 400px !important;
        min-height: 400px !important;
        max-height: 400px !important;
      }
    }

    @media (max-width: 768px) {
      #bannersSlider {
        height: 300px !important;
        min-height: 300px !important;
        max-height: 300px !important;
      }
    }

    /* Estilos para el slider de banners */
    .banner-slide {
      transition: opacity 0.5s ease-in-out;
    }

    .banner-slide-forced {
      transition: opacity 0.6s ease-in-out;
    }

    .slider-dot {
      transition: all 0.3s ease;
    }

    .slider-dot.active,
    .slider-dot.bg-white {
      width: 2rem;
    }

    /* Improved banner text containers with better transparency */
    .banner-text-container {
      background: rgba(0, 0, 0, 0.15) !important;
      backdrop-filter: blur(3px) !important;
      border: 1px solid rgba(255, 255, 255, 0.2) !important;
    }

    .banner-text-title {
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8), 0 1px 2px rgba(0, 0, 0, 0.6) !important;
    }

    .banner-text-description {
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.7), 0 1px 2px rgba(0, 0, 0, 0.5) !important;
    }

    #bannersSlider:hover #sliderBtnNext,
    #bannersSlider:hover #sliderBtnPrev {
      opacity: 1 !important;
    }

    /* Large screens optimization */
    @media (min-width: 1200px) {

      /* Enhanced statistics layout */
      .stats-cards-reveal {
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)) !important;
        gap: 2rem !important;
      }

      /* Larger expanding cards */
      .expanding-card {
        height: 400px !important;
        min-width: 250px !important;
      }

      /* Enhanced companies table */
      .companies-table {
        min-width: auto !important;
      }

      .company-logo {
        width: 60px !important;
        height: 60px !important;
      }
    }

    @media (min-width: 1400px) {

      /* Ultra-wide optimization */
      .stats-cards-reveal {
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)) !important;
        gap: 2.5rem !important;
      }

      .expanding-card {
        height: 450px !important;
        min-width: 300px !important;
      }

      .main-content-wrapper {
        max-width: 100% !important;
        margin: 0 !important;
      }
    }

    /* FORZAR SIDEBAR VISIBLE EN DESKTOP */
    @media (min-width: 1280px) {
      aside.sidebar-enhanced {
        transform: translateX(0) !important;
      }
    }

    /* Fix dropdown "Mi Cuenta" z-index positioning - Maximum priority */
    #userMenuDropdown {
      position: relative !important;
      z-index: 2147483647 !important;
    }

    #userMenuDropdown .relative {
      position: relative !important;
      z-index: 2147483647 !important;
    }

    #userMenuButton {
      position: relative !important;
      z-index: 2147483646 !important;
      pointer-events: auto !important;
    }

    #userMenuContent {
      position: fixed !important;
      z-index: 2147483647 !important;
      background: var(--claut-bg-surface) !important;
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2) !important;
      border: 1px solid rgba(0, 0, 0, 0.1) !important;
      transform: translateZ(1000px) !important;
      isolation: isolate !important;
    }

    /* Ensure all content stays below user menu */
    .porsche-card,
    .bg-white,
    .relative {
      z-index: 1 !important;
    }

    /* Force dropdown above everything */
    nav .relative {
      z-index: 9999 !important;
    }

    /* Force entire navbar to be on top */
    nav,
    .navbar,
    header {
      z-index: 99997 !important;
      position: relative !important;
    }

    /* Additional responsive improvements */

    /* Complete responsive design improvements */

    /* Responsive navigation */
    @media (max-width: 1024px) {
      .claut-header {
        padding: 0.5rem 1rem !important;
      }

      .nav-mobile-menu {
        display: block !important;
      }

      .nav-desktop-menu {
        display: none !important;
      }
    }

    /* Expanding cards responsive behavior */
    @media (max-width: 1024px) {
      .expanding-card {
        min-width: 150px !important;
        height: 300px !important;
      }

      .expanding-card.active {
        flex: 3 !important;
      }

      .expanding-card:not(.active) {
        flex: 1 !important;
      }

      #expandingCardsContainer {
        gap: 0.5rem !important;
        padding: 1rem !important;
      }
    }

    @media (max-width: 768px) {
      .expanding-card {
        min-width: 120px !important;
        height: 250px !important;
      }

      .card-label {
        font-size: 0.8rem !important;
        padding: 0.5rem !important;
      }

      .card-info h3 {
        font-size: 1rem !important;
      }

      .card-info p {
        font-size: 0.75rem !important;
      }
    }

    /* Companies table responsive */
    @media (max-width: 1024px) {
      .companies-table-container {
        overflow-x: auto !important;
        -webkit-overflow-scrolling: touch !important;
      }

      .companies-table {
        min-width: 600px !important;
      }

      .company-row {
        min-height: 60px !important;
      }

      .company-logo {
        width: 40px !important;
        height: 40px !important;
      }
    }

    @media (max-width: 768px) {
      .companies-table {
        min-width: 500px !important;
      }

      .company-name {
        font-size: 0.9rem !important;
      }

      .company-website {
        font-size: 0.8rem !important;
      }

      .company-button {
        padding: 0.5rem 1rem !important;
        font-size: 0.8rem !important;
      }
    }

    /* Statistics cards responsive improvements */
    @media (max-width: 1024px) {
      .stats-cards-reveal {
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)) !important;
        gap: 1rem !important;
      }
    }

    @media (max-width: 768px) {
      .stats-cards-reveal {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 0.75rem !important;
      }

      .xl\\:w-1\\/4 {
        width: 50% !important;
      }

      .sm\\:w-1\\/2 {
        width: 50% !important;
      }

      /* Mejorar el espaciado en móviles */
      .px-3 {
        padding-left: 0.5rem !important;
        padding-right: 0.5rem !important;
      }

      /* Asegurar que las tarjetas se vean bien en móvil */
      .porsche-card {
        margin-bottom: 1rem !important;
      }

      /* Mejorar el header del dashboard */
      .porsche-welcome {
        font-size: 1.125rem !important;
      }

      /* Optimizar el mensaje center para móvil */
      #messageModal .max-w-4xl {
        max-width: 95vw !important;
        margin: 1rem !important;
      }
    }

    /* Extra small devices - comprehensive mobile optimization */
    @media (max-width: 480px) {

      /* Layout optimization */
      .xl\\:w-1\\/4,
      .sm\\:w-1\\/2 {
        width: 100% !important;
      }

      /* Header mobile optimization */
      .claut-title-hero {
        font-size: clamp(1.5rem, 6vw, 2rem) !important;
        line-height: 1.2 !important;
        margin-bottom: 1rem !important;
      }

      .claut-hero-logo {
        width: 140px !important;
        height: 140px !important;
      }

      .claut-hero-logo-container {
        margin-top: 15px !important;
      }

      /* Expanding cards mobile optimization */
      .expanding-card {
        min-width: 70px !important;
        height: 180px !important;
      }

      .expanding-card.active {
        flex: 4 !important;
      }

      .expanding-card:not(.active) {
        flex: 0.7 !important;
      }

      #expandingCardsContainer {
        gap: 0.2rem !important;
        padding: 0.5rem !important;
        margin: 0 !important;
      }

      .card-label {
        font-size: 0.7rem !important;
        padding: 0.3rem !important;
      }

      .card-info h3 {
        font-size: 0.9rem !important;
      }

      .card-info p {
        font-size: 0.65rem !important;
      }

      /* Statistics cards single column */
      .stats-cards-reveal {
        grid-template-columns: 1fr !important;
        gap: 0.5rem !important;
        padding: 0 !important;
      }

      .stats-cards-reveal>div {
        width: 100% !important;
        max-width: 100% !important;
        margin: 0 !important;
      }

      /* Companies table mobile */
      .companies-table-container {
        margin: 0 -0.5rem !important;
      }

      .companies-table {
        min-width: 380px !important;
      }

      .company-logo {
        width: 30px !important;
        height: 30px !important;
      }

      .company-name {
        font-size: 0.75rem !important;
      }

      .company-website {
        font-size: 0.65rem !important;
        max-width: 100px !important;
        overflow: hidden !important;
        text-overflow: ellipsis !important;
        white-space: nowrap !important;
      }

      .company-button {
        padding: 0.3rem 0.6rem !important;
        font-size: 0.65rem !important;
        min-width: 50px !important;
      }

      /* Touch targets optimization */
      .expanding-card,
      .company-button,
      .message-tab,
      .claut-hero-logo {
        min-height: 44px !important;
        touch-action: manipulation !important;
      }

      /* Content spacing mobile */
      .main-content-wrapper {
        padding: 0.5rem !important;
      }

      .container {
        padding: 0 0.25rem !important;
      }

      /* Modal responsive */
      #messageModal #messageContainer {
        height: 60vh !important;
        min-height: 400px !important;
      }

      /* Sidebar más estrecho en pantallas muy pequeñas */
      .porsche-sidebar {
        width: 70vw !important;
        max-width: 280px !important;
      }

      /* Stack everything vertically en pantallas muy pequeñas */
      .flex.flex-wrap>div {
        width: 100% !important;
        margin-bottom: 1rem !important;
      }

      /* Ajustar navbar para pantallas muy pequeñas */
      .porsche-navbar {
        padding: 0.5rem !important;
      }

      /* Mejorar botones en móviles pequeños */
      button {
        min-height: 44px !important;
        /* Mejor para touch */
      }
    }

    /* Landscape orientation on mobile - enhanced */
    @media (max-width: 896px) and (orientation: landscape) {
      .porsche-sidebar {
        width: 240px !important;
      }

      /* Compact header for landscape */
      .claut-title-hero {
        font-size: 1.5rem !important;
        margin-bottom: 0.5rem !important;
      }

      .claut-hero-logo {
        width: 100px !important;
        height: 100px !important;
      }

      .claut-hero-logo-container {
        margin-top: 10px !important;
      }

      /* Horizontal layout for stats */
      .stats-cards-reveal {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)) !important;
        gap: 0.5rem !important;
      }

      /* Compact expanding cards */
      .expanding-card {
        height: 150px !important;
      }

      /* Reduce main content padding */
      .main-content-wrapper {
        padding: 0.5rem !important;
        margin: 0 !important;
        width: 100% !important;
        max-width: 100% !important;
      }

      /* Fix container responsivo */
      .claut-main {
        width: 100% !important;
        margin-left: 0 !important;
        padding: 0 !important;
      }

      .porsche-navbar {
        margin: 0 !important;
        padding: 0 0.5rem !important;
        width: 100% !important;
      }
    }

    /* Mejoras generales para touch devices */
    @media (pointer: coarse) {

      /* Enhanced touch targets */
      .expanding-card,
      .porsche-nav-item,
      .company-button,
      .message-tab,
      .stat-card,
      button {
        min-height: 44px !important;
        min-width: 44px !important;
        touch-action: manipulation !important;
      }

      /* Improved spacing for touch */
      .stats-cards-reveal {
        gap: 1rem !important;
      }

      #expandingCardsContainer {
        gap: 0.5rem !important;
      }

      /* Better hover states for touch */
      .expanding-card:hover,
      .expanding-card:focus {
        transform: scale(1.02) !important;
        transition: transform 0.2s ease !important;
      }

      /* Botones más grandes en dispositivos touch */
      .porsche-nav-item {
        min-height: 48px !important;
        padding: 0.75rem 1rem !important;
      }

      /* Mejor espaciado para touch */
      button,
      a {
        min-height: 44px !important;
      }
    }

    /* Estilos para el botón de cierre del sidebar */
    #sidebarCloseBtn {
      transition: all 0.3s ease;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255, 255, 255, 0.1);
    }

    #sidebarCloseBtn:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: scale(1.1);
    }

    /* Mejorar visibilidad en móvil */
    @media (max-width: 1279px) {
      .sidenav-overlay.show {
        opacity: 1;
        visibility: visible;
        z-index: 998;
      }

      .porsche-sidebar.sidenav-show {
        transform: translateX(0) !important;
        box-shadow: 5px 0 15px rgba(0, 0, 0, 0.3);
      }
    }

    /* Force navbar UL and LI elements above everything */
    nav ul,
    nav li {
      z-index: 99998 !important;
      position: relative !important;
    }

    /* Override any z-index on main content areas */
    main,
    .main-content,
    .porsche-main,
    .claut-main {
      z-index: 1 !important;
    }

    /* Force all navigation elements above content */
    nav .flex,
    nav .flex-row {
      z-index: 99998 !important;
      position: relative !important;
    }

    /* Specific override for the user menu container */
    #userMenuContent {
      position: fixed !important;
      z-index: 2147483647 !important;
    }

    /* Ensure statistics cards stay below */
    .porsche-card .relative,
    .bg-white .relative,
    [class*="relative"] {
      z-index: 1 !important;
    }

    /* Force statistics container and all children to stay below dropdown */
    #estadisticasContainer,
    #estadisticasContainer *,
    #estadisticasContainer .bg-white,
    #estadisticasContainer .relative,
    #estadisticasContainer .absolute,
    #estadisticasContainer .shadow-xl {
      z-index: 1 !important;
      isolation: auto !important;
      transform: none !important;
      background: var(--claut-bg-surface) !important;
      color: var(--claut-text-primary) !important;
    }

    /* Break stacking context for statistics */
    #estadisticasContainer {
      position: relative !important;
      z-index: 1 !important;
      isolation: auto !important;
    }

    /* Asegurar visibilidad de estadísticas dinámicas */
    #estadisticasContainer .apple-stat-card {
      background: var(--claut-bg-surface) !important;
      color: var(--claut-text-primary) !important;
      border: 1px solid var(--claut-border-light) !important;
    }

    #estadisticasContainer .apple-stat-card h3 {
      color: var(--claut-text-primary) !important;
    }

    #estadisticasContainer .apple-stat-card p {
      color: var(--claut-text-secondary) !important;
    }

    #estadisticasContainer .apple-stat-card .text-3xl,
    #estadisticasContainer .text-3xl {
      color: var(--claut-red) !important;
    }

    /* Force FontAwesome to load properly */
    @import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css');

    /* Ensure FontAwesome icons are displayed correctly */
    .fa,
    .fas,
    .far,
    .fal,
    .fab {
      font-family: "Font Awesome 6 Free", "Font Awesome 6 Pro", "FontAwesome" !important;
      font-weight: 900 !important;
      font-style: normal !important;
      display: inline-block !important;
      text-rendering: auto !important;
      -webkit-font-smoothing: antialiased !important;
    }

    /* Fallback for specific icons if FontAwesome fails */
    .fa-home::before {
      content: "\f015" !important;
    }

    .fa-calendar-alt::before {
      content: "\f073" !important;
    }

    .fa-file-alt::before {
      content: "\f15c" !important;
    }

    .fa-newspaper::before {
      content: "\f1ea" !important;
    }

    .fa-users::before {
      content: "\f0c0" !important;
    }

    .fa-headset::before {
      content: "\f590" !important;
    }

    .fa-handshake::before {
      content: "\f2b5" !important;
    }

    .fa-tags::before {
      content: "\f02c" !important;
    }

    .fa-user::before {
      content: "\f007" !important;
    }

    .fa-sign-in-alt::before {
      content: "\f2f6" !important;
    }

    .fa-user-plus::before {
      content: "\f234" !important;
    }

    .fa-sign-out-alt::before {
      content: "\f2f5" !important;
    }

    /* Fix chart canvas display */
    #chart-wrapper {
      visibility: visible !important;
      opacity: 1 !important;
    }

    #chart-line {
      display: block !important;
      visibility: visible !important;
    }

    /* Hide loading by default after a few seconds */
    .chart-loaded #chart-loading {
      display: none !important;
    }

    .chart-loaded #chart-wrapper {
      display: block !important;
    }

    /* Menú curvo animado en la parte inferior */
    .claut-bottom-nav {
      position: fixed !important;
      bottom: 0 !important;
      left: 50% !important;
      transform: translateX(-50%) !important;
      width: 95% !important;
      max-width: 600px !important;
      height: 70px !important;
      background: var(--claut-bg-surface) !important;
      border-radius: 35px 35px 0 0 !important;
      border: 1px solid var(--claut-border-medium) !important;
      border-bottom: none !important;
      box-shadow: 0 -10px 30px rgba(0, 0, 0, 0.4) !important;
      z-index: 9999 !important;
      overflow: hidden !important;
      backdrop-filter: blur(20px) !important;
      -webkit-backdrop-filter: blur(20px) !important;
      margin: 0 !important;
      padding: 0 !important;
    }

    .claut-bottom-nav::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 100%;
      background: linear-gradient(180deg, var(--claut-bg-surface) 0%, var(--claut-bg-secondary) 100%);
      opacity: 0.8;
      z-index: -1;
    }

    .claut-nav-container {
      position: relative !important;
      width: 100% !important;
      height: 100% !important;
      display: flex !important;
      align-items: center !important;
      justify-content: space-evenly !important;
      padding: 0 8px !important;
      box-sizing: border-box !important;
      overflow-x: auto !important;
      scrollbar-width: none !important;
      -ms-overflow-style: none !important;
    }

    .claut-nav-container::-webkit-scrollbar {
      display: none !important;
    }

    .claut-nav-link {
      position: relative !important;
      display: flex !important;
      flex-direction: column !important;
      align-items: center !important;
      justify-content: center !important;
      width: 48px !important;
      height: 48px !important;
      text-decoration: none !important;
      color: var(--claut-text-tertiary) !important;
      transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55) !important;
      border-radius: 50% !important;
      z-index: 2 !important;
      flex: 0 0 auto !important;
      margin: 0 2px !important;
    }

    .claut-nav-link i {
      font-size: 18px;
      transition: all 0.3s ease;
    }

    .claut-nav-link span {
      font-size: 9px;
      margin-top: 1px;
      opacity: 0;
      transform: translateY(10px);
      transition: all 0.3s ease;
      font-weight: 500;
    }

    .claut-nav-link.active {
      color: var(--claut-red);
      transform: translateY(-10px);
    }

    .claut-nav-link.active::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 50px;
      height: 50px;
      background: var(--claut-red);
      border-radius: 50%;
      z-index: -1;
      opacity: 0.2;
      animation: pulse 2s infinite;
    }

    .claut-nav-link.active span {
      opacity: 1;
      transform: translateY(0);
      color: var(--claut-red);
    }

    .claut-nav-link:hover {
      color: var(--claut-red);
      transform: translateY(-5px) scale(1.1);
    }

    .claut-nav-link:hover span {
      opacity: 1;
      transform: translateY(0);
    }

    /* Curva suave para el menú activo */
    .claut-nav-curve {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
    }

    .claut-nav-curve::before {
      content: '';
      position: absolute;
      top: 0;
      left: var(--curve-position, 20%);
      width: 60px;
      height: 60px;
      background: var(--claut-red);
      border-radius: 50% 50% 0 0;
      transform: translateX(-50%) translateY(-30px);
      transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      opacity: 0.1;
      box-shadow: 0 -5px 15px rgba(199, 37, 43, 0.3);
    }

    /* Animaciones */
    @keyframes pulse {
      0% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 0.2;
      }

      50% {
        transform: translate(-50%, -50%) scale(1.2);
        opacity: 0.1;
      }

      100% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 0.2;
      }
    }

    /* Responsivo */
    @media (max-width: 768px) {
      .claut-bottom-nav {
        width: 95%;
        height: 65px;
      }

      .claut-nav-link {
        width: 55px;
        height: 55px;
      }

      .claut-nav-link i {
        font-size: 20px;
      }
    }

    /* Ajuste para el contenido principal para evitar superposición con el menú inferior */
    .main-content {
      padding-bottom: 90px;
    }

    /* Control de visibilidad entre header y bottom nav */
    @media (max-width: 1024px) {
      .claut-header-nav {
        display: none !important;
      }

      .claut-bottom-nav {
        display: flex !important;
      }

      /* Mantener los botones de acción del header visibles */
      .claut-header-actions {
        display: flex !important;
      }

      /* Ajustar el header para que sea más compacto en mobile */
      .claut-header {
        padding: 0 var(--space-4) !important;
      }
    }

    @media (min-width: 1025px) {
      .claut-header-nav {
        display: flex !important;
      }

      .claut-bottom-nav {
        display: none !important;
      }

      .claut-header-actions {
        display: flex !important;
      }
    }

    /* Asegurar que el contenido tenga espacio para el menú inferior */
    body {
      padding-bottom: 0 !important;
    }

    @media (max-width: 1024px) {

      .porsche-main,
      .claut-main,
      main {
        padding-bottom: 90px !important;
        margin-bottom: 0 !important;
      }
    }

    /* CSS PROPERTIES PARA EFECTOS DE GLOW */
    @property --hue {
      syntax: "<number>";
      inherits: true;
      initial-value: 0;
    }

    @property --rotate {
      syntax: "<number>";
      inherits: true;
      initial-value: 0;
    }

    @property --bg-y {
      syntax: "<number>";
      inherits: true;
      initial-value: 0;
    }

    @property --bg-x {
      syntax: "<number>";
      inherits: true;
      initial-value: 0;
    }

    @property --glow-translate-y {
      syntax: "<number>";
      inherits: true;
      initial-value: 0;
    }

    @property --bg-size {
      syntax: "<number>";
      inherits: true;
      initial-value: 0;
    }

    @property --glow-opacity {
      syntax: "<number>";
      inherits: true;
      initial-value: 0;
    }

    @property --glow-blur {
      syntax: "<number>";
      inherits: true;
      initial-value: 0;
    }

    @property --glow-scale {
      syntax: "<number>";
      inherits: true;
      initial-value: 2;
    }

    @property --glow-radius {
      syntax: "<number>";
      inherits: true;
      initial-value: 2;
    }

    @property --white-shadow {
      syntax: "<number>";
      inherits: true;
      initial-value: 0;
    }

    /* ESTADÍSTICAS CON EFECTOS GLOW - LEGACY CLASS DISABLED */
    .stats-expandable-container.legacy-disabled {
      display: flex;
      flex-direction: row;
      align-items: stretch;
      overflow: hidden;
      min-width: 600px;
      max-width: 900px;
      width: calc(100% - 40px);
      height: 400px;
      margin: 0 auto;
      gap: 10px;
    }

    .stats-option {
      --card-color: var(--claut-bg-main);
      --text-color: var(--claut-text-secondary);
      --card-radius: 24px;
      --border-width: 2px;
      --bg-size: 1;
      --hue: 0;
      --hue-speed: 1;
      --rotate: 0;
      --animation-speed: 4s;
      --interaction-speed: 0.55s;
      --glow-scale: 1.5;
      --scale-factor: 1;
      --glow-blur: 6;
      --glow-opacity: 0.6;
      --glow-radius: 100;
      --glow-rotate-unit: 1deg;

      position: relative;
      min-width: 80px;
      margin: 0;
      cursor: pointer;
      transition: all 0.5s cubic-bezier(0.05, 0.61, 0.41, 0.95);
      flex-grow: 1;
      border-radius: var(--card-radius);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      z-index: 2;
    }

    /* Colores específicos para cada estadística */
    .stats-option.usuarios {
      --hue: 350;
    }

    .stats-option.empresas {
      --hue: 20;
    }

    .stats-option.convenios {
      --hue: 50;
    }

    .stats-option.mensajes {
      --hue: 140;
    }

    .stats-option.crecimiento {
      --hue: 220;
    }

    .stats-option.active {
      flex-grow: 10000;
      max-width: 600px;
    }

    .stats-option:hover {
      --glow-blur: 1.5;
      --glow-opacity: 0.8;
      --glow-scale: 2.5;
      --glow-radius: 0;
      --rotate: 900;
      --glow-rotate-unit: 0;
      --scale-factor: 1.15;
    }

    .stats-option:hover .stats-content {
      mix-blend-mode: darken;
      --text-color: white;
      box-shadow: 0 0 calc(var(--white-shadow) * 1vw) calc(var(--white-shadow) * 0.15vw) rgb(255 255 255 / 20%);
      animation: shadow-pulse calc(var(--animation-speed) * 2) linear infinite;
    }

    .stats-option:hover .stats-content:before {
      --bg-size: 15;
      animation-play-state: paused;
      transition: --bg-size var(--interaction-speed) ease;
    }

    .stats-option:hover .stats-glow {
      animation-play-state: paused;
    }

    .stats-option:hover .stats-glow:after {
      --glow-translate-y: 0;
      animation-play-state: paused;
      transition: --glow-translate-y 0s ease, --glow-blur 0.05s ease,
        --glow-opacity 0.05s ease, --glow-scale 0.05s ease,
        --glow-radius 0.05s ease;
    }

    .stats-option:before,
    .stats-option:after {
      content: "";
      display: block;
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: var(--card-radius);
    }

    .stats-content {
      position: absolute;
      width: 100%;
      height: 100%;
      background: var(--card-color);
      border-radius: calc(var(--card-radius) * 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      text-transform: uppercase;
      font-stretch: 150%;
      font-size: 18px;
      color: var(--text-color);
      padding: calc(40px / 8);
      flex-direction: column;
      gap: 8px;
    }

    .stats-content:before {
      content: "";
      display: block;
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: calc(var(--card-radius) * 0.9);
      box-shadow: 0 0 20px black;
      mix-blend-mode: color-burn;
      z-index: -1;
      background: var(--claut-bg-surface) radial-gradient(30% 30% at calc(var(--bg-x) * 1%) calc(var(--bg-y) * 1%),
          hsl(calc(var(--hue) * 1deg) 100% 90%) calc(0% * var(--bg-size)),
          hsl(calc(var(--hue) * 1deg) 100% 80%) calc(20% * var(--bg-size)),
          hsl(calc(var(--hue) * 1deg) 100% 60%) calc(40% * var(--bg-size)),
          transparent 100%);
      width: calc(100% + var(--border-width));
      height: calc(100% + var(--border-width));
      animation: hue-animation var(--animation-speed) linear infinite,
        rotate-bg var(--animation-speed) linear infinite;
      transition: --bg-size var(--interaction-speed) ease;
    }

    .stats-glow {
      --glow-translate-y: 0;
      display: block;
      position: absolute;
      width: calc(80px);
      height: calc(80px);
      animation: rotate var(--animation-speed) linear infinite;
      transform: rotateZ(calc(var(--rotate) * var(--glow-rotate-unit)));
      transform-origin: center;
      border-radius: calc(var(--glow-radius) * 1px);
    }

    .stats-glow:after {
      content: "";
      display: block;
      z-index: -2;
      filter: blur(calc(var(--glow-blur) * 10px));
      width: 130%;
      height: 130%;
      left: -15%;
      top: -15%;
      background: hsl(calc(var(--hue) * 1deg) 100% 60%);
      position: relative;
      border-radius: calc(var(--glow-radius) * 1px);
      animation: hue-animation var(--animation-speed) linear infinite;
      transform: scaleY(calc(var(--glow-scale) * var(--scale-factor) / 1.1)) scaleX(calc(var(--glow-scale) * var(--scale-factor) * 1.2)) translateY(calc(var(--glow-translate-y) * 1%));
      opacity: var(--glow-opacity);
    }

    .stats-number {
      display: inline-block;
      padding: 0.25em;
      border-radius: 4px;
      background: var(--claut-red);
      color: white;
      margin-bottom: 4px;
      font-weight: 900;
      font-size: 1.2rem;
      text-shadow: none;
    }

    .stats-label {
      font-size: 0.8rem;
      opacity: 0.9;
      color: var(--claut-text-secondary);
      text-transform: uppercase;
      letter-spacing: 1px;
      font-weight: 600;
    }

    /* Animaciones */
    @keyframes shadow-pulse {

      0%,
      24%,
      46%,
      73%,
      96% {
        --white-shadow: 0.5;
      }

      12%,
      28%,
      41%,
      63%,
      75%,
      82%,
      98% {
        --white-shadow: 2.5;
      }

      6%,
      32%,
      57% {
        --white-shadow: 1.3;
      }

      18%,
      52%,
      88% {
        --white-shadow: 3.5;
      }
    }

    @keyframes rotate-bg {
      0% {
        --bg-x: 0;
        --bg-y: 0;
      }

      25% {
        --bg-x: 100;
        --bg-y: 0;
      }

      50% {
        --bg-x: 100;
        --bg-y: 100;
      }

      75% {
        --bg-x: 0;
        --bg-y: 100;
      }

      100% {
        --bg-x: 0;
        --bg-y: 0;
      }
    }

    @keyframes rotate {
      from {
        --rotate: -70;
        --glow-translate-y: -65;
      }

      25% {
        --glow-translate-y: -65;
      }

      50% {
        --glow-translate-y: -65;
      }

      60%,
      75% {
        --glow-translate-y: -65;
      }

      85% {
        --glow-translate-y: -65;
      }

      to {
        --rotate: calc(360 - 70);
        --glow-translate-y: -65;
      }
    }

    @keyframes hue-animation {
      0% {
        --hue: 0;
      }

      100% {
        --hue: 360;
      }
    }

    /* Responsive */
    @media screen and (max-width: 798px) {
      .stats-expandable-container {
        min-width: 520px;
      }

      .stats-option:nth-child(5) {
        display: none;
      }
    }

    @media screen and (max-width: 718px) {
      .stats-expandable-container {
        min-width: 440px;
      }

      .stats-option:nth-child(4) {
        display: none;
      }
    }

    @media screen and (max-width: 638px) {
      .stats-expandable-container {
        min-width: 360px;
        height: 300px;
      }

      .stats-option:nth-child(3) {
        display: none;
      }
    }
  </style>
</head>

<body class="porsche-layout m-0 font-sans text-base antialiased font-normal leading-default"
  style="color: var(--claut-text-secondary);">
  <div
    class="absolute w-full bg-gradient-to-br from-porsche-charcoal via-porsche-black to-porsche-accent dark:hidden min-h-75">
  </div>

  <!-- Mobile Sidebar Overlay -->
  <div class="sidenav-overlay" id="sidenavOverlay"></div>

  <!-- Loading Spinner -->
  <div id="loadingSpinner" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="porsche-spinner"></div>
  </div>

  <!-- sidenav (oculto) -->
  <aside
    class="porsche-sidebar sidebar-enhanced fixed inset-y-0 flex-wrap items-center justify-between block w-full p-0 m-0 overflow-y-auto overflow-x-hidden antialiased transition-transform duration-200 border-0 max-w-64 ease-nav-brand z-990 xl:ml-6 xl:left-0 xl:translate-x-0 scroll-enhanced"
    aria-expanded="false" style="display: none !important;" sidenav-main>
    <div class="h-24 py-4 relative">
      <!-- Botón de cerrar para móvil -->
      <button class="xl:hidden absolute top-2 right-2 text-white hover:text-red-400 text-2xl z-50 p-2"
        id="sidebarCloseBtn" sidenav-close aria-label="Cerrar menú">
        <i class="fas fa-times"></i>
      </button>

      <a class="porsche-logo block px-8 m-0 text-center whitespace-nowrap" href="dashboard.html" target="_blank">
        <img src="./assets/img/apple-icon.png"
          class="block mx-auto h-20 w-20 max-w-full transition-all duration-200 ease-nav-brand mb-3" alt="main_logo" />
        <span class="block text-sm transition-all duration-200 ease-nav-brand text-white font-medium">Clúster
          Intranet</span>
      </a>
    </div>

    <hr
      class="h-px mt-0 bg-transparent bg-gradient-to-r from-transparent via-black/40 to-transparent dark:bg-gradient-to-r dark:from-transparent dark:via-white dark:to-transparent" />

    <div class="items-center block w-auto max-h-screen overflow-auto h-sidenav grow basis-full">
      <ul class="flex flex-col pl-0 mb-0">
        <li class="mt-0.5 w-full">
          <a class="porsche-nav-item active py-2.7 text-sm ease-nav-brand my-0 mx-2 flex items-center whitespace-nowrap px-4 transition-colors"
            href="dashboard.html">
            <div
              class="mr-2 flex h-8 w-8 items-center justify-center rounded-lg bg-center stroke-0 text-center xl:p-2.5">
              <i class="relative top-0 text-sm leading-normal fas fa-home"></i>
            </div>
            <span class="ml-1 duration-300 opacity-100 ease">Inicio</span>
          </a>
        </li>

        <li class="mt-0.5 w-full ">
          <a class="porsche-nav-item py-2.7 text-sm ease-nav-brand my-0 mx-2 flex items-center whitespace-nowrap px-4 transition-colors"
            href="empresas-convenio.html">
            <div
              class="mr-2 flex h-8 w-8 items-center justify-center rounded-lg bg-center stroke-0 text-center xl:p-2.5">
              <i class="relative top-0 text-sm leading-normal text-purple-500 fas fa-handshake"></i>
            </div>
            <span class="ml-1 duration-300 opacity-100 ease">Socios</span>
            <i class="fas fa-lock ml-auto text-xs text-gray-400 restricted-icon hidden"></i>
          </a>
        </li>

        <li class="mt-0.5 w-full ">
          <a class="porsche-nav-item py-2.7 text-sm ease-nav-brand my-0 mx-2 flex items-center whitespace-nowrap px-4 transition-colors"
            href="boletines.html">
            <div
              class="mr-2 flex h-8 w-8 items-center justify-center rounded-lg bg-center stroke-0 text-center xl:p-2.5">
              <i class="relative top-0 text-sm leading-normal fas fa-newspaper"></i>
            </div>
            <span class="ml-1 duration-300 opacity-100  ease">Boletines</span>
            <i class="fas fa-lock ml-auto text-xs text-gray-400 restricted-icon hidden"></i>
          </a>
        </li>

        <li class="mt-0.5 w-full ">
          <a class="porsche-nav-item py-2.7 text-sm ease-nav-brand my-0 mx-2 flex items-center whitespace-nowrap px-4 transition-colors"
            href="eventos.html">
            <div
              class="mr-2 flex h-8 w-8 items-center justify-center rounded-lg bg-center stroke-0 text-center xl:p-2.5">
              <i class="relative top-0 text-sm leading-normal fas fa-calendar-alt"></i>
            </div>
            <span class="ml-1 duration-300 opacity-100 ease">Eventos</span>
            <i class="fas fa-lock ml-auto text-xs text-gray-400 restricted-icon hidden"></i>
          </a>
        </li>

        <li class="mt-0.5 w-full ">
          <a class="porsche-nav-item py-2.7 text-sm ease-nav-brand my-0 mx-2 flex items-center whitespace-nowrap px-4 transition-colors"
            href="descuentos.html">
            <div
              class="mr-2 flex h-8 w-8 items-center justify-center rounded-lg bg-center stroke-0 text-center xl:p-2.5">
              <i class="relative top-0 text-sm leading-normal fas fa-tags"></i>
            </div>
            <span class="ml-1 duration-300 opacity-100 ease">Descuentos</span>
            <i class="fas fa-lock ml-auto text-xs text-gray-400 restricted-icon hidden"></i>
          </a>
        </li>

        <li class="mt-0.5 w-full ">
          <a class="porsche-nav-item py-2.7 text-sm ease-nav-brand my-0 mx-2 flex items-center whitespace-nowrap px-4 transition-colors"
            href="comites.html">
            <div
              class="mr-2 flex h-8 w-8 items-center justify-center rounded-lg bg-center stroke-0 text-center xl:p-2.5">
              <i class="relative top-0 text-sm leading-normal fas fa-users"></i>
            </div>
            <span class="ml-1 duration-300 opacity-100  ease">Comités</span>
            <i class="fas fa-lock ml-auto text-xs text-gray-400 restricted-icon hidden"></i>
          </a>
        </li>

        <li class="mt-0.5 w-full ">
          <a class="porsche-nav-item py-2.7 text-sm ease-nav-brand my-0 mx-2 flex items-center whitespace-nowrap px-4 transition-colors"
            href="contacto.html">
            <div
              class="mr-2 flex h-8 w-8 items-center justify-center rounded-lg bg-center stroke-0 text-center xl:p-2.5">
              <i class="relative top-0 text-sm leading-normal fas fa-headset"></i>
            </div>
            <span class="ml-1 duration-300 opacity-100  ease">Atención Directa</span>
            <i class="fas fa-lock ml-auto text-xs text-gray-400 restricted-icon hidden"></i>
          </a>
        </li>

        <li class="w-full mt-4">
          <h6 class="pl-6 ml-2 text-xs font-bold leading-tight uppercase text-white opacity-60">Cuenta</h6>
        </li>

        <li class="mt-0.5 w-full " id="profileMenuItem">
          <a class="porsche-nav-item py-2.7 text-sm ease-nav-brand my-0 mx-2 flex items-center whitespace-nowrap px-4 transition-colors"
            href="profile.html">
            <div
              class="mr-2 flex h-8 w-8 items-center justify-center rounded-lg bg-center stroke-0 text-center xl:p-2.5">
              <i class="relative top-0 text-sm leading-normal fas fa-user"></i>
            </div>
            <span class="ml-1 duration-300 opacity-100  ease">Perfil</span>
            <i class="fas fa-lock ml-auto text-xs text-gray-400 restricted-icon hidden"></i>
          </a>
        </li>

        <li class="mt-0.5 w-full" id="loginNavItem">
          <a class="porsche-nav-item py-2.7 text-sm ease-nav-brand my-0 mx-2 flex items-center whitespace-nowrap px-4 transition-colors"
            href="./pages/sign-in.html">
            <div
              class="mr-2 flex h-8 w-8 items-center justify-center rounded-lg bg-center stroke-0 text-center xl:p-2.5">
              <i class="relative top-0 text-sm leading-normal fas fa-sign-in-alt"></i>
            </div>
            <span class="ml-1 duration-300 opacity-100  ease">Iniciar Sesión</span>
          </a>
        </li>

        <li class="mt-0.5 w-full" id="signupNavItem">
          <a class="porsche-nav-item py-2.7 text-sm ease-nav-brand my-0 mx-2 flex items-center whitespace-nowrap px-4 transition-colors"
            href="./pages/sign-up.html">
            <div
              class="mr-2 flex h-8 w-8 items-center justify-center rounded-lg bg-center stroke-0 text-center xl:p-2.5">
              <i class="relative top-0 text-sm leading-normal fas fa-user-plus"></i>
            </div>
            <span class="ml-1 duration-300 opacity-100  ease">Regístrate</span>
          </a>
        </li>

        <!-- Agregar botón de logout para usuarios autenticados -->
        <li class="mt-0.5 w-full hidden" id="logoutMenuItem">
          <button id="logoutBtn"
            class="w-full dark:text-white dark:opacity-80 py-2.7 text-sm ease-nav-brand my-0 mx-2 flex items-center whitespace-nowrap px-4 transition-colors hover:bg-red-50">
            <div
              class="mr-2 flex h-8 w-8 items-center justify-center rounded-lg bg-center stroke-0 text-center xl:p-2.5">
              <i class="relative top-0 text-sm leading-normal text-red-500 fas fa-sign-out-alt"></i>
            </div>
            <span class="ml-1 duration-300 opacity-100 text-red">Cerrar Sesión</span>
          </button>
        </li>
      </ul>
    </div>

  </aside>

  <!-- Header Horizontal Premium con Menú Integrado -->
  <header class="claut-header">
    <!-- Logo area con logo existente -->
    <a href="#" class="claut-header-logo">
      <img src="./assets/img/apple-icon.png" alt="Clúster Logo" />
    </a>

    <!-- Navegación horizontal principal -->
    <nav class="claut-header-nav" id="clautMainNav">
      <a href="dashboard.html" class="claut-nav-item active">
        <i class="fas fa-home"></i>
        <span>Inicio</span>
      </a>
      <a href="./descuentos.html" class="claut-nav-item">
        <i class="fas fa-tags"></i>
        <span>Descuentos</span>
      </a>
      <a href="./boletines.html" class="claut-nav-item">
        <i class="fas fa-newspaper"></i>
        <span>Boletines</span>
      </a>
      <a href="./comites.html" class="claut-nav-item">
        <i class="fas fa-users"></i>
        <span>Comites</span>
      </a>
      <a href="./contacto.html" class="claut-nav-item">
        <i class="fas fa-headset"></i>
        <span>Contacto</span>
      </a>
      <a href="./eventos.html" class="claut-nav-item">
        <i class="fas fa-calendar-alt"></i>
        <span>Eventos</span>
      </a>
      <a href="./empresas-convenio.html" class="claut-nav-item">
        <i class="fas fa-handshake"></i>
        <span>Socios</span>
      </a>
      <a href="./admin-panel.html" class="claut-nav-item" id="adminNavItem" style="display: none;">
        <i class="fas fa-cogs"></i>
        <span>Admin</span>
      </a>
    </nav>

    <!-- Actions area -->
    <div class="claut-header-actions">

      <!-- Botón mensajes -->
      <button class="claut-header-btn" id="headerMessagesBtn" title="Centro de Mensajes">
        <i class="fas fa-envelope"></i>
        <span id="headerMessageCount"
          class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center hidden">0</span>
      </button>

      <!-- Menú usuario -->
      <div class="relative">
        <button class="claut-header-btn" id="headerUserMenuBtn" title="Mi cuenta">
          <i class="fas fa-user-circle text-lg"></i>
        </button>
      </div>

      <!-- Botón toggle menú móvil -->
      <button class="claut-header-btn claut-mobile-menu-btn hidden" id="mobileMenuBtn" title="Menú">
        <i class="fas fa-bars"></i>
      </button>
    </div>
  </header>

  <!-- end header -->

  <!-- Background Scroll Image - Fixed position behind everything -->
  <section class="scroll-image-section"
    style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -10; background: var(--claut-bg-main); overflow: hidden;">
    <div class="image-motion" style="transform-origin: 50% 0; transform: rotateX(90deg); width: 100%; height: 100%;">
      <picture>
        <img src="./css/moveimage.png" alt="Colaboración empresarial"
          style="width: 100%; height: 100%; object-fit: cover;">
      </picture>
    </div>
  </section>

  <main class="claut-main relative transition-all duration-200 ease-in-out main-scroll-container"
    style="margin-top: var(--header-height); margin-left: 0; padding: var(--space-4) var(--space-12) 0 var(--space-12); overflow: hidden; z-index: 1; position: relative;">
    <div class="main-content-wrapper relative z-10">
      <!-- Navbar (oculto - usando header horizontal) -->
      <nav
        class="porsche-navbar relative flex flex-wrap items-center justify-between px-0 py-1 transition-all ease-in shadow-none duration-250 rounded-2xl lg:flex-nowrap lg:justify-start"
        navbar-main navbar-scroll="false"
        style="display: flex; margin-top: 80px; margin-left: 120px; margin-right: 120px; z-index: 999999; position: relative;">
        <div class="flex items-center justify-between w-full px-6 py-0 mx-auto flex-wrap-inherit">
          <nav>
            <!-- breadcrumb -->
            <ol class="porsche-breadcrumb flex flex-wrap pt-1 mr-12 bg-transparent rounded-lg sm:mr-16">
              <li class="text-sm leading-normal">
                <a class="opacity-60" href="javascript:;">Intranet</a>
              </li>
              <li class="text-sm pl-2 capitalize leading-normal before:float-left before:pr-2 before:content-['/']"
                aria-current="page">Inicio</li>
            </ol>
            <!-- Mostrar saludo con usuario logueado -->
            <div id="welcomeMessage" class="mb-2">
              <h6 class="porsche-welcome mb-0 capitalize" id="welcomeText">Bienvenido a Clúster Intranet</h6>
            </div>
          </nav>

          <div class="flex items-center mt-2 grow sm:mt-0 sm:mr-6 md:mr-0 lg:flex lg:basis-auto">
            <div class="flex items-center md:ml-auto md:pr-4">
              <div class="relative flex flex-wrap items-stretch w-full transition-all rounded-lg ease">
                <!-- Mostrar información del usuario autenticado -->
                <div id="userInfo" class="apple-user-info text-white text-sm mr-4 hidden items-center">
                  <div class="flex flex-col">
                    <span id="userName" class="text-sm font-semibold"></span>
                    <span id="userRole" class="text-xs opacity-75"></span>
                  </div>
                </div>
              </div>
            </div>
            <ul class="flex flex-row justify-end pl-0 mb-0 list-none md-max:w-full">
              <!-- Menú para usuarios no autenticados -->
              <li class="flex items-center" id="loginMenuItem">
                <a href="./pages/sign-in.html"
                  class="apple-nav-link block px-0 py-2 text-sm font-semibold text-white transition-all ease-nav-brand hover:opacity-75">
                  <i class="fa fa-user sm:mr-1"></i>
                  <span class="hidden sm:inline">Iniciar Sesión</span>
                </a>
              </li>
              <!-- Botón Panel de Administración (solo para admins) -->
              <li class="flex items-center pl-4 hidden" id="adminPanelButton">
                <a href="https://intranet.clautmetropolitano.mx/build/admin-panel.html?login=success"
                  class="block px-3 py-2 text-sm font-semibold text-white transition-all ease-nav-brand hover:opacity-75 hover:bg-gray-800 hover:bg-opacity-20 rounded-lg"
                  title="Panel de Administración">
                  <i class="fas fa-cogs mr-2"></i>
                  <span class="hidden lg:inline">Admin Panel</span>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- end Navbar -->

      <!-- Main content con spacing Apple -->
      <div class="w-full apple-space-responsive content-gradient-container"
        style="max-width: 100%; margin: 0 auto; padding: 0 var(--space-8); position: relative;">
        <!-- Unified gradient background for seamless transitions -->
        <div class="unified-gradient-background"></div>

        <!-- Hero Section Premium Tema Oscuro -->
        <section class="claut-hero claut-scroll-reveal"
          style="margin: var(--space-8) 0 var(--space-16) 0; min-height: 60vh; display: flex; align-items: center; justify-content: center; position: relative;">
          <!-- Efectos de fondo premium -->
          <div
            style="position: absolute; inset: 0; background: radial-gradient(circle at 50% 50%, rgba(199, 37, 43, 0.1) 0%, transparent 50%);">
          </div>

          <div class="text-center max-w-4xl mx-auto" style="z-index: 1;">
            <h1 class="claut-title-hero mb-6" style="margin-top: 30px;">
              Bienvenido a
              <span
                style="background: linear-gradient(135deg, #C7252B 0%, #C7252B 100%); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; color: transparent;">
                Clúster Intranet
              </span>
            </h1>

            <!-- Logo Claut con animaciones profesionales -->
            <div class="claut-hero-logo-container mb-8" style="margin-top: 30px;">
              <img src="./assets/img/apple-icon.png" alt="Clúster Metropolitano Logo" class="claut-hero-logo">
            </div>
            <!-- Social Media Icons -->
            <div class="social-media-container">

              <div class="icon-box">
                <a href="https://www.linkedin.com/company/clusterautomotrizmetropolitano" target="_blank"
                  class="icon-link">
                  <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor"
                    class="bi bi-linkedin" viewBox="0 0 16 16">
                    <path
                      d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z" />
                  </svg>
                </a>
              </div>

              <div class="icon-box">
                <a href="https://www.instagram.com/claumetro" target="_blank" class="icon-link">
                  <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor"
                    class="bi bi-instagram" viewBox="0 0 16 16">
                    <path
                      d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.917 3.917 0 0 0-1.417.923A3.927 3.927 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.916 3.916 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.926 3.926 0 0 0-.923-1.417A3.911 3.911 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0h.003zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599.28.28.453.546.598.92.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.47 2.47 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.478 2.478 0 0 1-.92-.598 2.48 2.48 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233 0-2.136.008-2.388.046-3.231.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92.28-.28.546-.453.92-.598.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045v.002zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92zm-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217zm0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334z" />
                  </svg>
                </a>
              </div>

              <div class="icon-box">
                <a href="https://www.facebook.com/Clautmet/" target="_blank" class="icon-link">
                  <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor"
                    class="bi bi-facebook" viewBox="0 0 16 16">
                    <path
                      d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951z" />
                  </svg>
                </a>
              </div>
            </div>
          </div>
        </section>

        <!-- Mensaje para usuarios no autenticados -->
        <div id="authRequiredMessage" class="hidden mb-8 apple-card apple-scroll-reveal">
          <div class="p-8">
            <div class="flex items-center">
              <div class="flex-shrink-0">
                <div
                  class="w-16 h-16 bg-gradient-to-br from-amber-400 to-orange-500 rounded-xl flex items-center justify-center">
                  <i class="fas fa-lock text-white text-2xl"></i>
                </div>
              </div>
              <div class="flex-1 ml-6">
                <h3 class="apple-headline mb-2">Acceso Restringido</h3>
                <p class="apple-body">Para acceder a todas las funcionalidades de Clúster Intranet, por favor inicia
                  sesión con tu cuenta.</p>
              </div>
              <div class="flex-shrink-0 ml-6">
                <a href="./pages/sign-in.html" class="apple-btn">
                  <i class="fas fa-sign-in-alt mr-2"></i>
                  Iniciar Sesión
                </a>
              </div>
            </div>
          </div>
        </div>

        <!-- Showcase Banners Section -->
        <div class="max-w-7xl mx-auto px-6 lg:px-8"
          style="margin-top: 40px; margin-bottom: 30px; transform: none !important; transition: none !important;">

          <!-- Section Header -->
          <div class="text-center mb-8">
            <div class="inline-flex items-center px-5 py-2 bg-gradient-to-r from-red-50 via-red-100 to-red-50 border border-red-200 rounded-full text-red-700 text-sm font-semibold mb-6 shadow-sm">
              <i class="fas fa-bullhorn mr-2 text-red-600"></i>
              PROMOCIONES & CAMPAÑAS ACTIVAS
            </div>
            <h2 class="text-4xl md:text-6xl font-bold bg-gradient-to-r from-gray-900 via-red-800 to-gray-900 bg-clip-text text-transparent mb-6 leading-tight tracking-tight">
              Centro de <span class="text-red-600">Promociones</span>
            </h2>
            <div class="max-w-4xl mx-auto">
              <p class="text-xl md:text-2xl text-gray-600 leading-relaxed mb-4">
                Descubre las <span class="text-red-600 font-semibold">últimas campañas promocionales</span> y ofertas exclusivas del Clúster Metropolitano
              </p>
              <p class="text-base text-gray-500 leading-relaxed">
                Contenido publicitario oficial • Promociones verificadas • <span class="text-red-600 font-medium">Actualizado en tiempo real</span>
              </p>
            </div>
          </div>

          <!-- Expanding Cards Banner Showcase -->
          <div class="bg-gradient-to-br from-white via-gray-50 to-white shadow-2xl h-[700px] lg:h-[750px] relative overflow-hidden rounded-3xl border border-gray-200"
            style="transform: none !important; will-change: auto !important;">
            <!-- Header with Enhanced Effects -->
            <div class="flex items-center justify-between p-6 pb-3 group">
              <div class="flex items-center space-x-3">
                <div class="w-3 h-3 bg-red-500 rounded-full"></div>
                <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                <div class="w-3 h-3 bg-green-500 rounded-full"></div>
              </div>
              <div class="text-sm text-gray-500 font-medium">Haz doble click en cualquier imagen para ampliarla</div>
            </div>

                <!-- Expanding Cards Container with Enhanced Scroll Effects -->
                <div class="expanding-options px-6 pb-6 h-full scroll-smooth">
                  <div id="expandingCardsContainer" class="options-container transform transition-all duration-500"
                    style="margin: var(--space-8) var(--space-6);">
                    <!-- Loading state with improved styling -->
                    <div id="cardsLoading" class="flex items-center justify-center h-full">
                      <div class="text-center transform transition-all duration-500">
                        <div class="relative mb-4">
                          <div class="w-16 h-16 border-4 border-gray-300 rounded-full"></div>
                          <div
                            class="absolute top-0 w-16 h-16 border-4 border-red-500 border-t-transparent rounded-full animate-spin">
                          </div>
                        </div>
                        <p class="text-gray-600 text-lg font-medium mb-2">Cargando galería...</p>
                        <p class="text-gray-400 text-sm">Preparando contenido visual</p>
                      </div>
                    </div>
                    <!-- Cards will be loaded dynamically here -->
                  </div>
                </div>
            </div>
          </div>
        </div>

        <!-- Image Expansion Modal -->
        <div id="imageExpansionModal" class="image-modal-overlay">
          <div class="image-modal-container">
            <div class="image-modal-header">
              <h3 id="modalImageTitle" class="image-modal-title">Imagen</h3>
              <button onclick="closeImageModal()" class="image-modal-close">
                <i class="fas fa-times"></i>
              </button>
            </div>
            <div class="image-modal-content">
              <img id="modalImage" src="" alt="Imagen ampliada" class="image-modal-img">
              <div class="image-modal-controls">
                <button onclick="downloadModalImage()" class="image-modal-btn download-btn">
                  <i class="fas fa-download"></i>
                  Descargar
                </button>
                <button onclick="shareModalImage()" class="image-modal-btn share-btn">
                  <i class="fas fa-share"></i>
                  Compartir
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Script de carrusel usando lógica de sign-in.html -->
        <script>
          // Sistema de Carrusel de Banners (copiado de sign-in.html)
          let currentSlide = 0;
          let banners = [];
          let carouselInterval = null;

          async function cargarBannerCarrusel() {
            try {
              console.log('Iniciando carga de banners...');
              // Agregar timestamp para evitar caché
              const timestamp = Date.now();
              const response = await fetch(`./api/banners.php?action=active&t=${timestamp}`, {
                cache: 'no-cache',
                headers: {
                  'Cache-Control': 'no-cache',
                  'Pragma': 'no-cache'
                }
              });

              // Verificar si la respuesta es OK
              if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
              }

              // Obtener el texto primero para verificar si hay warnings
              const responseText = await response.text();
              console.log('Respuesta raw del servidor:', responseText);

              // Limpiar warnings de PHP si existen (empiezan con <br />)
              let cleanedResponse = responseText;
              if (responseText.includes('<br />')) {
                // Encontrar donde empieza el JSON (buscar el primer {)
                const jsonStart = responseText.indexOf('{');
                if (jsonStart !== -1) {
                  cleanedResponse = responseText.substring(jsonStart);
                }
              }

              // Parsear el JSON limpio
              const result = JSON.parse(cleanedResponse);
              console.log('Datos parseados:', result);

              if (result.success && result.data && result.data.length > 0) {
                // Usar banners de la base de datos
                banners = result.data;
                console.log(`✅ Cargados ${banners.length} banners de la base de datos:`, banners);
                inicializarCarruselDashboard();
                // Ocultar loading cuando hay banners
                const sliderLoading = document.getElementById('sliderLoading');
                if (sliderLoading) {
                  sliderLoading.style.display = 'none';
                }
              } else {
                console.warn('❌ No hay banners activos en la base de datos');
                console.log('Respuesta completa:', result);
                // En lugar de mostrar mensaje, usar banners de demostración
                usarBannersDemo();
              }
            } catch (error) {
              console.error('❌ Error al cargar banners:', error);
              console.error('Error completo:', error.message);
              // En caso de error, usar banners de demostración
              usarBannersDemo();
            }
          }

          function usarBannersDemo() {
            console.log('🎨 Usando banners de demostración...');
            banners = [
              {
                titulo: 'Bienvenido a Clúster Intranet',
                descripcion: 'Tu plataforma de gestión empresarial',
                imagen_url: 'https://images.unsplash.com/photo-1521737604893-d14cc237f11d?ixlib=rb-4.0.3&auto=format&fit=crop&w=2000&q=80'
              },
              {
                titulo: 'Nuevas Funcionalidades',
                descripcion: 'Descubre las últimas características de la plataforma',
                imagen_url: 'https://images.unsplash.com/photo-1522071820081-009f0129c71c?ixlib=rb-4.0.3&auto=format&fit=crop&w=2000&q=80'
              },
              {
                titulo: 'Empresas Destacadas',
                descripcion: 'Explora las empresas que forman parte de nuestro clúster',
                imagen_url: 'https://images.unsplash.com/photo-1556745757-8d76bdb6984b?ixlib=rb-4.0.3&auto=format&fit=crop&w=2000&q=80'
              }
            ];

            inicializarCarruselDashboard();
            document.getElementById('sliderLoading').style.display = 'none';
          }

          function inicializarCarruselDashboard() {
            const slidesContainer = document.getElementById('slidesContainer');
            const sliderLoading = document.getElementById('sliderLoading');

            if (!slidesContainer) {
              console.error('❌ Container slidesContainer no encontrado');
              return;
            }

            console.log('Inicializando carrusel con banners:', banners);

            // Ocultar loading
            if (sliderLoading) {
              sliderLoading.style.display = 'none';
            }

            // Crear slides usando la estructura del dashboard
            console.log('🖼️ Creando slides con banners:', banners);

            // Limpiar completamente el contenedor
            slidesContainer.innerHTML = '';

            if (banners.length === 0) {
              console.warn('⚠️ No hay banners para mostrar');
              mostrarMensajeSinBanners();
              return;
            }

            banners.forEach((banner, index) => {
              const imagenUrl = banner.imagen_url || banner.imagen || '';
              console.log(`🎨 Banner ${index + 1}:`, {
                titulo: banner.titulo,
                descripcion: banner.descripcion,
                imagen_url: imagenUrl,
                index: index
              });

              // Crear elemento directamente con JavaScript
              const slideElement = document.createElement('div');
              slideElement.className = `absolute inset-0 transition-opacity duration-500 ${index === 0 ? 'opacity-100' : 'opacity-0'}`;
              slideElement.setAttribute('data-slide-index', index);

              // Aplicar estilos directamente
              slideElement.style.cssText = `
                  background-image: url('${imagenUrl}');
                  background-size: cover;
                  background-position: center;
                  background-repeat: no-repeat;
                  width: 100%;
                  height: 100%;
                  border-radius: 1rem;
                  position: absolute;
                  top: 0;
                  left: 0;
                  right: 0;
                  bottom: 0;
              `;

              slideElement.innerHTML = `
                  <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent rounded-2xl"></div>
                  <div class="absolute bottom-8 left-8 text-white z-10" style="z-index: 20; max-width: 80%;">
                      <h3 class="text-2xl font-bold mb-2 drop-shadow-lg text-white">
                          ${banner.titulo || 'Banner ' + (index + 1)}
                      </h3>
                      <p class="text-lg opacity-90 drop-shadow-md text-white">
                          ${banner.descripcion || ''}
                      </p>
                  </div>
              `;

              slidesContainer.appendChild(slideElement);
              console.log(`✅ Slide ${index + 1} creado y agregado al DOM`);

              // Test de carga de imagen
              const img = new Image();
              img.onload = () => {
                console.log(`🖼️ Imagen ${index + 1} cargada correctamente: ${imagenUrl}`);
              };
              img.onerror = () => {
                console.error(`❌ Error cargando imagen ${index + 1}: ${imagenUrl}`);
              };
              img.src = imagenUrl;
            });

            console.log(`🏁 Total slides creados: ${slidesContainer.children.length}`);

            // Crear indicadores (dots)
            crearIndicadores();

            // Iniciar autoplay si hay más de un banner
            if (banners.length > 1) {
              console.log('Iniciando autoplay para', banners.length, 'banners');
              iniciarAutoplay();
            } else {
              console.log('Solo hay un banner, no se activa autoplay');
            }
          }

          function crearIndicadores() {
            const indicatorsContainer = document.getElementById('sliderIndicators');
            if (!indicatorsContainer) return;

            indicatorsContainer.innerHTML = '';

            banners.forEach((_, index) => {
              const dot = document.createElement('button');
              dot.className = `slider-dot w-2 h-2 rounded-full transition-all duration-300 ${index === 0 ? 'bg-white w-8' : 'bg-white/50'
                }`;
              dot.setAttribute('data-index', index);
              dot.addEventListener('click', () => cambiarSlide(index));
              indicatorsContainer.appendChild(dot);
            });
          }

          function mostrarMensajeSinBanners() {
            const slidesContainer = document.getElementById('slidesContainer');
            const loadingContainer = document.getElementById('sliderLoading');

            // Ocultar el loading spinner
            if (loadingContainer) {
              loadingContainer.style.display = 'none';
            }

            // Mostrar mensaje informativo sin imagen de fondo
            slidesContainer.innerHTML = `
              <div class="absolute inset-0 flex items-center justify-center rounded-2xl"
                   style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                  <div class="text-center p-8">
                      <i class="fas fa-image text-white text-5xl mb-4 opacity-50"></i>
                      <h3 class="text-2xl font-bold text-white mb-2">
                          Sin banners disponibles
                      </h3>
                      <p class="text-white text-sm opacity-80">
                          Los banners del carrusel se cargarán cuando estén configurados en el sistema
                      </p>
                  </div>
              </div>
          `;
          }

          function cambiarSlide(index) {
            if (index === currentSlide) return;

            // Cambiar slide activo
            const slides = document.querySelectorAll('#slidesContainer > div');
            if (slides.length === 0) return;

            slides[currentSlide].classList.remove('opacity-100');
            slides[currentSlide].classList.add('opacity-0');

            currentSlide = index;

            slides[currentSlide].classList.remove('opacity-0');
            slides[currentSlide].classList.add('opacity-100');

            // Actualizar indicadores
            actualizarIndicadores();

            // Reiniciar autoplay
            if (carouselInterval) {
              clearInterval(carouselInterval);
              iniciarAutoplay();
            }
          }

          function actualizarIndicadores() {
            const dots = document.querySelectorAll('.slider-dot');
            dots.forEach((dot, index) => {
              if (index === currentSlide) {
                dot.classList.remove('bg-white/50', 'w-2');
                dot.classList.add('bg-white', 'w-8');
              } else {
                dot.classList.remove('bg-white', 'w-8');
                dot.classList.add('bg-white/50', 'w-2');
              }
            });
          }

          function siguienteSlide() {
            const nextIndex = (currentSlide + 1) % banners.length;
            console.log(`Cambiando de slide ${currentSlide} a ${nextIndex}`);
            cambiarSlide(nextIndex);
          }

          function iniciarAutoplay() {
            // Limpiar intervalo anterior si existe
            if (carouselInterval) {
              clearInterval(carouselInterval);
            }

            if (banners.length > 1) {
              console.log('Autoplay activado: cambio cada 5 segundos');
              carouselInterval = setInterval(siguienteSlide, 5000); // Cambiar cada 5 segundos
            }
          }

          function detenerAutoplay() {
            if (carouselInterval) {
              clearInterval(carouselInterval);
              carouselInterval = null;
            }
          }

          // Pausar autoplay cuando el usuario interactúa
          document.getElementById('bannersSlider')?.addEventListener('mouseenter', detenerAutoplay);
          document.getElementById('bannersSlider')?.addEventListener('mouseleave', iniciarAutoplay);

          // Configurar botones de navegación
          function configurarBotonesNavegacion() {
            const btnNext = document.getElementById('sliderBtnNext');
            const btnPrev = document.getElementById('sliderBtnPrev');

            if (btnNext) {
              btnNext.addEventListener('click', () => {
                const nextIndex = (currentSlide + 1) % banners.length;
                cambiarSlide(nextIndex);
              });
            }

            if (btnPrev) {
              btnPrev.addEventListener('click', () => {
                const prevIndex = (currentSlide - 1 + banners.length) % banners.length;
                cambiarSlide(prevIndex);
              });
            }

            console.log('✅ Botones de navegación configurados');
          }

          // Cargar banners cuando el DOM esté listo
          document.addEventListener('DOMContentLoaded', function () {
            setTimeout(() => {
              cargarBannerCarrusel();
              configurarBotonesNavegacion();
            }, 1000);
          });

          // También cargar después de que se cargue completamente
          window.addEventListener('load', function () {
            setTimeout(() => {
              cargarBannerCarrusel();
              configurarBotonesNavegacion();
            }, 2000);
          });

          // Función global para debug
          window.loadBannersForcefully = cargarBannerCarrusel;
        </script>

        <!-- cards row 3 - TABLA DE EMPRESAS DINÁMICAS -->
        <div class="flex flex-wrap mt-12 -mx-3 max-w-7xl mx-auto px-6 lg:px-8">
          <div class="w-full max-w-full px-3 mt-0 mb-8 lg:mb-0 lg:w-7/12 lg:flex-none"
            style="transform: none !important;">
            <div
              class="relative flex flex-col min-w-0 break-words bg-white border-0 border-solid shadow-xl dark:bg-slate-850 dark:shadow-dark-xl dark:bg-gray-950 border-black-125 rounded-2xl bg-clip-border">
              <div class="p-4 pb-0 mb-0 rounded-t-4">
                <div class="flex justify-between">
                  <h6 class="mb-2 dark:text-white">Empresas En Convenio Recientes</h6>
                </div>
              </div>
              <div class="overflow-x-auto">
                <table class="items-center w-full mb-4 align-top border-collapse border-gray-200 dark:border-white/40"
                  id="companiesTable">
                  <thead>
                    <tr>
                      <th
                        class="px-4 py-3 font-bold text-left uppercase align-middle bg-transparent border-b shadow-none text-xs border-b-solid tracking-none whitespace-nowrap text-slate-400 opacity-70">
                        Empresa
                      </th>
                      <th
                        class="px-4 py-3 font-bold text-center uppercase align-middle bg-transparent border-b shadow-none text-xs border-b-solid tracking-none whitespace-nowrap text-slate-400 opacity-70">
                        Sitio Web
                      </th>
                      <th
                        class="px-4 py-3 font-bold text-center uppercase align-middle bg-transparent border-b shadow-none text-xs border-b-solid tracking-none whitespace-nowrap text-slate-400 opacity-70">
                        Acciones
                      </th>
                    </tr>
                  </thead>
                  <tbody id="companiesTableBody">
                    <!-- Las empresas se cargarán dinámicamente desde la base de datos -->
                    <tr class="skeleton-row">
                      <td colspan="3" class="p-4 text-center">
                        <div class="flex justify-center">
                          <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-red-500"></div>
                        </div>
                        <p class="text-sm text-gray-300 mt-2">Cargando empresas destacadas...</p>
                      </td>
                    </tr>
                  </tbody>
                </table>
                <div id="noCompaniesMessage" class="hidden p-8 text-center">
                  <i class="fas fa-building text-4xl text-gray-300 mb-4"></i>
                  <p class="text-gray-300 mb-4">No hay empresas destacadas registradas en la base de datos</p>
                  <div class="space-y-2">
                    <a href="demo_empresas.html"
                      class="inline-block px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 mr-2">
                      <i class="fas fa-plus mr-2"></i>Gestionar Empresas
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="w-full max-w-full px-3 mt-0 mb-8 lg:w-5/12 lg:flex-none" style="transform: none !important;">
            <div
              class="border-black/12.5 shadow-xl dark:bg-slate-850 dark:shadow-dark-xl relative flex min-w-0 flex-col break-words rounded-2xl border-0 border-solid bg-white bg-clip-border">
              <div class="p-4 pb-0 rounded-t-4">
                <div class="flex justify-between items-center">
                  <h6 class="mb-0 dark:text-white">Nuestros Boletines</h6>
                </div>
              </div>
              <div class="flex-auto p-4">
                <ul class="flex flex-col pl-0 mb-0 rounded-lg" id="announcementsList">
                  <!-- Loading skeleton -->
                  <li
                    class="relative flex justify-between py-2 pr-4 mb-2 border-0 rounded-t-lg rounded-xl text-inherit skeleton-announcement">
                    <div class="flex items-center">
                      <div class="flex flex-col">
                        <div class="animate-pulse bg-gray-200 rounded h-4 w-32 mb-2"></div>
                        <div class="animate-pulse bg-gray-200 rounded h-3 w-40"></div>
                      </div>
                    </div>
                    <div class="flex">
                      <div class="animate-pulse bg-gray-200 rounded-full h-6 w-6"></div>
                    </div>
                  </li>
                  <!-- Los anuncios reales se cargarán aquí -->
                </ul>
              </div>
            </div>
          </div>
        </div>


      </div>
      <!-- end cards -->
    </div> <!-- end unified-gradient-container -->
    </div> <!-- end main-content-wrapper -->
  </main>

  <!-- Notificaciones Toast -->
  <div id="notificationContainer" class="fixed top-4 right-4 z-50 space-y-2"></div>

  <!-- Script eliminado - causaba conflictos visuales -->

  <!-- Auto-login deshabilitado - solo funciona con BD real -->

  <!-- SISTEMA DE DESBLOQUEO INTELIGENTE - PRESERVA CONTENIDO -->
  <script>
    console.log('🔧 DESBLOQUEO INTELIGENTE ACTIVADO');

    function smartUnlock() {
      // Solo ocultar mensajes restrictivos, NO eliminar contenido del menú
      const restrictedMsg = document.getElementById('authRequiredMessage');
      if (restrictedMsg) {
        restrictedMsg.style.display = 'none';
        console.log('👁️ Mensaje de restricción ocultado (no eliminado)');
      }

      const overlay = document.getElementById('restrictedOverlay');
      if (overlay) {
        overlay.style.display = 'none';
        console.log('👁️ Overlay ocultado (no eliminado)');
      }

      // CSS inteligente que preserva el contenido
      const smartStyle = document.createElement('style');
      smartStyle.id = 'smart-unlock-css';
      smartStyle.innerHTML = `
            /* Ocultar solo mensajes restrictivos */
            #authRequiredMessage, #restrictedOverlay { 
                display: none !important; 
            }
            
            /* Asegurar visibilidad del contenido principal */
            #mainContent { 
                opacity: 1 !important; 
                pointer-events: auto !important; 
                display: block !important; 
            }
            
            /* Desbloquear menús sin afectar su contenido */
            . a, 
            a[],
            .nav-link {
                opacity: 1 !important; 
                pointer-events: auto !important; 
                cursor: pointer !important;
                color: inherit !important;
            }
            
            /* Asegurar visibilidad del sidebar */
            aside, .sidebar, nav {
                display: block !important;
                opacity: 1 !important;
            }
            
            /* Ocultar íconos de candado solamente */
            .menu-icon, .fa-lock {
                display: none !important;
            }
            
            /* Mostrar elementos de usuario autenticado */
            .auth-user-info, .user-menu {
                display: block !important;
                opacity: 1 !important;
            }
            
            /* Forzar elementos del menú siempre visibles */
            . {
                opacity: 1 !important;
                pointer-events: auto !important;
            }
            
            . a {
                opacity: 1 !important;
                pointer-events: auto !important;
                cursor: pointer !important;
            }
            
            .menu-icon {
                display: none !important;
            }
            
            /* Eliminar cursor not-allowed en todo el menú */
            . a,
            .menu-section,
            [] {
                cursor: pointer !important;
            }
            
            /* Asegurar que los spans del menú no bloqueen clicks */
            . span {
                pointer-events: auto !important;
            }
        `;

      // Remover estilo anterior si existe
      const oldStyle = document.getElementById('smart-unlock-css');
      if (oldStyle) oldStyle.remove();

      document.head.appendChild(smartStyle);
      console.log('✅ CSS inteligente aplicado - contenido preservado');

      // Forzar datos de usuario temporal si no existen
      setTimeout(loadTemporaryUserData, 500);
    }

    function loadTemporaryUserData() {
      // Cargar información temporal del usuario
      const userNameElement = document.getElementById('userName');
      const userRoleElement = document.getElementById('userRole');
      const welcomeMessage = document.getElementById('welcomeMessage');

      if (userNameElement && !userNameElement.textContent.trim()) {
        userNameElement.textContent = 'Usuario Administrador';
        console.log('👤 Nombre de usuario temporal cargado');
      }

      if (userRoleElement && !userRoleElement.textContent.trim()) {
        userRoleElement.textContent = 'Administrador';
        console.log('🎭 Rol de usuario temporal cargado');
      }

      if (welcomeMessage && !welcomeMessage.textContent.trim()) {
        welcomeMessage.innerHTML = '<h6 class="mb-0 font-bold text-white capitalize">Bienvenido, Administrador</h6>';
        console.log('👋 Mensaje de bienvenida temporal cargado');
      }

      // Mostrar elementos de menú de usuario
      const loginNavItem = document.getElementById('loginNavItem');
      const userMenuDropdown = document.getElementById('userMenuDropdown');
      const logoutMenuItem = document.getElementById('logoutMenuItem');

      if (loginNavItem) {
        loginNavItem.style.display = 'none';
      }

      if (userMenuDropdown) {
        userMenuDropdown.style.display = 'block';
      }

      if (logoutMenuItem) {
        logoutMenuItem.style.display = 'flex';
      }
    }

    // Ejecutar desbloqueo inmediato
    smartUnlock();

    // Ejecutar cuando DOM esté listo
    document.addEventListener('DOMContentLoaded', smartUnlock);

    // Función global para debugging
    window.smartUnlock = smartUnlock;
    window.loadTemporaryUserData = loadTemporaryUserData;

    // DETECCIÓN DE SESIÓN Y USUARIO LOGGEADO
    function detectUserSession() {
      console.log('🔍 Iniciando detección de sesión...');

      // Verificar múltiples fuentes de datos de sesión
      const sessionSources = [
        localStorage.getItem('userData'),
        localStorage.getItem('currentUser'),
        sessionStorage.getItem('userSession'),
        localStorage.getItem('userInfo'),
        sessionStorage.getItem('loginData')
      ];

      // Buscar datos válidos en alguna fuente
      let userData = null;
      for (const source of sessionSources) {
        if (source) {
          try {
            userData = JSON.parse(source);
            if (userData && (userData.nombre || userData.name || userData.email)) {
              console.log('👤 Usuario detectado desde storage:', userData);
              break;
            }
          } catch (e) {
            // Si no es JSON, podría ser un string simple
            if (source.length > 0) {
              userData = { nombre: source };
              console.log('👤 Usuario detectado como string:', source);
              break;
            }
          }
        }
      }

      // Si no hay datos en storage, verificar si hay sesión PHP activa
      if (!userData) {
        checkPHPSession();
      } else {
        displayUserInfo(userData);
      }
    }

    async function checkPHPSession() {
      try {
        console.log('🔍 Verificando sesión PHP...');

        // Probar múltiples endpoints para verificar sesión
        const sessionEndpoints = [
          './assets/conexion/check-session.php',
          './api/auth/session.php?action=check',
          './login/check-session.php'
        ];

        let sessionFound = false;
        let userData = null;

        for (const endpoint of sessionEndpoints) {
          try {
            console.log(`📡 Probando endpoint: ${endpoint}`);
            const response = await fetch(endpoint, {
              credentials: 'include',
              headers: {
                'Content-Type': 'application/json'
              }
            });

            if (response.ok) {
              const data = await response.json();
              if (data.success && data.user) {
                console.log('✅ Sesión PHP activa:', data.user);
                userData = data.user;
                sessionFound = true;
                break;
              }
            }
          } catch (e) {
            console.log(`❌ Error en ${endpoint}: ${e.message}`);
            continue;
          }
        }

        if (sessionFound && userData) {
          displayUserInfo(userData);
          // Guardar en localStorage para próximas visitas
          localStorage.setItem('userData', JSON.stringify(userData));
        } else {
          console.log('❌ No hay sesión PHP activa');
          checkRecentLogin(); // Verificar si hay login reciente
        }
      } catch (error) {
        console.log('⚠️ Error verificando sesión PHP:', error);
        checkRecentLogin();
      }
    }

    function checkRecentLogin() {
      // Verificar si hay un login reciente (viene desde sign-in.html)
      const recentLogin = sessionStorage.getItem('recentLogin');
      const urlParams = new URLSearchParams(window.location.search);
      const loginSuccess = urlParams.get('login') === 'success';

      if (recentLogin || loginSuccess) {
        console.log('🎉 Login reciente detectado');

        // Intentar obtener datos reales del usuario desde sessionStorage
        let userData = null;
        try {
          const sessionData = sessionStorage.getItem('userSession');
          const localData = localStorage.getItem('userData');
          userData = sessionData ? JSON.parse(sessionData) : (localData ? JSON.parse(localData) : null);
          console.log('📖 Datos de usuario recuperados:', userData);
        } catch (error) {
          console.log('⚠️ Error recuperando datos de usuario:', error);
        }

        // Si no hay datos guardados, usar datos por defecto
        if (!userData) {
          userData = {
            nombre: 'Usuario',
            apellido: 'Loggeado',
            email: 'usuario@ejemplo.com',
            nombre_empresa: 'CLAUT Metropolitano'
          };
          console.log('📋 Usando datos por defecto');
        }

        displayUserInfo(userData);

        // Limpiar flag
        sessionStorage.removeItem('recentLogin');

        // Limpiar URL si tiene parámetro login
        if (loginSuccess) {
          window.history.replaceState({}, document.title, window.location.pathname);
        }
      } else if (document.cookie.includes('PHPSESSID')) {
        console.log('🍪 Cookie PHP encontrada, asumiendo usuario loggeado');
        displayUserInfo({ nombre: 'Usuario Loggeado', nombre_empresa: 'CLAUT Metropolitano' });
      } else {
        showLoginPrompt();
      }
    }

    function displayUserInfo(userData) {
      console.log('📊 Mostrando información del usuario:', userData);

      // Extraer datos del usuario
      const nombre = userData.nombre || userData.name || userData.email || 'Usuario';
      const apellido = userData.apellido || userData.lastname || '';
      const nombreCompleto = apellido ? `${nombre} ${apellido}` : nombre;
      const empresa = userData.nombre_empresa || userData.empresa || 'Sin empresa';
      const email = userData.email || '';
      const rol = userData.rol || userData.role || '';

      // Actualizar elementos de la interfaz
      updateWelcomeMessage(nombreCompleto);
      updateUserInfo(nombreCompleto, empresa, email);
      showAuthenticatedElements();

      // Mostrar botón de admin panel si el usuario es administrador
      checkAdminAccess(rol, userData);

      console.log('✅ Interfaz actualizada para usuario autenticado');
    }

    function updateWelcomeMessage(nombre) {
      const welcomeText = document.getElementById('welcomeText');
      if (welcomeText) {
        welcomeText.textContent = `Bienvenido ${nombre}`;
      }
    }

    function updateUserInfo(nombre, empresa, email) {
      const userNameElement = document.getElementById('userName');
      const userRoleElement = document.getElementById('userRole');
      const userInfoDiv = document.getElementById('userInfo');

      if (userNameElement) userNameElement.textContent = nombre;
      if (userRoleElement) userRoleElement.textContent = empresa;
      if (userInfoDiv) {
        userInfoDiv.classList.remove('hidden');
        userInfoDiv.classList.add('flex');
      }
    }

    function showAuthenticatedElements() {
      // Ocultar elementos de login
      const loginMenuItem = document.getElementById('loginMenuItem');
      const loginNavItem = document.getElementById('loginNavItem');

      if (loginMenuItem) loginMenuItem.style.display = 'none';
      if (loginNavItem) loginNavItem.style.display = 'none';

      // Mostrar elementos de usuario autenticado
      const userMenuDropdown = document.getElementById('userMenuDropdown');
      const logoutMenuItem = document.getElementById('logoutMenuItem');

      if (userMenuDropdown) userMenuDropdown.classList.remove('hidden');
      if (logoutMenuItem) logoutMenuItem.classList.remove('hidden');

      // Inicializar el centro de mensajes
      initializeMessageCenter();
    }

    function checkAdminAccess(rol, userData) {
      console.log('🔐 Verificando acceso de administrador:', { rol, userData });

      // Detectar si el usuario es administrador
      const isAdmin = (
        rol === 'admin' ||
        rol === 'administrator' ||
        rol === 'administrador' ||
        userData.is_admin === true ||
        userData.admin === true
      );

      console.log('🔐 Usuario es admin:', isAdmin);

      const adminButton = document.getElementById('adminPanelButton');
      if (adminButton) {
        if (isAdmin) {
          adminButton.classList.remove('hidden');
          console.log('✅ Botón de admin panel mostrado');
        } else {
          adminButton.classList.add('hidden');
          console.log('🔒 Botón de admin panel oculto - usuario no es admin');
        }
      } else {
        console.warn('⚠️ Elemento adminPanelButton no encontrado');
      }
    }

    function showLoginPrompt() {
      console.log('👋 Mostrando elementos de login');

      // Restaurar mensaje original
      const welcomeText = document.getElementById('welcomeText');
      if (welcomeText) {
        welcomeText.textContent = 'Bienvenido a Clúster Intranet';
      }

      // Mostrar elementos de login
      const loginMenuItem = document.getElementById('loginMenuItem');
      const loginNavItem = document.getElementById('loginNavItem');

      if (loginMenuItem) loginMenuItem.style.display = 'flex';
      if (loginNavItem) loginNavItem.style.display = 'block';

      // Ocultar elementos de usuario autenticado
      const userMenuDropdown = document.getElementById('userMenuDropdown');
      const logoutMenuItem = document.getElementById('logoutMenuItem');
      const userInfoDiv = document.getElementById('userInfo');
      const adminButton = document.getElementById('adminPanelButton');

      if (userMenuDropdown) userMenuDropdown.classList.add('hidden');
      if (logoutMenuItem) logoutMenuItem.classList.add('hidden');
      if (userInfoDiv) userInfoDiv.classList.add('hidden');
      if (adminButton) adminButton.classList.add('hidden'); // Ocultar botón de admin
    }

    // Función para testing manual del botón de admin
    window.testAdminButton = function (forceShow = false) {
      const adminButton = document.getElementById('adminPanelButton');
      if (adminButton) {
        if (forceShow) {
          adminButton.classList.remove('hidden');
          console.log('🧪 Botón de admin panel forzado a mostrar (testing)');
        } else {
          adminButton.classList.add('hidden');
          console.log('🧪 Botón de admin panel ocultado (testing)');
        }
      }
    };

    // Funciones globales
    window.detectUserSession = detectUserSession;
    window.displayUserInfo = displayUserInfo;
    window.showLoginPrompt = showLoginPrompt;

    // Ejecutar detección de sesión al cargar
    setTimeout(detectUserSession, 300);

    // Integración con sistema de seguridad
    function enhanceSessionSecurity() {
      // Configurar integración con sistema de autenticación existente
      if (window.sessionSecurity) {
        console.log('🔗 Integrando con sistema de seguridad de sesión');

        // Override método de verificación local para usar nuestro sistema
        const originalCheckLocal = window.sessionSecurity.checkLocalSession;
        window.sessionSecurity.checkLocalSession = function () {
          // Usar la misma lógica que detectUserSession
          const sessionSources = [
            localStorage.getItem('userData'),
            localStorage.getItem('currentUser'),
            sessionStorage.getItem('userSession'),
            localStorage.getItem('userInfo'),
            sessionStorage.getItem('loginData')
          ];

          for (const source of sessionSources) {
            if (source) {
              try {
                const userData = JSON.parse(source);
                if (userData && (userData.nombre || userData.name || userData.email)) {
                  return true;
                }
              } catch (e) {
                if (source.length > 0) {
                  return true;
                }
              }
            }
          }

          // También verificar elementos UI
          const hasUserElement = document.querySelector('.user-name') ||
            document.querySelector('[data-user]') ||
            window.currentUser ||
            document.getElementById('userDisplayName');

          return !!hasUserElement;
        };

        // Configurar callback personalizado para logout
        const originalRedirect = window.sessionSecurity.redirectToLogin;
        window.sessionSecurity.redirectToLogin = function (reason) {
          console.log(`🔄 Sesión expirada. Razón: ${reason}`);

          // Limpiar datos locales
          localStorage.removeItem('userData');
          localStorage.removeItem('currentUser');
          sessionStorage.clear();

          // Mostrar mensaje de sesión expirada
          if (reason === 'inactivity') {
            alert('Tu sesión ha expirado por inactividad. Serás redirigido al login.');
          }

          // Redirigir al login
          window.location.href = './pages/sign-in.html';
        };

        console.log('✅ Sistema de seguridad integrado correctamente');
      } else {
        console.warn('⚠️ Sistema de seguridad de sesión no encontrado');
      }
    }

    // Configurar integración después de un momento
    setTimeout(enhanceSessionSecurity, 1500);

  </script>

  <!-- Script eliminado - causaba conflictos de desbloqueo -->

  <!-- Script eliminado - ya no necesario tras cambios -->

  <!-- Script de debug y reparación de gráficos -->
  <!-- <script src="./js/debug-graficos.js"></script> -->

  <!-- Script para asegurar gráfico en sección correcta -->
  <!-- <script src="./js/grafico-seccion-correcta.js"></script> -->

  <!-- Herramientas de debug adicionales -->
  <!-- <script src="./js/debug-herramientas.js"></script> -->

  <script src="./js/auth-session.js"></script>
  <script src="./js/force-login-links.js"></script>
  <script src="./js/test-login-links.js"></script>
  <script src="./js/index.js"></script>
  <script src="./js/auth-fix.js"></script>
  <!-- <script src="./js/dashboard-simple.js"></script> -->
  <!-- <script src="./js/empresas-analisis.js"></script> -->
  <!-- <script src="./js/dashboard-chart-fix.js"></script> -->
  <script src="./js/empresas-destacadas-index.js"></script>
  <!-- <script src="./dashboard-slider-fix.js"></script> -->
  <!-- <script src="./announcements-fix.js"></script> -->
  <script src="./js/estadisticas-dinamicas.js"></script>
  <!-- <script src="./assets/js/plugins/chartjs.min.js" async onload="initializeChartAfterLoad()"></script> -->
  <script src="./assets/js/plugins/perfect-scrollbar.min.js" async></script>
  <script src="./assets/js/argon-dashboard-tailwind.js?v=1.0.1" async></script>

  <!-- FORCE CHART INITIALIZATION DISABLED -->
  <!--
  <script>
    // Function called when Chart.js loads
    function initializeChartAfterLoad() {
      console.log('📊 Chart.js loaded, forcing chart initialization...');

      // Show the chart wrapper immediately
      const chartWrapper = document.getElementById('chart-wrapper');
      const chartLoading = document.getElementById('chart-loading');
      const graficoContainer = document.getElementById('grafico-container');

      if (chartWrapper) {
        chartWrapper.style.display = 'block';
        chartWrapper.style.visibility = 'visible';
        chartWrapper.style.opacity = '1';
      }

      if (chartLoading) {
        chartLoading.style.display = 'none';
      }

      if (graficoContainer) {
        graficoContainer.classList.add('chart-loaded');
      }

      // Force initialize chart after a short delay
      setTimeout(() => {
        if (window.graficoEmpresasRobusto) {
          console.log('🔄 Reinitializing chart...');
          window.graficoEmpresasRobusto.init();
        } else {
          console.log('🚀 Creating new chart instance...');
          if (typeof GraficoEmpresasRobusto !== 'undefined') {
            window.graficoEmpresasRobusto = new GraficoEmpresasRobusto();
            window.graficoEmpresasRobusto.init();
          }
        }
      }, 500);
    }

    // Fallback - force show chart after 3 seconds regardless
    setTimeout(() => {
      const chartWrapper = document.getElementById('chart-wrapper');
      const chartLoading = document.getElementById('chart-loading');

      if (chartWrapper && chartWrapper.style.display === 'none') {
        console.log('⏰ Fallback: Forcing chart display after timeout');
        chartWrapper.style.display = 'block';
        chartWrapper.style.visibility = 'visible';

        if (chartLoading) {
          chartLoading.style.display = 'none';
        }

        // Try to initialize chart if it hasn't been done
        if (window.graficoEmpresasRobusto && typeof Chart !== 'undefined') {
          window.graficoEmpresasRobusto.init();
        }
      }
    }, 3000);

    // Additional chart repair functions
    /*
    function repararGraficos() {
      console.log('🔧 Reparando gráficos...');

      // Force show chart elements
      const chartWrapper = document.getElementById('chart-wrapper');
      const chartLoading = document.getElementById('chart-loading');
      const canvas = document.getElementById('chart-line');

      if (chartWrapper) {
        chartWrapper.style.display = 'block';
        chartWrapper.style.visibility = 'visible';
        chartWrapper.style.opacity = '1';
      }

      if (chartLoading) {
        chartLoading.style.display = 'none';
      }

      if (canvas) {
        canvas.style.display = 'block';
        canvas.style.visibility = 'visible';
      }

      // Reinitialize chart
      if (window.graficoEmpresasRobusto) {
        window.graficoEmpresasRobusto.reinicializar();
      } else {
        initializeChartAfterLoad();
      }

      // Show success message
      setTimeout(() => {
        if (typeof mostrarNotificacion === 'function') {
          mostrarNotificacion('Gráfico reparado correctamente', 'success');
        } else {
          alert('Gráfico reparado correctamente');
        }
      }, 1000);
    }

    function solucionRapida() {
      console.log('⚡ Aplicando solución rápida...');

      // Limpiar el contenedor completamente
      const graficoContainer = document.getElementById('grafico-container');
      if (graficoContainer) {
        graficoContainer.innerHTML = `
          <div style="position: relative; height: 300px; width: 100%;">
            <canvas id="chart-line-new" width="400" height="300" style="max-height: 300px; width: 100%;"></canvas>
          </div>
        `;
      }

      // Esperar un momento y crear el gráfico
      setTimeout(() => {
        // Cargar Chart.js si no está disponible
        if (typeof Chart === 'undefined') {
          console.log('📦 Cargando Chart.js...');
          const script = document.createElement('script');
          script.src = 'https://cdn.jsdelivr.net/npm/chart.js';
          script.onload = () => crearGraficoSimple();
          document.head.appendChild(script);
        } else {
          crearGraficoSimple();
        }
      }, 100);

      function crearGraficoSimple() {
        console.log('🎨 Creando gráfico simple...');
        const canvas = document.getElementById('chart-line-new') || document.getElementById('chart-line');

        if (canvas && typeof Chart !== 'undefined') {
          // Destruir gráfico existente si existe
          if (window.currentChart) {
            window.currentChart.destroy();
          }

          const ctx = canvas.getContext('2d');
          window.currentChart = new Chart(ctx, {
            type: 'line',
            data: {
              labels: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto'],
              datasets: [{
                label: 'Empresas Registradas',
                data: [19, 24, 29, 31, 33, 38, 42, 44],
                borderColor: '#3B82F6',
                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                borderWidth: 3,
                fill: true,
                tension: 0.4,
                pointBackgroundColor: '#3B82F6',
                pointBorderColor: '#FFFFFF',
                pointBorderWidth: 2,
                pointRadius: 6
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: { display: false },
                tooltip: {
                  backgroundColor: 'rgba(0, 0, 0, 0.8)',
                  titleColor: '#FFFFFF',
                  bodyColor: '#FFFFFF'
                }
              },
              scales: {
                x: {
                  display: true,
                  grid: { display: false },
                  ticks: { color: '#64748B' }
                },
                y: {
                  display: true,
                  beginAtZero: true,
                  grid: { color: 'rgba(148, 163, 184, 0.1)' },
                  ticks: { color: '#64748B' }
                }
              },
              animation: {
                duration: 2000,
                easing: 'easeInOutQuart'
              }
            }
          });

          console.log('✅ Gráfico creado exitosamente');

          // Actualizar texto de crecimiento
          const chartGrowth = document.getElementById('chartGrowth');
          if (chartGrowth) {
            chartGrowth.textContent = '5% más';
          }

        } else {
          console.error('❌ No se puede crear el gráfico: Chart.js no disponible o canvas no encontrado');
        }
      }

      setTimeout(() => {
        if (typeof mostrarNotificacion === 'function') {
          mostrarNotificacion('Gráfico reparado correctamente', 'success');
        } else {
          console.log('✅ Gráfico reparado correctamente');
        }
      }, 1000);
    }

    // Make functions globally available
    window.repararGraficos = repararGraficos;
    window.solucionRapida = solucionRapida;
    */
  //</script>

  <!-- SISTEMA DE AUTENTICACIÓN MEJORADO -->
  <!-- La lógica de autenticación se maneja completamente en auth-redirect.js -->
  <script>
    // Configurar eventos para los botones de logout
    document.addEventListener('DOMContentLoaded', function () {
      // Botón de logout del sidebar
      const logoutBtn = document.getElementById('logoutBtn');
      if (logoutBtn) {
        logoutBtn.addEventListener('click', function () {
          if (window.authSessionManager) {
            window.authSessionManager.logout();
          } else if (window.logout) {
            window.logout();
          }
        });
      }

      // El event listener para logoutBtnMenu se agrega después de crear el userMenuContent

      // Menú desplegable de usuario
      const userMenuButton = document.getElementById('userMenuButton');

      // Create dropdown content in body to escape stacking context
      const userMenuContent = document.createElement('div');
      userMenuContent.id = 'userMenuContent';
      userMenuContent.className = 'w-48 bg-white rounded-lg shadow-lg py-2 hidden';
      userMenuContent.style.cssText = `
        position: fixed !important;
        z-index: 2147483647 !important;
        isolation: isolate !important;
        top: 0px;
        right: 0px;
      `;
      userMenuContent.innerHTML = `
        <a href="profile.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
          <i class="fa fa-user mr-2"></i>Mi Perfil
        </a>
        <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
          <i class="fa fa-cog mr-2"></i>Configuración
        </a>
        <hr class="my-1">
        <button id="logoutBtnMenu" class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50">
          <i class="fa fa-sign-out-alt mr-2 text-red"></i>Cerrar Sesión
        </button>
      `;
      document.body.appendChild(userMenuContent);

      // Agregar event listener al botón de logout del menú después de crearlo
      const logoutBtnMenu = userMenuContent.querySelector('#logoutBtnMenu');
      if (logoutBtnMenu) {
        logoutBtnMenu.addEventListener('click', function () {
          if (window.authSessionManager) {
            window.authSessionManager.logout();
          } else if (window.logout) {
            window.logout();
          }
        });
      }

      if (userMenuButton && userMenuContent) {
        // Force button to be always clickable
        function forceButtonClickable() {
          userMenuButton.style.position = 'relative';
          userMenuButton.style.zIndex = '999998';
          userMenuButton.style.pointerEvents = 'auto';

          // Force parent containers to be above content
          const userMenuDropdown = document.getElementById('userMenuDropdown');
          if (userMenuDropdown) {
            userMenuDropdown.style.position = 'relative';
            userMenuDropdown.style.zIndex = '999999';
          }

          // Force navbar to be above everything
          const navbar = userMenuButton.closest('nav');
          if (navbar) {
            navbar.style.position = 'relative';
            navbar.style.zIndex = '999997';
          }
        }

        // Apply fixes immediately and on any changes
        forceButtonClickable();
        setInterval(forceButtonClickable, 1000); // Reapply every second

        userMenuButton.addEventListener('click', function (e) {
          e.stopPropagation();
          console.log('🖱️ Mi Cuenta button clicked');

          // Force positioning above everything
          userMenuContent.style.position = 'fixed';
          userMenuContent.style.zIndex = '9999999';
          userMenuContent.style.right = '1rem';
          userMenuContent.style.top = '3.5rem';

          userMenuContent.classList.toggle('hidden');

          // If showing, force it to be above everything
          if (!userMenuContent.classList.contains('hidden')) {
            console.log('🔝 Forcing dropdown to top');

            // Get button position for better placement
            const buttonRect = userMenuButton.getBoundingClientRect();
            userMenuContent.style.top = (buttonRect.bottom + 8) + 'px';
            userMenuContent.style.right = (window.innerWidth - buttonRect.right) + 'px';

            // Force higher z-index than anything else
            document.querySelectorAll('*').forEach(el => {
              const zIndex = parseInt(getComputedStyle(el).zIndex) || 0;
              if (zIndex > 100000 && el !== userMenuContent) {
                el.style.zIndex = '1';
              }
            });

            userMenuContent.style.zIndex = '9999999';
          }
        });

        // Also add a fallback click handler on the entire li element
        const userMenuDropdown = document.getElementById('userMenuDropdown');
        if (userMenuDropdown) {
          userMenuDropdown.addEventListener('click', function (e) {
            if (e.target === userMenuDropdown || e.target === userMenuButton) {
              userMenuButton.click();
            }
          });
        }

        // Cerrar menú al hacer click fuera
        document.addEventListener('click', function () {
          userMenuContent.classList.add('hidden');
        });
      }
    });
  </script>

  <!-- SISTEMA SIMPLIFICADO Y MEJORADO DE GRÁFICOS -->
  <script>
    // Sistema simplificado que garantiza el posicionamiento correcto
    console.log('🎯 Inicializando sistema de gráficos optimizado...');

    // Verificar estado y aplicar corrección si es necesario
    function verificarYCorregir() {
      if (typeof verificarPosicionGrafico === 'function') {
        setTimeout(() => {
          const estado = verificarPosicionGrafico();
          console.log('Estado del gráfico:', estado);

          if (!estado.enSeccionCorrecta) {
            console.log('🔧 Aplicando corrección automática...');
          }
        }, 2000);
      }
    }

    // Ejecutar verificación cuando todo esté listo
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', verificarYCorregir);
    } else {
      verificarYCorregir();
    }

    // Funciones de utilidad global
    window.verificarGrafico = function () {
      if (typeof verificarPosicionGrafico === 'function') {
        return verificarPosicionGrafico();
      }
      return { error: 'Sistema no disponible' };
    };

    window.repararGraficoManual = function () {
      if (window.graficoSeccionCorrecta) {
        window.graficoSeccionCorrecta.inicializar();
      } else {
        console.log('Reiniciando página como último recurso...');
        location.reload();
      }
    };

    console.log('✅ Sistema de gráficos optimizado configurado');

    // Fix sidebar spacing and setup responsive behavior
    function fixSidebarSpacing() {
      const sidebar = document.querySelector('.sidebar-enhanced');
      const overlay = document.getElementById('sidenavOverlay');
      const sidenavToggle = document.querySelector('[sidenav-trigger]');
      const sidenavClose = document.querySelector('[sidenav-close]');

      if (sidebar) {
        // Remove the problematic classes
        sidebar.classList.remove('my-4');
        sidebar.classList.remove('modern-card');
        sidebar.classList.remove('apple-card');

        // Setup responsive behavior
        function toggleSidebar() {
          const isVisible = sidebar.classList.contains('sidenav-show');

          if (isVisible) {
            sidebar.classList.remove('sidenav-show');
            overlay.classList.remove('show');
            sidebar.setAttribute('aria-expanded', 'false');
          } else {
            sidebar.classList.add('sidenav-show');
            overlay.classList.add('show');
            sidebar.setAttribute('aria-expanded', 'true');
          }
        }

        function closeSidebar() {
          sidebar.classList.remove('sidenav-show');
          overlay.classList.remove('show');
          sidebar.setAttribute('aria-expanded', 'false');
        }

        // Event listeners
        if (sidenavToggle) {
          sidenavToggle.addEventListener('click', function (e) {
            e.preventDefault();
            toggleSidebar();
          });
        }

        if (sidenavClose) {
          sidenavClose.addEventListener('click', function (e) {
            e.preventDefault();
            closeSidebar();
          });
        }

        if (overlay) {
          overlay.addEventListener('click', closeSidebar);
          // Mejorar para touch devices
          overlay.addEventListener('touchstart', function (e) {
            e.preventDefault();
            closeSidebar();
          }, { passive: false });
        }

        // Asegurar que el botón X funcione correctamente
        const closeBtn = document.getElementById('sidebarCloseBtn');
        if (closeBtn) {
          closeBtn.addEventListener('click', function (e) {
            e.preventDefault();
            e.stopPropagation();
            closeSidebar();
          });
          closeBtn.addEventListener('touchstart', function (e) {
            e.preventDefault();
            e.stopPropagation();
            closeSidebar();
          }, { passive: false });
        }

        // Close on escape key
        document.addEventListener('keydown', function (e) {
          if (e.key === 'Escape') {
            closeSidebar();
          }
        });

        // Handle window resize
        window.addEventListener('resize', function () {
          if (window.innerWidth >= 1280) {
            closeSidebar();
          }
        });

        // Mejorar comportamiento en móviles
        // Prevenir scroll del body cuando el sidebar está abierto
        function preventBodyScroll(prevent) {
          if (prevent) {
            document.body.style.overflow = 'hidden';
            document.body.style.height = '100vh';
          } else {
            document.body.style.overflow = '';
            document.body.style.height = '';
          }
        }

        // Modificar toggleSidebar para incluir prevención de scroll
        const originalToggleSidebar = toggleSidebar;
        toggleSidebar = function () {
          const isVisible = sidebar.classList.contains('sidenav-show');

          if (!isVisible) {
            // Abriendo sidebar
            sidebar.classList.add('sidenav-show');
            sidebar.setAttribute('aria-expanded', 'true');
            overlay.classList.add('show');
            preventBodyScroll(true);

            // Focus management para accesibilidad
            const firstLink = sidebar.querySelector('.porsche-nav-item');
            if (firstLink) {
              setTimeout(() => firstLink.focus(), 100);
            }
          } else {
            // Cerrando sidebar
            closeSidebar();
          }
        };

        // Modificar closeSidebar para incluir prevención de scroll
        const originalCloseSidebar = closeSidebar;
        closeSidebar = function () {
          sidebar.classList.remove('sidenav-show');
          sidebar.setAttribute('aria-expanded', 'false');
          overlay.classList.remove('show');
          preventBodyScroll(false);

          // Devolver focus al botón hamburger
          const hamburgerBtn = document.querySelector('[sidenav-trigger]');
          if (hamburgerBtn && window.innerWidth < 1280) {
            hamburgerBtn.focus();
          }
        };

        // Manejar swipe para cerrar en dispositivos touch
        let touchStartX = 0;
        let touchStartY = 0;

        sidebar.addEventListener('touchstart', function (e) {
          touchStartX = e.touches[0].clientX;
          touchStartY = e.touches[0].clientY;
        }, { passive: true });

        sidebar.addEventListener('touchmove', function (e) {
          if (!touchStartX) return;

          const currentX = e.touches[0].clientX;
          const currentY = e.touches[0].clientY;
          const diffX = touchStartX - currentX;
          const diffY = Math.abs(touchStartY - currentY);

          // Swipe horizontal hacia la izquierda para cerrar
          if (diffX > 50 && diffY < 100) {
            closeSidebar();
            touchStartX = 0;
            touchStartY = 0;
          }
        }, { passive: true });

        // Mejorar accesibilidad - teclas de navegación
        sidebar.addEventListener('keydown', function (e) {
          if (e.key === 'Escape') {
            closeSidebar();
          }

          // Navegación con flechas
          if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {
            e.preventDefault();
            const navItems = Array.from(sidebar.querySelectorAll('.porsche-nav-item:not([style*="display: none"])'));
            const currentIndex = navItems.indexOf(document.activeElement);

            if (e.key === 'ArrowDown') {
              const nextIndex = (currentIndex + 1) % navItems.length;
              navItems[nextIndex].focus();
            } else {
              const prevIndex = currentIndex <= 0 ? navItems.length - 1 : currentIndex - 1;
              navItems[prevIndex].focus();
            }
          }
        });

        console.log('✅ Sidebar responsive behavior configured with enhanced mobile features');
      }
    }

    // Apply Porsche-inspired styles to dynamic content
    function applyPorscheStyles() {
      console.log('🚗 Applying Porsche-inspired styling...');

      // Apply to statistics cards when they load
      const statsCards = document.querySelectorAll('#estadisticasContainer .w-full');
      statsCards.forEach(card => {
        const innerCard = card.querySelector('.bg-white, .shadow-xl');
        if (innerCard && !innerCard.classList.contains('porsche-stat-card')) {
          innerCard.classList.add('porsche-stat-card');

          // Update number styling
          const number = innerCard.querySelector('.text-3xl, .text-4xl, .text-2xl');
          if (number) {
            number.classList.add('porsche-stat-number');
          }

          // Update label styling
          const label = innerCard.querySelector('.text-sm, .text-xs');
          if (label && !label.closest('.flex')) {
            label.classList.add('porsche-stat-label');
          }
        }
      });

      // Apply to main content cards
      const contentCards = document.querySelectorAll('.bg-white.shadow-xl:not(.porsche-card)');
      contentCards.forEach(card => {
        if (!card.closest('#estadisticasContainer') && !card.closest('.sidebar-enhanced')) {
          card.classList.add('porsche-card');
        }
      });

      // Apply to buttons that aren't already styled
      const buttons = document.querySelectorAll('button:not(.porsche-btn):not(.porsche-btn-outline):not(.porsche-btn-accent)');
      buttons.forEach(btn => {
        if (btn.classList.contains('bg-red-500') || btn.classList.contains('bg-green-500') || btn.textContent.includes('Actualizar')) {
          btn.classList.add('porsche-btn-outline');
        }
      });

      console.log('✅ Porsche styling applied successfully');
    }

    // Apple-style animation enhancement for dynamic content
    function applyAppleStyleToDynamicElements() {
      // Apply modern styling to statistics cards when they load
      const observer = new MutationObserver(function (mutations) {
        mutations.forEach(function (mutation) {
          if (mutation.type === 'childList') {
            mutation.addedNodes.forEach(function (node) {
              if (node.nodeType === 1) { // Element node
                // Apply to statistics cards
                if (node.classList && (node.classList.contains('w-full') || node.classList.contains('px-3'))) {
                  const statCard = node.querySelector('.bg-white, .shadow-xl');
                  if (statCard) {
                    statCard.classList.add('modern-card', 'stat-card');
                    // Add shimmer effect
                    setTimeout(() => {
                      statCard.style.transform = 'translateY(0)';
                      statCard.style.opacity = '1';
                    }, 100);
                  }
                }

                // Apply to any new buttons
                const buttons = node.querySelectorAll ? node.querySelectorAll('button:not(.apple-button)') : [];
                buttons.forEach(btn => {
                  if (!btn.classList.contains('apple-button')) {
                    btn.classList.add('apple-button');
                  }
                });

                // Apply to new links that look like buttons
                const buttonLinks = node.querySelectorAll ? node.querySelectorAll('a[class*="bg-"], a[class*="px-"]') : [];
                buttonLinks.forEach(link => {
                  if (!link.classList.contains('apple-button')) {
                    link.classList.add('apple-button');
                  }
                });
              }
            });
          }
        });
      });

      // Start observing
      const statisticsContainer = document.getElementById('estadisticasContainer');
      if (statisticsContainer) {
        observer.observe(statisticsContainer, {
          childList: true,
          subtree: true
        });
      }

      // Apply initial styling to existing elements
      setTimeout(() => {
        document.querySelectorAll('.bg-white.shadow-xl').forEach(card => {
          if (!card.classList.contains('modern-card')) {
            card.classList.add('modern-card');
          }
        });
      }, 500);
    }

    // Initialize Porsche styling on DOM ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', function () {
        fixSidebarSpacing();
        applyPorscheStyles();
        applyAppleStyleToDynamicElements();
      });
    } else {
      fixSidebarSpacing();
      applyPorscheStyles();
      applyAppleStyleToDynamicElements();
    }

    // Debug function to check styles application and spacing
    function debugStyles() {
      console.log('🔍 DEBUG: Checking styles and spacing...');

      // Check sidebar spacing (main culprit)
      const sidebar = document.querySelector('.sidebar-enhanced');
      if (sidebar) {
        const sidebarStyle = getComputedStyle(sidebar);
        console.log('📏 SIDEBAR spacing (main problem):', {
          marginTop: sidebarStyle.marginTop,
          marginBottom: sidebarStyle.marginBottom,
          top: sidebarStyle.top,
          bottom: sidebarStyle.bottom,
          position: sidebarStyle.position
        });
      }

      // Check navbar spacing
      const navbar = document.querySelector('nav.apple-navbar');
      if (navbar) {
        const navStyle = getComputedStyle(navbar);
        console.log('📏 Navbar spacing:', {
          paddingTop: navStyle.paddingTop,
          paddingBottom: navStyle.paddingBottom,
          marginBottom: navStyle.marginBottom,
          height: navStyle.height
        });
      }

      // Check main content container spacing
      const contentContainer = document.querySelector('.w-full.px-6');
      if (contentContainer) {
        const contentStyle = getComputedStyle(contentContainer);
        console.log('📏 Content container spacing:', {
          paddingTop: contentStyle.paddingTop,
          marginTop: contentStyle.marginTop,
          offsetTop: contentContainer.offsetTop
        });
      }

      // Check for any elements causing large gaps
      const elements = document.querySelectorAll('*');
      let largeSpacing = [];

      elements.forEach(el => {
        const style = getComputedStyle(el);
        const marginTop = parseInt(style.marginTop);
        const paddingTop = parseInt(style.paddingTop);

        if (marginTop > 50 || paddingTop > 50) {
          largeSpacing.push({
            element: el.tagName + (el.className ? '.' + el.className.split(' ').join('.') : ''),
            marginTop: style.marginTop,
            paddingTop: style.paddingTop
          });
        }
      });

      if (largeSpacing.length > 0) {
        console.log('⚠️ Elements with large spacing:', largeSpacing);
      }

      const cards = document.querySelectorAll('.modern-card');
      console.log(`Found ${cards.length} cards with modern-card class`);

      const buttons = document.querySelectorAll('.btn-claut');
      console.log(`Found ${buttons.length} buttons with btn-claut class`);
    }

    // Force re-apply Porsche styling after a delay to ensure all elements are loaded
    setTimeout(() => {
      fixSidebarSpacing();
      applyPorscheStyles();
      debugStyles();
    }, 1000);

    setTimeout(() => {
      fixSidebarSpacing();
      applyPorscheStyles();
      debugStyles();
    }, 3000);

  </script>

  <!-- Script de Estadísticas Dinámicas -->
  <script src="./js/estadisticas-dinamicas.js"></script>

  <script>
    console.log('🔍 DEBUG: Iniciando verificación de estadísticas...');

    // CARGAR EMPRESAS DESTACADAS DINÁMICAMENTE
    let empresasDestacadasCargadas = false;

    // Función eliminada - usando loadEmpresasDestacadas que sigue patrón de demo_empresas

    // Función eliminada - usando loadEmpresasDestacadas que sigue patrón de demo_empresas

    // Función eliminada - usando loadEmpresasDestacadas que sigue patrón de demo_empresas

    // Función para el botón de actualizar
    function refreshCompaniesTable() {
      console.log('🔄 Actualizando tabla de empresas...');
      loadEmpresasDestacadas();
    }

    // Cargar empresas al inicializar - INMEDIATO
    console.log('📋 Configurando carga de empresas destacadas...');

    // Usar la misma lógica que demo_empresas.html
    async function loadEmpresasDestacadas() {
      console.log('📡 Cargando empresas destacadas (método demo_empresas)...');
      const tbody = document.getElementById('companiesTableBody');

      if (!tbody) {
        console.error('❌ No se encontró companiesTableBody');
        return;
      }

      // Mostrar loading como en demo_empresas
      tbody.innerHTML = `
      <tr>
        <td colspan="3" class="p-4 text-center">
          <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-red-500 mx-auto mb-2"></div>
          <p class="text-gray-600">Cargando empresas destacadas...</p>
        </td>
      </tr>
    `;

      try {
        const url = `./api/empresas-simple.php?action=listar&t=${Date.now()}`;
        console.log('📡 URL:', url);

        const response = await fetch(url, {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json',
            'Cache-Control': 'no-cache'
          }
        });

        console.log('📡 Response status:', response.status, response.ok);

        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }

        const data = await response.json();
        console.log('📡 Data recibida completa:', JSON.stringify(data, null, 2));

        if (data.success && data.data && data.data.empresas && Array.isArray(data.data.empresas)) {
          // Mostrar las últimas 5 empresas registradas
          const todasEmpresas = data.data.empresas;
          const empresas = todasEmpresas.slice(0, 5); // Tomar las primeras 5 (ya vienen ordenadas por fecha)
          console.log(`✅ ${todasEmpresas.length} empresas totales, mostrando las últimas ${empresas.length}`);
          console.log('🏢 Empresas a mostrar:', empresas);

          if (empresas.length === 0) {
            tbody.innerHTML = `
            <tr>
              <td colspan="3" class="p-6 text-center">
                <i class="fas fa-building text-3xl text-gray-300 mb-2 block"></i>
                <p class="text-gray-300">No hay empresas disponibles</p>
              </td>
            </tr>
          `;
            return;
          }

          // Limpiar tabla
          tbody.innerHTML = '';

          // Renderizar empresas simplificado: nombre, imagen, link y botón
          empresas.forEach((empresa, index) => {
            console.log('📊 Renderizando empresa:', empresa);
            const tr = document.createElement('tr');
            tr.className = 'hover:bg-gray-50 transition-colors';

            // Usar campo 'nombre' de la BD como principal
            const nombreEmpresa = empresa.nombre || `Empresa ID ${empresa.id}`;

            // Logo usando logo_url de la BD
            const logoUrl = empresa.logo_url ||
              `https://ui-avatars.com/api/?name=${encodeURIComponent(nombreEmpresa.charAt(0))}&background=C7252B&color=ffffff&size=64&bold=true`;

            // Usar campo 'sitio_web' de la BD
            const sitioWeb = empresa.sitio_web || '';

            console.log('📝 Campos específicos de la BD:');
            console.log('- ID:', empresa.id);
            console.log('- nombre (BD):', empresa.nombre);
            console.log('- logo_url (BD):', empresa.logo_url);
            console.log('- sitio_web (BD):', empresa.sitio_web);
            console.log('- nombreEmpresa final:', nombreEmpresa);
            console.log('- logoUrl final:', logoUrl);
            console.log('- sitioWeb final:', sitioWeb);

            tr.innerHTML = `
            <td class="p-3 align-middle bg-transparent border-b whitespace-nowrap dark:border-white/40">
              <div class="flex items-center">
                <img src="${logoUrl}" alt="${nombreEmpresa}"
                     class="w-12 h-12 rounded-lg object-cover mr-3"
                     onerror="this.src='https://ui-avatars.com/api/?name=${encodeURIComponent(nombreEmpresa.charAt(0))}&background=C7252B&color=ffffff&size=48&bold=true'">
                <div>
                  <h6 class="mb-0 text-sm font-semibold leading-normal dark:text-white">
                    ${nombreEmpresa}
                  </h6>
                </div>
              </div>
            </td>
            <td class="p-3 text-center align-middle bg-transparent border-b whitespace-nowrap dark:border-white/40">
              ${sitioWeb ? `
                <a href="${sitioWeb.startsWith('http') ? sitioWeb : 'https://' + sitioWeb}" target="_blank"
                   class="text-xs text-blue-500 hover:text-blue-700 transition-colors">
                  <i class="fas fa-external-link-alt mr-1"></i>Visitar
                </a>
              ` : `
                <span class="text-sm font-bold text-gray-500">N/A</span>
              `}
            </td>
            <td class="p-3 text-center align-middle bg-transparent border-b whitespace-nowrap dark:border-white/40">
              <a href="https://intranet.clautmetropolitano.mx/build/empresas-convenio.html"
                 class="inline-flex items-center px-3 py-1.5 text-xs font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors">
                <i class="fas fa-building mr-1"></i>Ver Empresas
              </a>
            </td>
          `;

            // Agregar evento click para mostrar información completa como en empresas-convenio.html
            tr.addEventListener('click', () => {
              mostrarInfoEmpresa(empresa);
            });

            tbody.appendChild(tr);
          });

          empresasDestacadasCargadas = true;
        } else {
          console.log('❌ Respuesta sin datos válidos:', data);
          tbody.innerHTML = `
          <tr>
            <td colspan="5" class="p-6 text-center">
              <i class="fas fa-exclamation-triangle text-3xl text-yellow-500 mb-2 block"></i>
              <p class="text-gray-300 mb-2">Error al cargar empresas</p>
              <button onclick="loadEmpresasDestacadas()" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 text-sm">
                <i class="fas fa-refresh mr-1"></i>Reintentar
              </button>
            </td>
          </tr>
        `;
        }

      } catch (error) {
        console.error('❌ Error cargando empresas destacadas:', error);
        tbody.innerHTML = `
        <tr>
          <td colspan="5" class="p-6 text-center">
            <i class="fas fa-exclamation-triangle text-3xl text-red-500 mb-2 block"></i>
            <p class="text-gray-300 mb-2">Error de conexión: ${error.message}</p>
            <button onclick="loadEmpresasDestacadas()" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 text-sm">
              <i class="fas fa-refresh mr-1"></i>Reintentar
            </button>
          </td>
        </tr>
      `;
      }
    }

    // Ejecutar inmediatamente usando setTimeout como demo_empresas
    setTimeout(() => {
      console.log('📄 [EMPRESAS] Iniciando carga de empresas destacadas...');
      console.log('📄 [EMPRESAS] Ejecutando loadEmpresasDestacadas()...');
      try {
        loadEmpresasDestacadas();
      } catch (error) {
        console.error('❌ [EMPRESAS] Error ejecutando loadEmpresasDestacadas:', error);
      }
    }, 100);

    // También cuando la ventana esté lista por si falla el anterior
    window.addEventListener('load', () => {
      setTimeout(() => {
        if (!empresasDestacadasCargadas) {
          console.log('🔄 Segundo intento de carga de empresas destacadas');
          loadEmpresasDestacadas();
        }
      }, 500);
    });

    // Hacer funciones globales siguiendo patrón de demo_empresas
    window.loadEmpresasDestacadas = loadEmpresasDestacadas;
    window.refreshCompaniesTable = loadEmpresasDestacadas; // Actualizar usa la misma función

    // Función para mostrar información completa de empresa como en empresas-convenio.html
    function mostrarInfoEmpresa(empresa) {
      const nombreEmpresa = empresa.nombre_mostrar || empresa.nombre_empresa || empresa.nombre || 'Empresa sin nombre';
      const sitioWeb = empresa.sitio_web || '';
      const contactoNombre = empresa.contacto_nombre || '';
      const contactoTelefono = empresa.contacto_telefono || empresa.telefono || '';
      const contactoEmail = empresa.contacto_email || empresa.email || '';

      // Construir enlaces de contacto
      let contactoHTML = '';
      if (contactoNombre || contactoTelefono || contactoEmail) {
        contactoHTML = `
        <div class="mt-4 space-y-2">
          <h6 class="text-sm font-semibold text-gray-700">Información de contacto:</h6>
          ${contactoNombre ? `<p class="text-sm"><strong>Contacto:</strong> ${contactoNombre}</p>` : ''}
          ${contactoTelefono ? `<p class="text-sm"><strong>Teléfono:</strong> <a href="tel:${contactoTelefono}" class="text-red-600 hover:text-red-800">${contactoTelefono}</a></p>` : ''}
          ${contactoEmail ? `<p class="text-sm"><strong>Email:</strong> <a href="mailto:${contactoEmail}" class="text-red-600 hover:text-red-800">${contactoEmail}</a></p>` : ''}
        </div>
      `;
      }

      const beneficiosHTML = empresa.beneficios ? `
      <div class="mt-4">
        <h6 class="text-sm font-semibold text-gray-700">Beneficios:</h6>
        <p class="text-sm text-gray-600 mt-1">${empresa.beneficios}</p>
      </div>
    ` : '';

      // Crear modal
      const modalHTML = `
      <div id="empresaInfoModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto">
          <div class="p-6">
            <div class="flex justify-between items-start mb-4">
              <h4 class="text-lg font-semibold text-gray-800">${nombreEmpresa}</h4>
              <button onclick="cerrarModalEmpresa()" class="text-gray-400 hover:text-gray-600 text-xl">
                <i class="fas fa-times"></i>
              </button>
            </div>

            ${empresa.logo_url ? `
              <div class="text-center mb-4">
                <img src="${empresa.logo_url}" alt="${nombreEmpresa}" class="h-20 mx-auto object-contain rounded-lg">
              </div>
            ` : ''}

            ${empresa.descripcion ? `
              <div class="mb-4">
                <p class="text-sm text-gray-600">${empresa.descripcion}</p>
              </div>
            ` : ''}

            <div class="space-y-2 text-sm">
              ${empresa.sector ? `<p><strong>Sector:</strong> ${empresa.sector}</p>` : ''}
              ${empresa.descuento_porcentaje ? `<p><strong>Descuento:</strong> ${empresa.descuento_porcentaje}% de descuento</p>` : ''}
              ${empresa.fecha_convenio_formateada ? `<p><strong>Convenio desde:</strong> ${empresa.fecha_convenio_formateada}</p>` : ''}
            </div>

            ${contactoHTML}
            ${beneficiosHTML}

            ${sitioWeb ? `
              <div class="mt-4 text-center">
                <a href="${sitioWeb.startsWith('http') ? sitioWeb : 'https://' + sitioWeb}"
                   target="_blank"
                   class="inline-flex items-center px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">
                  <i class="fas fa-external-link-alt mr-2"></i>
                  Visitar sitio web
                </a>
              </div>
            ` : ''}
          </div>
        </div>
      </div>
    `;

      // Agregar modal al DOM
      document.body.insertAdjacentHTML('beforeend', modalHTML);
    }

    // Función para cerrar modal
    function cerrarModalEmpresa() {
      const modal = document.getElementById('empresaInfoModal');
      if (modal) {
        modal.remove();
      }
    }

    // Hacer funciones globales
    window.mostrarInfoEmpresa = mostrarInfoEmpresa;
    window.cerrarModalEmpresa = cerrarModalEmpresa;

    // Función de debug simple
    async function debugEstadisticas() {
      try {
        console.log('🔍 DEBUG: Verificando contenedor...');
        const container = document.getElementById('estadisticasContainer');
        console.log('🔍 DEBUG: Contenedor encontrado:', !!container);

        if (container) {
          console.log('🔍 DEBUG: Contenido actual del contenedor:', container.innerHTML);

          // Probar API directamente
          console.log('🔍 DEBUG: Probando API de estadísticas...');
          const response = await fetch('./api/estadisticas-config.php?accion=valores');
          console.log('🔍 DEBUG: Respuesta de API:', response.status, response.ok);

          const data = await response.json();
          console.log('🔍 DEBUG: Datos recibidos:', data);

          if (data.success && data.valores) {
            console.log('🔍 DEBUG: Estadísticas disponibles:', data.valores.length);
            console.log('🔍 DEBUG: Ejemplo de estadística:', data.valores[0]);

            // Crear estadísticas manualmente si el script automático falla
            if (container.innerHTML.includes('Cargando estadísticas...') || container.innerHTML.includes('Error')) {
              console.log('🔧 DEBUG: Script principal falló, cargando estadísticas manualmente...');
              cargarEstadisticasManual(data.valores);
            } else {
              console.log('✅ DEBUG: Script principal funcionó correctamente, no es necesario cargar manualmente');
            }
          } else {
            console.error('❌ DEBUG: Error en datos de API:', data.message);
            mostrarErrorManual('Error en API: ' + (data.message || 'Datos no válidos'));
          }
        }
      } catch (error) {
        console.error('❌ DEBUG: Error en debug:', error);
        mostrarErrorManual('Error de conexión: ' + error.message);
      }
    }

    // Cargar estadísticas manualmente
    function cargarEstadisticasManual(estadisticas) {
      const container = document.getElementById('estadisticasContainer');
      if (!container) return;

      container.innerHTML = '';

      estadisticas.forEach((stat, index) => {
        const div = document.createElement('div');
        div.className = 'w-full max-w-full px-3 mb-6 sm:w-1/2 sm:flex-none xl:mb-0 xl:w-1/4';

        const valor = formatearValorManual(stat.valor, stat.formato);

        const colorClass = getColorClassManual(stat.color);

        div.innerHTML = `
        <div class="relative group overflow-hidden">
          <!-- Efectos de fondo cristal -->
          <div class="absolute inset-0 bg-gradient-to-br from-white/20 via-white/10 to-transparent dark:from-slate-700/20 dark:via-slate-800/10 dark:to-transparent backdrop-blur-2xl rounded-3xl"></div>
          <div class="absolute inset-0 bg-gradient-to-r from-cyan-500/5 via-blue-500/5 to-purple-500/5 dark:from-cyan-400/10 dark:via-blue-400/10 dark:to-purple-400/10 rounded-3xl"></div>

          <!-- Bordes cristal -->
          <div class="absolute inset-0 rounded-3xl border border-white/30 dark:border-white/20 shadow-[0_8px_32px_rgba(31,38,135,0.37)] dark:shadow-[0_8px_32px_rgba(0,0,0,0.5)]"></div>
          <div class="absolute inset-0 rounded-3xl border-2 border-transparent bg-gradient-to-r from-white/40 via-transparent to-white/40 dark:from-slate-400/20 dark:via-transparent dark:to-slate-400/20 bg-clip-border"></div>

          <!-- Contenido principal -->
          <div class="relative flex flex-col min-w-0 break-words backdrop-blur-3xl bg-white/10 dark:bg-slate-900/20 rounded-3xl transition-all duration-500 ease-out group-hover:bg-gray-800/20 dark:group-hover:bg-slate-800/30 group-hover:scale-[1.02] group-hover:shadow-[0_20px_60px_rgba(31,38,135,0.4)] dark:group-hover:shadow-[0_20px_60px_rgba(0,0,0,0.6)]">
            <!-- Efecto de brillo superior -->
            <div class="absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-white/60 to-transparent dark:via-slate-300/40"></div>

            <div class="flex-auto p-6 relative">
              <!-- Partículas flotantes decorativas -->
              <div class="absolute top-2 right-2 w-1 h-1 bg-cyan-400 rounded-full opacity-60 animate-pulse"></div>
              <div class="absolute top-4 right-8 w-0.5 h-0.5 bg-blue-400 rounded-full opacity-40 animate-pulse" style="animation-delay: 1s;"></div>

              <div class="flex flex-row -mx-3">
                <div class="flex-none w-2/3 max-w-full px-3">
                  <div>
                    <p class="mb-1 font-sans text-sm font-semibold leading-normal uppercase text-slate-600/90 dark:text-slate-300/80 tracking-wider">
                      ${stat.titulo}
                    </p>
                    <h5 class="mb-3 font-bold text-3xl bg-gradient-to-r from-slate-800 via-slate-700 to-slate-900 dark:from-white dark:via-slate-100 dark:to-slate-200 bg-clip-text text-transparent leading-tight">
                      ${valor}
                    </h5>
                    <p class="mb-0 flex items-center gap-2">
                      <span class="inline-flex items-center text-sm font-bold leading-normal text-emerald-600 dark:text-emerald-400 bg-gradient-to-r from-emerald-50 to-emerald-100 dark:from-emerald-900/40 dark:to-emerald-800/30 backdrop-blur-sm px-3 py-1.5 rounded-full border border-emerald-200/50 dark:border-emerald-700/30 shadow-sm">
                        ${(stat.crecimiento > 0 ? '+' : '') + (stat.crecimiento || 0)}
                      </span>
                      <span class="text-slate-500 dark:text-slate-400 text-sm font-medium">${stat.crecimiento_texto || 'Valor actual'}</span>
                    </p>
                  </div>
                </div>
                <div class="px-3 text-right basis-1/3 flex items-center justify-center">
                  <div class="relative">
                    <!-- Halo de fondo para el icono -->
                    <div class="absolute inset-0 bg-gradient-to-tl ${colorClass} rounded-2xl opacity-20 blur-lg scale-110"></div>

                    <!-- Contenedor del icono con efecto cristal -->
                    <div class="relative w-16 h-16 flex items-center justify-center rounded-2xl bg-gradient-to-tl ${colorClass} shadow-xl backdrop-blur-sm border border-white/30 dark:border-white/20 overflow-hidden group-hover:scale-110 transition-transform duration-300">
                      <!-- Efecto de brillo en el icono -->
                      <div class="absolute inset-0 bg-gradient-to-br from-white/30 via-transparent to-transparent"></div>
                      <div class="absolute top-0 left-0 w-full h-px bg-gradient-to-r from-transparent via-white/60 to-transparent"></div>

                      <i class="${stat.icono} text-2xl text-white drop-shadow-lg relative z-10"></i>

                      <!-- Efecto de partículas en el icono -->
                      <div class="absolute top-1 right-1 w-1 h-1 bg-white/60 rounded-full"></div>
                      <div class="absolute bottom-2 left-2 w-0.5 h-0.5 bg-white/40 rounded-full"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Efecto de brillo inferior -->
            <div class="absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-white/40 to-transparent dark:via-slate-500/20"></div>
          </div>
        </div>
      `;

        container.appendChild(div);
      });

      console.log('✅ DEBUG: Estadísticas cargadas manualmente');
    }

    // Mostrar error manual
    function mostrarErrorManual(mensaje) {
      const container = document.getElementById('estadisticasContainer');
      if (!container) return;

      container.innerHTML = `
      <div class="w-full text-center py-8">
        <div class="text-red-500">
          <i class="fas fa-exclamation-triangle text-4xl mb-4"></i>
          <p class="text-lg font-semibold">Error al cargar estadísticas</p>
          <p class="text-sm">${mensaje}</p>
          <button onclick="debugEstadisticas()" class="mt-4 bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded">
            Reintentar
          </button>
        </div>
      </div>
    `;
    }

    // Formatear valor manual
    function formatearValorManual(valor, formato) {
      const num = Number(valor) || 0;

      switch (formato) {
        case 'percentage':
          return num.toFixed(1) + '%';
        case 'currency':
          return '$' + num.toLocaleString('es-ES');
        case 'text':
          return valor.toString();
        default:
          return num.toLocaleString('es-ES');
      }
    }

    // Color class manual
    function getColorClassManual(color) {
      const colors = {
        'blue': 'from-blue-500 to-violet-500',
        'green': 'from-emerald-500 to-teal-400',
        'red': 'from-red-600 to-orange-600',
        'orange': 'from-orange-500 to-yellow-500',
        'purple': 'from-purple-700 to-pink-500'
      };
      return colors[color] || colors['blue'];
    }

    // Ejecutar debug después de cargar la página
    document.addEventListener('DOMContentLoaded', function () {
      console.log('🔍 DEBUG: DOM cargado, esperando 2 segundos...');
      setTimeout(debugEstadisticas, 2000);
    });

    // También ejecutar si la página ya está cargada
    if (document.readyState === 'loading') {
      console.log('🔍 DEBUG: Página aún cargando, esperando DOMContentLoaded...');
    } else {
      console.log('🔍 DEBUG: Página ya cargada, ejecutando debug inmediatamente...');
      setTimeout(debugEstadisticas, 1000);
    }

    // Función global para debug manual
    window.debugEstadisticas = debugEstadisticas;

    console.log('🔍 DEBUG: Script de debug configurado');
  </script>

  <!-- Animaciones Futuristas Avanzadas -->
  <style>
    /* Animaciones personalizadas futuristas */
    @keyframes matrix-rain {
      0% {
        transform: translateY(-100vh) rotate(0deg);
        opacity: 0;
      }

      10% {
        opacity: 1;
      }

      90% {
        opacity: 1;
      }

      100% {
        transform: translateY(100vh) rotate(360deg);
        opacity: 0;
      }
    }

    @keyframes hologram-flicker {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: 0.8;
      }

      75% {
        opacity: 0.9;
      }
    }

    @keyframes neon-pulse {

      0%,
      100% {
        box-shadow: 0 0 5px currentColor, 0 0 10px currentColor, 0 0 15px currentColor;
        filter: brightness(1);
      }

      50% {
        box-shadow: 0 0 10px currentColor, 0 0 20px currentColor, 0 0 30px currentColor;
        filter: brightness(1.2);
      }
    }

    @keyframes data-stream {
      0% {
        transform: translateX(-100%) scaleY(0.5);
      }

      50% {
        transform: translateX(0%) scaleY(1);
      }

      100% {
        transform: translateX(100%) scaleY(0.5);
      }
    }

    @keyframes cyber-glitch {

      0%,
      100% {
        transform: translate(0);
      }

      10% {
        transform: translate(-2px, 1px);
      }

      20% {
        transform: translate(2px, -1px);
      }

      30% {
        transform: translate(-1px, 2px);
      }

      40% {
        transform: translate(1px, -2px);
      }

      50% {
        transform: translate(-2px, -1px);
      }

      60% {
        transform: translate(2px, 1px);
      }

      70% {
        transform: translate(-1px, -2px);
      }

      80% {
        transform: translate(1px, 2px);
      }

      90% {
        transform: translate(-2px, 1px);
      }
    }

    @keyframes quantum-float {

      0%,
      100% {
        transform: translateY(0px) rotate(0deg);
      }

      25% {
        transform: translateY(-10px) rotate(90deg);
      }

      50% {
        transform: translateY(-20px) rotate(180deg);
      }

      75% {
        transform: translateY(-10px) rotate(270deg);
      }
    }

    /* Aplicar animaciones a elementos específicos */
    .message-tab:hover {
      animation: neon-pulse 2s infinite;
    }

    .fas.fa-envelope-open {
      animation: hologram-flicker 3s infinite, quantum-float 4s infinite;
    }

    .fas.fa-sync-alt:hover {
      animation: cyber-glitch 0.5s infinite;
    }

    /* Efecto de lluvia de datos en el fondo */
    #messageModal::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.1), transparent);
      animation: data-stream 3s infinite;
      pointer-events: none;
      z-index: 1;
    }

    /* Efectos de partículas flotantes */
    .cyber-particles {
      position: absolute;
      width: 100%;
      height: 100%;
      overflow: hidden;
      pointer-events: none;
    }

    .cyber-particles::before,
    .cyber-particles::after {
      content: '';
      position: absolute;
      width: 2px;
      height: 2px;
      background: #00ffff;
      border-radius: 50%;
      animation: matrix-rain 4s infinite linear;
    }

    .cyber-particles::before {
      left: 20%;
      animation-delay: 0s;
    }

    .cyber-particles::after {
      left: 80%;
      animation-delay: 2s;
    }

    /* Estilos para el Modal de Detalle de Mensaje */
    #messageDetailModal {
      background: rgba(0, 0, 0, 0.8) !important;
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
    }

    #messageDetailModal.show {
      opacity: 1 !important;
      pointer-events: auto !important;
      display: block !important;
      visibility: visible !important;
    }

    #messageDetailModal.show #messageDetailContainer {
      transform: scale(1) !important;
      opacity: 1 !important;
      display: block !important;
      visibility: visible !important;
    }

    /* Ensure initial state is properly set */
    #messageDetailContainer {
      transform: scale(0.95);
      opacity: 0;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    #messageDetailModal .transition-all {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Forzar visibilidad máxima */
    #messageDetailModal.show {
      z-index: 999999 !important;
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      width: 100vw !important;
      height: 100vh !important;
    }

    /* Animación suave para el contenido */
    #messageDetailContent {
      max-height: 400px;
      overflow-y: auto;
    }

    #messageDetailContent::-webkit-scrollbar {
      width: 6px;
    }

    #messageDetailContent::-webkit-scrollbar-track {
      background: black;
      border-radius: 3px;
    }

    #messageDetailContent::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border-radius: 3px;
    }

    #messageDetailContent::-webkit-scrollbar-thumb:hover {
      background: #a1a1a1;
    }

    /* Estilos para diferentes tipos de contenido */
    .message-content-link {
      color: #3B82F6;
      text-decoration: underline;
    }

    .message-content-link:hover {
      color: #1D4ED8;
    }

    .message-attachment-item {
      border: 1px solid #E5E7EB;
      border-radius: 8px;
      padding: 12px;
      display: flex;
      items-center;
      space-between;
      background: #F9FAFB;
      transition: background-color 0.2s;
    }

    .message-attachment-item:hover {
      background: #F3F4F6;
    }

    /* Estilos específicos para el centro de mensajes */
    #messagesContainer {
      overflow-y: auto !important;
      overflow-x: hidden;
      scrollbar-width: thin;
      scrollbar-color: rgba(199, 37, 43, 0.3) transparent;
    }

    #messagesContainer::-webkit-scrollbar {
      width: 6px;
    }

    #messagesContainer::-webkit-scrollbar-track {
      background: black;
      border-radius: 3px;
    }

    #messagesContainer::-webkit-scrollbar-thumb {
      background: rgba(199, 37, 43, 0.3);
      border-radius: 3px;
      transition: background-color 0.3s ease;
    }

    #messagesContainer::-webkit-scrollbar-thumb:hover {
      background: rgba(199, 37, 43, 0.5);
    }

    /* Asegurar que el contenedor del centro de mensajes tenga altura fija */
    #messageContainer .relative.h-full.flex.flex-col {
      height: 100% !important;
      display: flex !important;
      flex-direction: column !important;
    }

    #messagesList {
      padding-right: 4px;
      /* Para que el scroll no tape contenido */
    }
  </style>

  <!-- CSS para Estadísticas con Efectos Glowing -->
  <style>
    @font-face {
      font-family: "Mona Sans";
      src: url("https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7.woff2") format("woff2");
      font-weight: 100 1000;
    }

    @property --hue {
      syntax: "<number>";
      inherits: true;
      initial-value: 0;
    }

    @property --rotate {
      syntax: "<number>";
      inherits: true;
      initial-value: 0;
    }

    @property --bg-y {
      syntax: "<number>";
      inherits: true;
      initial-value: 0;
    }

    @property --bg-x {
      syntax: "<number>";
      inherits: true;
      initial-value: 0;
    }

    @property --glow-translate-y {
      syntax: "<number>";
      inherits: true;
      initial-value: 0;
    }

    @property --bg-size {
      syntax: "<number>";
      inherits: true;
      initial-value: 0;
    }

    @property --glow-opacity {
      syntax: "<number>";
      inherits: true;
      initial-value: 0;
    }

    @property --glow-blur {
      syntax: "<number>";
      inherits: true;
      initial-value: 0;
    }

    @property --glow-scale {
      syntax: "<number>";
      inherits: true;
      initial-value: 2;
    }

    @property --glow-radius {
      syntax: "<number>";
      inherits: true;
      initial-value: 2;
    }

    @property --white-shadow {
      syntax: "<number>";
      inherits: true;
      initial-value: 0;
    }

    .glowing-stats-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 0.75rem;
      padding: 1.25rem;
      width: calc(100% - 400px);
      max-width: calc(80rem - 400px);
      margin: 0 100px 0 auto;
      padding-left: 0.875rem;
      padding-right: 0.875rem;
      justify-content: center;
      align-items: start;
      background: linear-gradient(145deg, #f8fafc 0%, #f1f5f9 100%);
      border-radius: 16px;
      box-shadow:
        0 4px 6px -1px rgba(0, 0, 0, 0.1),
        0 2px 4px -1px rgba(0, 0, 0, 0.06),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(226, 232, 240, 0.8);
      overflow: hidden;
      box-sizing: border-box;
    }

    /* Forzar que todas las tarjetas usen el diseño glowing */
    .glowing-stats-container .w-full {
      width: 100%;
      max-width: none;
      padding: 0;
      margin: 1rem auto;
      background: transparent;
    }

    .glowing-stats-container .stat-card {
      position: relative;
      width: 100%;
      min-height: 85px;
      height: auto;
      padding: 0.75rem;
      background: rgba(15, 15, 15, 0.95);
      border: 2px solid transparent;
      border-radius: 12px;
      box-shadow:
        0 4px 15px rgba(0, 0, 0, 0.1),
        0 2px 8px rgba(0, 0, 0, 0.05);
      overflow: visible;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      justify-content: center;
      text-align: left;
      box-sizing: border-box;
      z-index: 1;
    }

    .glowing-stats-container .stat-card::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: 12px;
      z-index: -1;
      background:
        linear-gradient(90deg, transparent 85%, var(--electricity-color-1) 87%, var(--electricity-color-2) 89%, var(--electricity-color-3) 91%, var(--electricity-color-4) 93%, var(--electricity-color-5) 95%, transparent 97%) top / 100% 1px no-repeat,
        linear-gradient(0deg, transparent 85%, var(--electricity-color-1) 87%, var(--electricity-color-2) 89%, var(--electricity-color-3) 91%, var(--electricity-color-4) 93%, var(--electricity-color-5) 95%, transparent 97%) right / 1px 100% no-repeat,
        linear-gradient(270deg, transparent 85%, var(--electricity-color-1) 87%, var(--electricity-color-2) 89%, var(--electricity-color-3) 91%, var(--electricity-color-4) 93%, var(--electricity-color-5) 95%, transparent 97%) bottom / 100% 1px no-repeat,
        linear-gradient(180deg, transparent 85%, var(--electricity-color-1) 87%, var(--electricity-color-2) 89%, var(--electricity-color-3) 91%, var(--electricity-color-4) 93%, var(--electricity-color-5) 95%, transparent 97%) left / 1px 100% no-repeat;
      animation: electricity-perimeter 4s linear infinite;
    }

    @keyframes electricity-perimeter {
      0% {
        background-position: -100% 0, 100% -100%, 200% 100%, 0 200%;
        opacity: 0.9;
      }

      25% {
        background-position: 100% 0, 100% -100%, 200% 100%, 0 200%;
        opacity: 1;
      }

      50% {
        background-position: 100% 0, 100% 100%, 200% 100%, 0 200%;
        opacity: 1;
      }

      75% {
        background-position: 100% 0, 100% 100%, -100% 100%, 0 200%;
        opacity: 1;
      }

      100% {
        background-position: 100% 0, 100% 100%, -100% 100%, 0 -100%;
        opacity: 0.9;
      }
    }

    .glowing-stats-container .stat-card::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: 12px;
      z-index: -2;
      background:
        linear-gradient(90deg, transparent 85%, rgba(255, 0, 128, 0.3) 87%, rgba(255, 69, 0, 0.3) 89%, rgba(255, 215, 0, 0.3) 91%, rgba(0, 255, 128, 0.3) 93%, rgba(0, 191, 255, 0.3) 95%, transparent 97%) top / 100% 1px no-repeat,
        linear-gradient(0deg, transparent 85%, rgba(255, 0, 128, 0.3) 87%, rgba(255, 69, 0, 0.3) 89%, rgba(255, 215, 0, 0.3) 91%, rgba(0, 255, 128, 0.3) 93%, rgba(0, 191, 255, 0.3) 95%, transparent 97%) right / 1px 100% no-repeat,
        linear-gradient(270deg, transparent 85%, rgba(255, 0, 128, 0.3) 87%, rgba(255, 69, 0, 0.3) 89%, rgba(255, 215, 0, 0.3) 91%, rgba(0, 255, 128, 0.3) 93%, rgba(0, 191, 255, 0.3) 95%, transparent 97%) bottom / 100% 1px no-repeat,
        linear-gradient(180deg, transparent 85%, rgba(255, 0, 128, 0.3) 87%, rgba(255, 69, 0, 0.3) 89%, rgba(255, 215, 0, 0.3) 91%, rgba(0, 255, 128, 0.3) 93%, rgba(0, 191, 255, 0.3) 95%, transparent 97%) left / 1px 100% no-repeat;
      animation: electricity-perimeter 4s linear infinite;
      filter: blur(2px);
      opacity: 0;
    }

    /* Electricity color variables */
    .glowing-stats-container .stat-card {
      --electricity-color-1: #ff0080;
      --electricity-color-2: #ff4500;
      --electricity-color-3: #ffd700;
      --electricity-color-4: #00ff80;
      --electricity-color-5: #00bfff;
    }


    .glowing-stats-container .stat-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow:
        0 15px 35px rgba(0, 0, 0, 0.2),
        0 8px 20px rgba(0, 0, 0, 0.15);
      border-color: transparent;
    }

    .glowing-stats-container .stat-card:hover::before {
      opacity: 1;
      animation-play-state: running;
      filter: brightness(1.3) saturate(1.4) drop-shadow(0 0 8px rgba(255, 0, 128, 0.6));
    }

    .glowing-stats-container .stat-card:hover::after {
      opacity: 0.7;
      animation-play-state: running;
    }

    /* Prevenir overflow horizontal */
    #estadisticas {
      width: 100% !important;
      max-width: 100% !important;
      overflow-x: hidden !important;
      box-sizing: border-box !important;
    }

    #estadisticasContainer {
      width: 100% !important;
      max-width: 100% !important;
      overflow: hidden !important;
      box-sizing: border-box !important;
    }


    /* Indicadores de crecimiento mejorados */
    .glowing-stats-container .stat-card .growth-indicator {
      display: flex;
      align-items: center;
      font-size: 0.75rem;
      font-weight: 600;
      color: #22c55e;
      margin-top: 0.5rem;
      padding: 0.25rem 0.5rem;
      background: rgba(34, 197, 94, 0.1);
      border-radius: 6px;
      width: fit-content;
    }

    .glowing-stats-container .stat-card .growth-indicator.negative {
      color: #ef4444;
      background: rgba(239, 68, 68, 0.1);
    }

    .glowing-stats-container .stat-card .growth-indicator i {
      font-size: 0.75rem !important;
      margin-right: 0.25rem;
      margin-bottom: 0 !important;
      opacity: 1 !important;
    }

    /* Estilos para el contenido interno de las tarjetas existentes */
    .glowing-stats-container .stat-card .flex-auto {
      position: relative;
      z-index: 2;
      padding: 0 !important;
      height: auto;
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 0.25rem;
    }

    .glowing-stats-container .stat-card p {
      color: #94a3b8 !important;
      font-size: 0.75rem !important;
      font-weight: 600 !important;
      letter-spacing: 0.025em !important;
      margin: 0 !important;
      text-transform: uppercase !important;
      transition: all 0.3s ease !important;
    }

    .glowing-stats-container .stat-card h5 {
      color: #f1f5f9 !important;
      font-size: 1.5rem !important;
      font-weight: 800 !important;
      letter-spacing: -0.025em !important;
      line-height: 1.1 !important;
      margin: 0 !important;
      transition: all 0.3s ease !important;
    }

    .glowing-stats-container .stat-card:hover p {
      color: #cbd5e1 !important;
      text-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
    }

    .glowing-stats-container .stat-card:hover h5 {
      color: #ffffff !important;
      text-shadow: 0 0 12px rgba(255, 255, 255, 0.5);
    }

    /* Mejorar iconos si existen */
    .glowing-stats-container .stat-card i {
      font-size: 0.875rem !important;
      color: #94a3b8 !important;
      transition: all 0.3s ease !important;
      margin-bottom: 0.25rem !important;
      opacity: 1;
    }

    .glowing-stats-container .stat-card:hover i {
      color: #64748b !important;
    }

    .glowing-stat-card {
      /* Variables exactas de la referencia */
      --card-color: hsl(260deg 100% 3%);
      --text-color: hsl(260deg 10% 55%);
      --card-radius: 2rem;
      --card-width: 100%;
      --border-width: 3px;
      --bg-size: 1;
      --hue: 0;
      --hue-speed: 1;
      --rotate: 0;
      --animation-speed: 4s;
      --interaction-speed: 0.55s;
      --glow-scale: 1.5;
      --scale-factor: 1;
      --glow-blur: 6;
      --glow-opacity: 1;
      --glow-radius: 100;
      --glow-rotate-unit: 1deg;

      /* Diseño de tarjeta */
      width: 100%;
      min-width: 520px;
      max-width: 600px;
      aspect-ratio: 1.8/1;
      color: white;
      margin: 1rem auto;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      z-index: 2;
      border-radius: var(--card-radius);
      cursor: pointer;
      font-family: "Mona Sans", sans-serif;
    }

    .glowing-stat-card:hover .stat-content {
      mix-blend-mode: darken;
      --text-color: white;
      box-shadow: 0 0 calc(var(--white-shadow) * 1vw) calc(var(--white-shadow) * 0.15vw) rgb(255 255 255 / 20%);
      animation: shadow-pulse calc(var(--animation-speed) * 2) linear infinite;
    }

    .glowing-stat-card:hover .stat-content:before {
      --bg-size: 15;
      animation-play-state: paused;
      transition: --bg-size var(--interaction-speed) ease;
    }

    .glowing-stat-card:hover .glow {
      --glow-blur: 1.5;
      --glow-opacity: 0.6;
      --glow-scale: 2.5;
      --glow-radius: 0;
      --rotate: 900;
      --glow-rotate-unit: 0;
      --scale-factor: 1.25;
      animation-play-state: paused;
    }

    .glowing-stat-card:hover .glow:after {
      --glow-translate-y: 0;
      animation-play-state: paused;
      transition: --glow-translate-y 0s ease, --glow-blur 0.05s ease,
        --glow-opacity 0.05s ease, --glow-scale 0.05s ease,
        --glow-radius 0.05s ease;
    }

    .glowing-stat-card:before,
    .glowing-stat-card:after {
      content: "";
      display: block;
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: var(--card-radius);
    }

    .stat-content {
      position: absolute;
      width: 100%;
      height: 100%;
      background: var(--card-color);
      border-radius: calc(var(--card-radius) * 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      text-transform: uppercase;
      font-stretch: 150%;
      font-size: 20px;
      font-size: clamp(1.1rem, 1.8vmin, 1.8rem);
      color: var(--text-color);
      padding: 2rem 3rem;
      text-align: center;
      line-height: 1.2;
    }

    .stat-content:before {
      content: "";
      display: block;
      position: absolute;
      width: calc(100% + var(--border-width));
      height: calc(100% + var(--border-width));
      top: calc(var(--border-width) / -2);
      left: calc(var(--border-width) / -2);
      border-radius: calc(var(--card-radius) * 0.9);
      box-shadow: 0 0 20px black;
      mix-blend-mode: color-burn;
      z-index: -1;
      background: hsl(0deg 0% 16%) radial-gradient(30% 30% at calc(var(--bg-x) * 1%) calc(var(--bg-y) * 1%),
          hsl(calc(var(--hue) * 1deg) 100% 90%) calc(0% * var(--bg-size)),
          hsl(calc(var(--hue) * 1deg) 100% 80%) calc(20% * var(--bg-size)),
          hsl(calc(var(--hue) * 1deg) 100% 60%) calc(40% * var(--bg-size)),
          transparent 100%);
      animation: hue-animation var(--animation-speed) linear infinite,
        rotate-bg var(--animation-speed) linear infinite;
      transition: --bg-size var(--interaction-speed) ease;
    }

    .stat-number-badge {
      display: inline-block;
      padding: 0.4em 0.6em;
      border-radius: 6px;
      background: var(--text-color);
      color: black;
      margin-right: 12px;
      font-weight: 900;
      font-size: 1.1em;
      min-width: 2.5em;
      text-align: center;
    }

    .glow {
      --glow-translate-y: 0;
      display: block;
      position: absolute;
      width: calc(var(--card-width) / 5);
      height: calc(var(--card-width) / 5);
      animation: rotate var(--animation-speed) linear infinite;
      transform: rotateZ(calc(var(--rotate) * var(--glow-rotate-unit)));
      transform-origin: center;
      border-radius: calc(var(--glow-radius) * 10vw);
    }

    .glow:after {
      content: "";
      display: block;
      z-index: -2;
      filter: blur(calc(var(--glow-blur) * 10px));
      width: 130%;
      height: 130%;
      left: -15%;
      top: -15%;
      background: hsl(calc(calc(var(--hue) * var(--hue-speed)) * 1deg) 100% 60%);
      position: relative;
      border-radius: calc(var(--glow-radius) * 10vw);
      animation: hue-animation var(--animation-speed) linear infinite;
      transform: scaleY(calc(var(--glow-scale) * var(--scale-factor) / 1.1)) scaleX(calc(var(--glow-scale) * var(--scale-factor) * 1.2)) translateY(calc(var(--glow-translate-y) * 1%));
      opacity: var(--glow-opacity);
    }

    /* Colores específicos para cada tipo de estadística - Solo glow */
    .glowing-stat-card.usuarios {
      --hue: 240;
    }

    .glowing-stat-card.empresas {
      --hue: 320;
    }

    .glowing-stat-card.comites {
      --hue: 190;
    }

    .glowing-stat-card.eventos {
      --hue: 160;
    }

    .glowing-stat-card.descuentos {
      --hue: 45;
    }

    .glowing-stat-card.boletines {
      --hue: 300;
    }

    @keyframes shadow-pulse {

      0%,
      24%,
      46%,
      73%,
      96% {
        --white-shadow: 0.5;
      }

      12%,
      28%,
      41%,
      63%,
      75%,
      82%,
      98% {
        --white-shadow: 2.5;
      }

      6%,
      32%,
      57% {
        --white-shadow: 1.3;
      }

      18%,
      52%,
      88% {
        --white-shadow: 3.5;
      }
    }

    @keyframes rotate-bg {
      0% {
        --bg-x: 0;
        --bg-y: 0;
      }

      25% {
        --bg-x: 100;
        --bg-y: 0;
      }

      50% {
        --bg-x: 100;
        --bg-y: 100;
      }

      75% {
        --bg-x: 0;
        --bg-y: 100;
      }

      100% {
        --bg-x: 0;
        --bg-y: 0;
      }
    }

    @keyframes rotate {
      from {
        --rotate: -70;
        --glow-translate-y: -65;
      }

      25% {
        --glow-translate-y: -65;
      }

      50% {
        --glow-translate-y: -65;
      }

      60%,
      75% {
        --glow-translate-y: -65;
      }

      85% {
        --glow-translate-y: -65;
      }

      to {
        --rotate: calc(360 - 70);
        --glow-translate-y: -65;
      }
    }

    @keyframes hue-animation {
      0% {
        --hue: 0;
      }

      100% {
        --hue: 360;
      }
    }

    /* Animaciones para efectos de scroll */
    @keyframes gradientShift {
      0% {
        background-position: 0% 50%;
      }

      50% {
        background-position: 100% 50%;
      }

      100% {
        background-position: 0% 50%;
      }
    }

    /* Main Gradient Background Animations */

    @keyframes particlesFloat {

      0%,
      100% {
        transform: translateY(0px) rotate(0deg);
        opacity: 0.3;
      }

      25% {
        transform: translateY(-20px) rotate(90deg);
        opacity: 0.5;
      }

      50% {
        transform: translateY(-10px) rotate(180deg);
        opacity: 0.7;
      }

      75% {
        transform: translateY(-30px) rotate(270deg);
        opacity: 0.4;
      }
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(60px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes staggerFadeIn {
      from {
        opacity: 0;
        transform: translateY(40px) scale(0.95);
      }

      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    /* Clases para efectos de scroll */
    .stats-scroll-section {
      position: relative;
    }

    /* Ensure statistics cards are always visible */
    .glowing-stats-container {
      position: relative !important;
      z-index: 10 !important;
    }

    .glowing-stats-container .stat-card {
      position: relative !important;
      z-index: 15 !important;
      opacity: 1 !important;
      transform: translateY(0) !important;
    }

    .stats-header-reveal {
      position: relative !important;
      z-index: 8 !important;
    }

    /* Main Container Gradient Background */
    .main-scroll-container {
      position: relative;
      min-height: 100vh;
    }

    /* Background Scroll Image Styles */
    .scroll-image-section {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: var(--claut-bg-main);
      overflow: hidden;
      z-index: -10;
    }

    .image-motion {
      width: 100%;
      height: 100%;
      transform-origin: 50% 0;
      transform: rotateX(90deg);
      will-change: transform;
    }

    .image-motion img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    /* Ensure main content is above background */
    .claut-main {
      position: relative;
      z-index: 1;
      background: transparent;
    }

    .main-content-wrapper {
      position: relative;
      z-index: 10;
      background: rgba(10, 10, 10, 0.4);
      /* Más transparente para ver scroll effect */
      backdrop-filter: blur(1px);
    }

    .main-particles-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image:
        radial-gradient(2px 2px at 20px 30px, rgba(199, 37, 43, 0.3), transparent),
        radial-gradient(2px 2px at 40px 70px, rgba(99, 102, 241, 0.2), transparent),
        radial-gradient(1px 1px at 90px 40px, rgba(199, 37, 43, 0.4), transparent),
        radial-gradient(1px 1px at 130px 80px, rgba(255, 255, 255, 0.1), transparent),
        radial-gradient(2px 2px at 160px 30px, rgba(99, 102, 241, 0.3), transparent);
      background-repeat: repeat;
      background-size: 200px 100px;
      animation: particlesFloat 15s linear infinite;
      z-index: -1;
      opacity: 0.6;
    }

    .main-content-wrapper {
      position: relative;
      z-index: 10;
    }

    /* Responsive Layout Fixes - Preserving Original Layout */
    @media (max-width: 768px) {
      .main-content-wrapper {
        padding-left: 1rem !important;
        padding-right: 1rem !important;
      }

      .porsche-navbar {
        margin-left: 0 !important;
        margin-right: 0 !important;
        padding-left: 1rem !important;
        padding-right: 1rem !important;
      }
    }

    @media (max-width: 480px) {
      .main-content-wrapper {
        padding-left: 0.75rem !important;
        padding-right: 0.75rem !important;
      }

      .porsche-navbar {
        padding-left: 0.75rem !important;
        padding-right: 0.75rem !important;
      }
    }

    /* Desktop Layout - Full Width - FORCE OVERRIDES */
    @media (min-width: 1025px) {
      .main-content-wrapper {
        padding-left: 0 !important;
        padding-right: 0 !important;
        margin: 0 !important;
        width: 100% !important;
        max-width: 100% !important;
      }

      .porsche-navbar {
        margin-left: var(--space-4) !important;
        margin-right: var(--space-4) !important;
        padding-left: var(--space-4) !important;
        padding-right: var(--space-4) !important;
        width: calc(100% - 2 * var(--space-4)) !important;
        max-width: calc(100% - 2 * var(--space-4)) !important;
      }

      .apple-space-responsive {
        padding: 0 var(--space-4) !important;
        margin: 0 !important;
        max-width: 100% !important;
      }

      .claut-main {
        margin-left: 0 !important;
        margin-right: 0 !important;
        padding-left: 0 !important;
        padding-right: 0 !important;
        width: 100% !important;
        max-width: 100% !important;
      }

      /* Mantener diseño responsive sin límites excesivos */
      .main-content-wrapper,
      .content-gradient-container {
        width: 100% !important;
      }

      /* DESHABILITAR EFECTOS DE ESCALA */
      .expanding-card:hover,
      .expanding-card.active:hover,
      .claut-card:hover,
      .apple-card:hover,
      .porsche-card:hover,
      .stat-card:hover,
      .group-hover\:scale-\[1\.02\]:hover,
      *[class*="hover:scale"]:hover {
        transform: translateY(-2px) !important;
      }

      .expanding-card {
        transform: scale(1) !important;
      }

      .expanding-card.active {
        transform: scale(1) !important;
      }

      /* DESHABILITAR EFECTOS DE ESCALA EN BOTONES Y NAVEGACIÓN */
      .claut-nav-item:hover,
      .claut-header-btn:hover,
      .claut-nav-link:hover,
      button:hover,
      .icon-modern:hover {
        transform: translateY(-2px) !important;
      }

      /* DESHABILITAR EFECTOS DE ESCALA EN ICONOS Y LOGOS */
      .claut-header-logo:hover img,
      .claut-hero-logo:hover,
      .claut-nav-item:hover i {
        transform: none !important;
      }

      /* FORZAR POSICIÓN FIJA DEL NAVBAR - DESHABILITAR ANIMACIONES */
      .porsche-navbar[navbar-main] {
        margin-top: 80px !important;
        margin-left: 120px !important;
        margin-right: 120px !important;
        width: calc(100% - 240px) !important;
        max-width: calc(100% - 240px) !important;
        transform: none !important;
        animation: none !important;
        transition: none !important;
        box-sizing: border-box !important;
      }

      nav[navbar-main][navbar-scroll="false"] {
        margin-top: 80px !important;
        margin-left: 120px !important;
        margin-right: 120px !important;
        width: calc(100% - 240px) !important;
        max-width: calc(100% - 240px) !important;
        transform: translateY(0) !important;
        position: relative !important;
        top: auto !important;
        box-sizing: border-box !important;
      }

      /* RESPONSIVE MOBILE (max-width: 768px) */
      @media (max-width: 768px) {

        /* Main container mobile */
        .claut-main {
          padding: var(--space-2) var(--space-3) 0 var(--space-3) !important;
        }

        /* Navbar mobile */
        .porsche-navbar[navbar-main],
        nav[navbar-main][navbar-scroll="false"] {
          margin-top: 20px !important;
          margin-left: var(--space-3) !important;
          margin-right: var(--space-3) !important;
          width: calc(100% - 2 * var(--space-3)) !important;
          max-width: calc(100% - 2 * var(--space-3)) !important;
        }

        /* Contenido principal mobile */
        .content-gradient-container {
          padding: 0 var(--space-2) !important;
        }

        /* Hero section mobile */
        .claut-hero {
          margin: var(--space-4) 0 var(--space-8) 0 !important;
          min-height: 40vh !important;
          padding: 0 var(--space-2) !important;
        }

        /* Tarjetas mobile */
        .flex.flex-wrap.mt-12.-mx-3 {
          margin-top: var(--space-6) !important;
          padding: 0 var(--space-2) !important;
        }

        .w-full.max-w-full.px-3 {
          margin-left: 0 !important;
          margin-right: 0 !important;
          margin-bottom: var(--space-6) !important;
          padding: 0 var(--space-1) !important;
        }

        /* Carrusel mobile */
        #expandingCardsContainer {
          margin: var(--space-4) 0 !important;
          padding: 0 var(--space-2) !important;
        }

        /* Estadísticas mobile */
        .stats-scroll-section .apple-space-responsive {
          padding: var(--space-4) var(--space-2) !important;
        }
      }

      /* RESPONSIVE TABLET (769px - 1024px) */
      @media (min-width: 769px) and (max-width: 1024px) {

        /* Main container tablet */
        .claut-main {
          padding: var(--space-3) var(--space-6) 0 var(--space-6) !important;
        }

        /* Navbar tablet */
        .porsche-navbar[navbar-main],
        nav[navbar-main][navbar-scroll="false"] {
          margin-top: 60px !important;
          margin-left: 60px !important;
          margin-right: 60px !important;
          width: calc(100% - 120px) !important;
          max-width: calc(100% - 120px) !important;
        }

        /* Contenido principal tablet */
        .content-gradient-container {
          padding: 0 var(--space-4) !important;
        }

        /* Hero section tablet */
        .claut-hero {
          margin: var(--space-6) 0 var(--space-12) 0 !important;
          min-height: 50vh !important;
        }

        /* Tarjetas tablet */
        .flex.flex-wrap.mt-12.-mx-3 {
          padding: 0 var(--space-3) !important;
        }

        .w-full.max-w-full.px-3 {
          margin-left: var(--space-3) !important;
          margin-right: var(--space-3) !important;
        }

        /* Carrusel tablet */
        #expandingCardsContainer {
          margin: var(--space-6) var(--space-3) !important;
        }

        /* Estadísticas tablet */
        .stats-scroll-section .apple-space-responsive {
          padding: var(--space-6) var(--space-4) !important;
        }
      }

      /* RESPONSIVE EXTRA SMALL (max-width: 480px) */
      @media (max-width: 480px) {

        /* Contenedor principal muy pequeño */
        .claut-main {
          padding: var(--space-1) var(--space-2) 0 var(--space-2) !important;
        }

        /* Navbar muy pequeño */
        .porsche-navbar[navbar-main],
        nav[navbar-main][navbar-scroll="false"] {
          margin-top: 15px !important;
          margin-left: var(--space-2) !important;
          margin-right: var(--space-2) !important;
          width: calc(100% - 2 * var(--space-2)) !important;
          max-width: calc(100% - 2 * var(--space-2)) !important;
        }

        /* Hero responsive */
        .claut-hero {
          min-height: 30vh !important;
          padding: 0 var(--space-1) !important;
        }

        .claut-title-hero {
          font-size: 1.8rem !important;
        }

        /* Tarjetas apiladas */
        .w-full.max-w-full.px-3 {
          width: 100% !important;
          padding: 0 !important;
          margin: 0 0 var(--space-4) 0 !important;
        }

        /* Texto más legible en móvil */
        h1,
        h2,
        h3 {
          font-size: 90% !important;
          line-height: 1.2 !important;
        }

        /* Botones más grandes para touch */
        button,
        .claut-nav-item,
        .claut-header-btn {
          min-height: 44px !important;
          padding: var(--space-2) var(--space-3) !important;
        }
      }

      /* RESPONSIVE LARGE SCREENS (min-width: 1441px) */
      @media (min-width: 1441px) {

        /* Contenedor centrado para pantallas muy grandes */
        .claut-main {
          max-width: 1400px !important;
          margin: 0 auto !important;
          margin-top: var(--header-height) !important;
        }

        /* Navbar centrado */
        .porsche-navbar[navbar-main],
        nav[navbar-main][navbar-scroll="false"] {
          margin-left: 140px !important;
          margin-right: 140px !important;
          width: calc(100% - 280px) !important;
          max-width: calc(100% - 280px) !important;
        }
      }
    }

    /* Unified Gradient Background for Content Sections */
    .content-gradient-container {
      position: relative;
    }

    .unified-gradient-background {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg,
          var(--claut-bg-main) 0%,
          rgba(26, 26, 46, 0.3) 15%,
          rgba(199, 37, 43, 0.05) 30%,
          rgba(26, 26, 26, 0.8) 45%,
          rgba(199, 37, 43, 0.08) 60%,
          rgba(36, 36, 36, 0.7) 75%,
          var(--claut-bg-main) 100%);
      background-size: 300% 300%;
      z-index: -1;
      opacity: 0.9;
    }

    /* Ensure all content sections have relative positioning and proper z-index */
    .content-gradient-container>section,
    .content-gradient-container>div {
      position: relative;
      z-index: 1;
    }

    /* Swiper Carousel Styles with Claut Dark Theme */
    .banners-swiper {
      width: 100%;
      height: 100%;
      padding-top: 20px;
      padding-bottom: 40px;
    }

    .banners-swiper .swiper-slide {
      background-position: center;
      background-size: cover;
      width: 280px;
      height: 320px;
      border-radius: 15px;
      overflow: hidden;
      position: relative;
      transition: all 0.3s ease;
      border: 1px solid rgba(199, 37, 43, 0.2);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    }

    .banners-swiper .swiper-slide:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(199, 37, 43, 0.3);
    }

    .banners-swiper .swiper-slide-active {
      border-color: var(--claut-red);
      box-shadow: 0 15px 40px rgba(199, 37, 43, 0.4);
    }

    .banners-swiper .swiper-container-3d .swiper-slide-shadow-left,
    .banners-swiper .swiper-container-3d .swiper-slide-shadow-right {
      background-image: linear-gradient(to left, rgba(0, 0, 0, 0.5), transparent);
      border-radius: 15px;
    }

    .banners-swiper .swiper-pagination-bullet {
      background: rgba(199, 37, 43, 0.5);
      transition: all 0.3s ease;
      border-radius: 6px;
      width: 8px;
      height: 8px;
    }

    .banners-swiper .swiper-pagination-bullet-active {
      background: var(--claut-red);
      width: 24px;
      height: 8px;
      border-radius: 4px;
    }

    /* Slide Info Overlay */
    .slide-info {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 60%;
      background: linear-gradient(180deg, transparent 0%, rgba(0, 0, 0, 0.4) 30%, rgba(0, 0, 0, 0.8) 70%, rgba(0, 0, 0, 0.95) 100%);
      padding: 20px;
      padding-top: 60px;
      transform: translateY(100%);
      transition: all 0.4s ease;
      color: white;
    }

    .banners-swiper .swiper-slide-active .slide-info {
      transform: translateY(0);
    }

    .slide-info h4 {
      font-size: 1.1rem;
      font-weight: 700;
      margin-bottom: 8px;
      color: white;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
    }

    .slide-info p {
      font-size: 0.85rem;
      opacity: 0.9;
      line-height: 1.4;
      color: #e5e5e7;
    }

    /* Slide indicators */
    .slide-indicator {
      position: absolute;
      top: 15px;
      right: 15px;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 6px 12px;
      font-size: 0.75rem;
      color: white;
      border: 1px solid rgba(199, 37, 43, 0.3);
    }

    /* Expanding Cards Styles with Claut Dark Theme */
    .expanding-options {
      height: calc(100% - 80px);
      min-height: 520px;
    }

    .options-container {
      display: flex;
      flex-direction: row;
      align-items: stretch;
      overflow: hidden;
      height: 100%;
      min-width: 100%;
    }

    .expanding-card {
      position: relative;
      overflow: hidden;
      min-width: 120px;
      height: 100%;
      min-height: 600px;
      margin: 5px;
      background: var(--optionBackground, var(--claut-bg-surface));
      background-size: cover;
      background-position: center;
      cursor: pointer;
      transition: all 0.6s cubic-bezier(0.05, 0.61, 0.41, 0.95);
      border-radius: 20px;
      border: 2px solid rgba(199, 37, 43, 0.2);
      flex: 1;
      backdrop-filter: blur(0px);
      filter: brightness(0.9) saturate(0.95);
      transform: scale(1);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    .expanding-card.active {
      flex-grow: 10000;
      max-width: 500px;
      margin: 0px;
      border-radius: 25px;
      border-color: var(--claut-red);
      box-shadow: 0 20px 50px rgba(199, 37, 43, 0.3),
        0 0 30px rgba(199, 37, 43, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      background-size: cover;
      transform: scale(1.02);
      filter: brightness(1.1) saturate(1.2) contrast(1.1);
      backdrop-filter: blur(2px);
    }

    .expanding-card.active .card-shadow {
      box-shadow: inset 0 -120px 120px -120px rgba(0, 0, 0, 0.8),
        inset 0 -120px 120px -100px rgba(0, 0, 0, 0.6);
    }

    .expanding-card.active .card-label {
      bottom: 20px;
      left: 20px;
    }

    .expanding-card.active .card-info>div {
      left: 0px;
      opacity: 1;
    }

    .expanding-card:not(.active) {
      flex-grow: 1;
      border-radius: 18px;
    }

    .expanding-card:not(.active) .card-shadow {
      bottom: -40px;
      box-shadow: inset 0 -120px 0px -120px rgba(0, 0, 0, 0.4),
        inset 0 -120px 0px -100px rgba(0, 0, 0, 0.3);
    }

    .expanding-card:not(.active) .card-label {
      bottom: 10px;
      left: 10px;
    }

    .expanding-card:not(.active) .card-info>div {
      left: 20px;
      opacity: 0;
    }

    .card-shadow {
      position: absolute;
      bottom: 0px;
      left: 0px;
      right: 0px;
      height: 120px;
      transition: 0.5s cubic-bezier(0.05, 0.61, 0.41, 0.95);
    }

    .card-label {
      display: flex;
      position: absolute;
      right: 0px;
      height: 50px;
      transition: 0.5s cubic-bezier(0.05, 0.61, 0.41, 0.95);
    }

    .card-icon {
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: center;
      min-width: 50px;
      max-width: 50px;
      height: 50px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--claut-red), #C7252B);
      color: white;
      font-size: 1.2rem;
      box-shadow: 0 4px 15px rgba(199, 37, 43, 0.4);
    }

    .card-info {
      display: flex;
      flex-direction: column;
      justify-content: center;
      margin-left: 15px;
      color: white;
      white-space: pre;
    }

    .card-info>div {
      position: relative;
      transition: 0.5s cubic-bezier(0.05, 0.61, 0.41, 0.95), opacity 0.5s ease-out;
    }

    .card-main {
      font-weight: bold;
      font-size: 1.1rem;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
      color: white;
    }

    .card-sub {
      font-size: 0.85rem;
      opacity: 0.9;
      transition-delay: 0.1s;
      color: #e5e5e7;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.6);
    }

    /* Botón de vista previa */
    .card-preview-btn {
      position: absolute;
      top: 15px;
      right: 15px;
      width: 40px;
      height: 40px;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(199, 37, 43, 0.6);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      opacity: 0;
      transform: scale(0.8) translateY(-10px);
      transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
      color: white;
      font-size: 0.9rem;
      z-index: 10;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    }

    .card-preview-btn:hover {
      background: linear-gradient(135deg, var(--claut-red), #C7252B);
      border-color: var(--claut-red);
      transform: scale(1.1) translateY(-2px);
      box-shadow: 0 8px 25px rgba(199, 37, 43, 0.4);
    }

    .expanding-card:hover .card-preview-btn,
    .expanding-card.active .card-preview-btn {
      opacity: 1;
      transform: scale(1) translateY(0);
    }

    .expanding-card.active .card-preview-btn {
      opacity: 1;
      top: 20px;
      right: 20px;
    }

    /* Banner Preview Modal Styles */
    .banner-preview-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 0;
      visibility: hidden;
      transition: all 0.4s cubic-bezier(0.4, 0.0, 0.2, 1);
    }

    .banner-preview-modal.show {
      opacity: 1;
      visibility: visible;
    }

    .banner-preview-content {
      max-width: 90vw;
      max-height: 90vh;
      width: auto;
      height: auto;
      background: white;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      transform: scale(0.8) translateY(50px);
      transition: all 0.4s cubic-bezier(0.4, 0.0, 0.2, 1);
      position: relative;
      display: flex;
      flex-direction: column;
    }

    .banner-preview-modal.show .banner-preview-content {
      transform: scale(1) translateY(0);
    }

    .banner-preview-header {
      padding: 20px;
      background: linear-gradient(135deg, var(--claut-primary), var(--claut-secondary));
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .banner-preview-title {
      font-size: 1.25rem;
      font-weight: 600;
      margin: 0;
    }

    .banner-preview-close {
      background: none;
      border: none;
      color: white;
      font-size: 24px;
      cursor: pointer;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.3s ease;
    }

    .banner-preview-close:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    .banner-preview-image {
      width: 100% !important;
      height: auto !important;
      max-height: 70vh !important;
      object-fit: contain !important;
      display: block !important;
      visibility: visible !important;
      opacity: 1 !important;
      z-index: 10 !important;
      position: static !important;
      background: none !important;
      max-width: 100% !important;
      margin: 0 !important;
      padding: 0 !important;
      border: none !important;
      outline: none !important;
      box-shadow: none !important;
      transform: none !important;
      left: auto !important;
      right: auto !important;
      top: auto !important;
      bottom: auto !important;
    }

    .banner-preview-image-container {
      position: relative !important;
      overflow: visible !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      min-height: 300px !important;
      max-height: 70vh !important;
      background: #f8f9fa !important;
      width: 100% !important;
      margin: 0 !important;
      padding: 20px !important;
      flex: 1 !important;
      box-sizing: border-box !important;
    }

    .banner-preview-info {
      padding: 20px;
      background: #f8f9fa;
      border-top: 1px solid #e9ecef;
    }

    .banner-preview-description {
      margin: 0;
      color: #6c757d;
      line-height: 1.5;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      .banner-preview-content {
        max-width: 95vw;
        max-height: 95vh;
        margin: 20px;
      }

      .banner-preview-header {
        padding: 15px;
      }

      .banner-preview-title {
        font-size: 1.1rem;
      }

      .banner-preview-info {
        padding: 15px;
      }
    }

    /* Loading animation for banner preview */
    @keyframes slide {
      0% {
        background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
      }

      100% {
        background-position: 20px 20px, 20px 30px, 30px 10px, 10px 20px;
      }
    }

    /* Enhanced Hover Effects */
    .expanding-card {
      border: 2px solid rgba(199, 37, 43, 0.15);
      transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .expanding-card:hover {
      border-color: var(--claut-red);
      transform: scale(1.01) translateY(-3px);
      filter: brightness(1.05) saturate(1.1);
      box-shadow: 0 15px 40px var(--claut-red-light),
        0 5px 20px rgba(199, 37, 43, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(1px);
    }

    .expanding-card:not(.active):hover {
      box-shadow: 0 20px 50px var(--claut-red-light),
        0 5px 15px rgba(0, 0, 0, 0.1);
      border-color: var(--claut-red-hover);
      transform: scale(1.02) translateY(-5px);
    }

    .expanding-card.active {
      border-color: var(--claut-red);
      box-shadow: 0 20px 60px var(--claut-red-light),
        0 0 30px rgba(199, 37, 43, 0.25);
    }

    .expanding-card.active:hover {
      transform: scale(1.02);
      filter: brightness(1.1) saturate(1.2) contrast(1.1);
      box-shadow: 0 30px 80px var(--claut-red-light),
        0 0 50px rgba(199, 37, 43, 0.35),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }

    /* Smooth scroll-based effects */
    @media (prefers-reduced-motion: no-preference) {
      .expanding-card {
        transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
      }

      .expanding-card:nth-child(1) {
        animation-delay: 0.1s;
      }

      .expanding-card:nth-child(2) {
        animation-delay: 0.2s;
      }

      .expanding-card:nth-child(3) {
        animation-delay: 0.3s;
      }

      .expanding-card:nth-child(4) {
        animation-delay: 0.4s;
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px) scale(0.95);
        }

        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      .expanding-card {
        animation: fadeInUp 0.8s ease-out both;
      }
    }

    .stats-header-reveal.animate {
      animation: fadeInUp 1s ease-out forwards;
    }

    .stats-cards-reveal.animate {
      animation: fadeInUp 1.2s ease-out 0.3s forwards;
      opacity: 1 !important;
      transform: translateY(0) !important;
    }

    .stats-cards-reveal.animate .stat-card {
      opacity: 1 !important;
      animation: staggerFadeIn 0.8s ease-out forwards;
      transform: translateY(0) !important;
    }

    .stats-cards-reveal.animate .stat-card:nth-child(1) {
      animation-delay: 0.5s;
    }

    .stats-cards-reveal.animate .stat-card:nth-child(2) {
      animation-delay: 0.7s;
    }

    .stats-cards-reveal.animate .stat-card:nth-child(3) {
      animation-delay: 0.9s;
    }

    .stats-cards-reveal.animate .stat-card:nth-child(4) {
      animation-delay: 1.1s;
    }

    .stats-cards-reveal.animate .stat-card:nth-child(5) {
      animation-delay: 1.3s;
    }

    .stats-cards-reveal.animate .stat-card:nth-child(6) {
      animation-delay: 1.5s;
    }

    /* Responsive design optimizado */
    @media (min-width: 1025px) {
      .glowing-stats-container {
        padding-left: 2rem;
        padding-right: 2rem;
      }
    }

    @media (max-width: 1400px) {
      .glowing-stats-container {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 0.625rem;
        padding: 1.25rem;
        width: calc(100% - 350px);
        max-width: calc(72rem - 350px);
        margin: 0 80px 0 auto;
        padding-left: 1rem;
        padding-right: 1rem;
      }
    }

    @media (max-width: 1200px) {
      .glowing-stats-container {
        grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
        gap: 0.625rem;
        padding: 1rem;
        width: calc(100% - 300px);
        max-width: calc(64rem - 300px);
        margin: 0 60px 0 auto;
        padding-left: 0.875rem;
        padding-right: 0.875rem;
      }

      .glowing-stats-container .stat-card {
        min-height: 90px;
        padding: 0.875rem;
      }
    }

    @media (max-width: 900px) {
      .glowing-stats-container {
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
        gap: 0.5rem;
        padding: 0.875rem;
        width: calc(100% - 250px);
        max-width: calc(56rem - 250px);
        margin: 0 40px 0 auto;
        padding-left: 0.75rem;
        padding-right: 0.75rem;
      }

      .glowing-stats-container .stat-card {
        min-height: 80px;
        padding: 0.75rem;
      }

      .glowing-stats-container .stat-card h5 {
        font-size: 1.375rem !important;
      }

      .glowing-stats-container .stat-card p {
        font-size: 0.7rem !important;
      }
    }

    @media (max-width: 768px) {
      .glowing-stats-container {
        grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
        gap: 0.5rem;
        padding: 0.75rem;
        width: calc(100% - 200px);
        max-width: calc(48rem - 200px);
        margin: 0.5rem 30px 0.5rem auto;
        padding-left: 0.625rem;
        padding-right: 0.625rem;
      }

      .glowing-stats-container .stat-card {
        min-height: 75px;
        padding: 0.625rem;
      }

      .glowing-stats-container .stat-card h5 {
        font-size: 1.25rem !important;
      }

      .glowing-stats-container .stat-card p {
        font-size: 0.65rem !important;
      }
    }

    @media (max-width: 480px) {
      #estadisticas {
        padding: 1.5rem 0 !important;
        margin: 0 !important;
        width: 100% !important;
        overflow: hidden !important;
        box-sizing: border-box !important;
      }

      #estadisticas>div {
        padding: 0 0.25rem !important;
        max-width: 100% !important;
        overflow: hidden !important;
        box-sizing: border-box !important;
      }

      .glowing-stats-container {
        grid-template-columns: repeat(auto-fill, minmax(75px, 1fr));
        gap: 0.375rem;
        padding: 0.5rem;
        width: calc(100% - 120px);
        max-width: calc(40rem - 120px);
        margin: 0.5rem 20px 0.5rem auto;
        padding-left: 0.5rem;
        padding-right: 0.5rem;
      }

      .glowing-stats-container .stat-card {
        min-height: 65px;
        padding: 0.375rem;
      }

      .glowing-stats-container .stat-card h5 {
        font-size: 0.875rem !important;
      }

      .glowing-stats-container .stat-card p {
        font-size: 0.5rem !important;
      }

      .glowing-stats-container .stat-card i {
        font-size: 0.625rem !important;
        margin-bottom: 0.5rem !important;
      }

      .glowing-stat-card {
        min-width: 280px;
        max-width: 350px;
        aspect-ratio: 1.3/1;
        margin: 1rem auto;
      }

      .stat-content {
        font-size: clamp(0.8rem, 1.2vmin, 1.2rem);
        padding: 1.2rem 1.5rem;
      }

      .stat-number-badge {
        font-size: 1em;
        padding: 0.3em 0.5em;
        min-width: 2em;
        margin-right: 8px;
      }

      /* Efectos de scroll en móviles */
      .stats-header-reveal h2 {
        font-size: 2.2rem !important;
        background-size: 200% 200% !important;
      }

      .stats-gradient-overlay {
        background-size: 200% 200% !important;
        animation-duration: 6s !important;
      }

      /* Reducir delays en móviles para mejor performance */
      .stats-cards-reveal.animate .stat-card:nth-child(1) {
        animation-delay: 0.2s;
      }

      .stats-cards-reveal.animate .stat-card:nth-child(2) {
        animation-delay: 0.35s;
      }

      .stats-cards-reveal.animate .stat-card:nth-child(3) {
        animation-delay: 0.5s;
      }

      .stats-cards-reveal.animate .stat-card:nth-child(4) {
        animation-delay: 0.65s;
      }
    }

    /* Image Expansion Modal Styles */
    .image-modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(5px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 99999;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .image-modal-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .image-modal-container {
      background: white;
      border-radius: 20px;
      max-width: 90vw;
      max-height: 90vh;
      overflow: hidden;
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
      transform: scale(0.8) translateY(30px);
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .image-modal-overlay.show .image-modal-container {
      transform: scale(1) translateY(0);
    }

    .image-modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 25px;
      border-bottom: 1px solid #e5e7eb;
      background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%);
    }

    .image-modal-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: #1f2937;
      margin: 0;
    }

    .image-modal-close {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: none;
      background: #f3f4f6;
      color: #6b7280;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .image-modal-close:hover {
      background: #e5e7eb;
      color: #374151;
      transform: rotate(90deg);
    }

    .image-modal-content {
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      max-height: calc(90vh - 120px);
      overflow: hidden;
    }

    .image-modal-img {
      width: 100%;
      height: auto;
      max-width: 100%;
      max-height: calc(90vh - 200px);
      object-fit: contain;
      display: block;
    }

    .image-modal-controls {
      padding: 20px 25px;
      display: flex;
      gap: 12px;
      justify-content: center;
      background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%);
      border-top: 1px solid #e5e7eb;
      width: 100%;
    }

    .image-modal-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 16px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      background: white;
      color: #374151;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .image-modal-btn:hover {
      background: #f9fafb;
      border-color: #9ca3af;
      transform: translateY(-1px);
    }

    .download-btn:hover {
      background: #fef2f2;
      border-color: #fca5a5;
      color: #dc2626;
    }

    .share-btn:hover {
      background: #eff6ff;
      border-color: #93c5fd;
      color: #2563eb;
    }

    /* Enhanced expanding cards with click indicator */
    .expanding-card {
      cursor: pointer;
      position: relative;
    }

    .expanding-card::after {
      content: '';
      position: absolute;
      top: 15px;
      right: 15px;
      width: 30px;
      height: 30px;
      background: rgba(0, 0, 0, 0.7);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transform: scale(0.8);
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }

    .expanding-card:hover::after {
      opacity: 1;
      transform: scale(1);
    }

    .expanding-card::before {
      content: '🔍';
      position: absolute;
      top: 20px;
      right: 20px;
      font-size: 14px;
      z-index: 2;
      opacity: 0;
      transform: scale(0.8);
      transition: all 0.3s ease;
    }

    .expanding-card:hover::before {
      opacity: 1;
      transform: scale(1);
    }

    /* Responsive modal */
    @media (max-width: 768px) {
      .image-modal-container {
        max-width: 95vw;
        max-height: 95vh;
        margin: 10px;
      }

      .image-modal-header {
        padding: 15px 20px;
      }

      .image-modal-controls {
        padding: 15px 20px;
        flex-direction: column;
      }

      .image-modal-btn {
        width: 100%;
        justify-content: center;
      }
    }

    /* COMPREHENSIVE RESPONSIVE DESIGN */

    /* Extra Large Desktop (1400px+) */
    @media (min-width: 1400px) {
      .max-w-7xl {
        max-width: 1400px;
      }

      /* Header section */
      .text-4xl.md\\:text-6xl {
        font-size: 4rem !important;
      }

      /* Expanding cards */
      #expandingCardsContainer {
        gap: 2rem !important;
        padding: 2rem !important;
      }

      .expanding-card {
        min-width: 300px !important;
        height: 600px !important;
      }

      .expanding-card.active {
        max-width: 600px !important;
      }
    }

    /* Large Desktop (1200px - 1399px) */
    @media (min-width: 1200px) and (max-width: 1399px) {
      .max-w-7xl {
        max-width: 1200px;
        padding-left: 1.5rem;
        padding-right: 1.5rem;
      }

      /* Header text adjustments */
      .text-4xl.md\\:text-6xl {
        font-size: 3.5rem !important;
        line-height: 1.1;
      }

      .text-xl.md\\:text-2xl {
        font-size: 1.5rem !important;
      }

      /* Expanding cards */
      #expandingCardsContainer {
        gap: 1.5rem !important;
        padding: 1.5rem !important;
      }

      .expanding-card {
        min-width: 250px !important;
        height: 550px !important;
      }

      .expanding-card.active {
        max-width: 500px !important;
      }
    }

    /* Standard Desktop (1024px - 1199px) */
    @media (min-width: 1024px) and (max-width: 1199px) {
      .max-w-7xl {
        max-width: 1024px;
        padding-left: 1.5rem;
        padding-right: 1.5rem;
      }

      /* Header adjustments */
      .text-4xl.md\\:text-6xl {
        font-size: 3rem !important;
        line-height: 1.2;
      }

      .text-xl.md\\:text-2xl {
        font-size: 1.35rem !important;
      }

      /* Expanding cards container */
      .bg-gradient-to-br.shadow-2xl {
        height: 650px !important;
      }

      #expandingCardsContainer {
        gap: 1rem !important;
        padding: 1rem !important;
      }

      .expanding-card {
        min-width: 200px !important;
        height: 500px !important;
      }

      .expanding-card.active {
        max-width: 450px !important;
      }
    }

    /* Tablet Landscape (768px - 1023px) */
    @media (min-width: 768px) and (max-width: 1023px) {
      .max-w-7xl {
        max-width: 100%;
        padding-left: 1rem;
        padding-right: 1rem;
      }

      /* Header section */
      .text-center.mb-8 {
        margin-bottom: 2rem !important;
      }

      .text-4xl.md\\:text-6xl {
        font-size: 2.5rem !important;
        line-height: 1.2;
        margin-bottom: 1.5rem !important;
      }

      .text-xl.md\\:text-2xl {
        font-size: 1.25rem !important;
        margin-bottom: 1rem !important;
      }

      .text-base {
        font-size: 0.95rem !important;
      }

      /* Container adjustments */
      .bg-gradient-to-br.shadow-2xl {
        height: 500px !important;
        margin-bottom: 1.5rem !important;
      }

      /* Expanding cards */
      #expandingCardsContainer {
        gap: 0.75rem !important;
        padding: 0.75rem !important;
        flex-direction: row !important;
        overflow-x: auto !important;
        scrollbar-width: thin;
      }

      .expanding-card {
        min-width: 150px !important;
        height: 400px !important;
        flex-shrink: 0 !important;
      }

      .expanding-card.active {
        max-width: 300px !important;
        flex-grow: 2 !important;
      }

      .expanding-card:not(.active) {
        flex-grow: 0.5 !important;
      }

      /* Scroll behavior for horizontal cards */
      .expanding-options {
        padding: 0.75rem !important;
      }
    }

    /* Tablet Portrait (640px - 767px) */
    @media (min-width: 640px) and (max-width: 767px) {
      .max-w-7xl {
        padding-left: 0.75rem;
        padding-right: 0.75rem;
      }

      /* Header */
      .inline-flex.items-center.px-5 {
        padding-left: 1rem !important;
        padding-right: 1rem !important;
        font-size: 0.8rem !important;
      }

      .text-4xl.md\\:text-6xl {
        font-size: 2.25rem !important;
        line-height: 1.2;
      }

      .text-xl.md\\:text-2xl {
        font-size: 1.1rem !important;
        line-height: 1.4;
      }

      .max-w-4xl.mx-auto {
        max-width: 100% !important;
        padding: 0 0.5rem;
      }

      /* Container */
      .bg-gradient-to-br.shadow-2xl {
        height: 450px !important;
        border-radius: 1.5rem !important;
      }

      /* Header with controls */
      .flex.items-center.justify-between.p-6 {
        padding: 1rem !important;
        flex-direction: column !important;
        gap: 0.75rem !important;
      }

      .flex.items-center.space-x-3 {
        order: 2;
      }

      .text-sm.text-gray-500 {
        order: 1;
        font-size: 0.75rem !important;
        text-align: center;
      }

      /* Cards horizontal scroll */
      #expandingCardsContainer {
        gap: 0.5rem !important;
        padding: 0.5rem !important;
        display: flex !important;
        flex-direction: row !important;
        overflow-x: auto !important;
        scroll-snap-type: x mandatory;
      }

      .expanding-card {
        min-width: 120px !important;
        height: 320px !important;
        flex-shrink: 0 !important;
        scroll-snap-align: start;
      }

      .expanding-card.active {
        min-width: 200px !important;
      }
    }

    /* Mobile Large (480px - 639px) */
    @media (min-width: 480px) and (max-width: 639px) {
      .max-w-7xl {
        padding-left: 0.5rem;
        padding-right: 0.5rem;
        margin-top: 20px !important;
        margin-bottom: 20px !important;
      }

      /* Header adjustments */
      .text-center.mb-8 {
        margin-bottom: 1.5rem !important;
      }

      .inline-flex.items-center.px-5 {
        padding: 0.5rem 0.75rem !important;
        font-size: 0.75rem !important;
        margin-bottom: 1rem !important;
      }

      .text-4xl.md\\:text-6xl {
        font-size: 1.875rem !important;
        line-height: 1.2;
        margin-bottom: 1rem !important;
      }

      .text-xl.md\\:text-2xl {
        font-size: 1rem !important;
        line-height: 1.4;
        margin-bottom: 0.75rem !important;
      }

      .text-base {
        font-size: 0.875rem !important;
        line-height: 1.4;
      }

      /* Container */
      .bg-gradient-to-br.shadow-2xl {
        height: 400px !important;
        border-radius: 1rem !important;
      }

      /* Header controls */
      .flex.items-center.justify-between.p-6 {
        padding: 0.75rem !important;
        flex-direction: column !important;
        gap: 0.5rem !important;
      }

      .w-3.h-3 {
        width: 0.5rem !important;
        height: 0.5rem !important;
      }

      .text-sm.text-gray-500 {
        font-size: 0.7rem !important;
        line-height: 1.3;
        text-align: center;
        padding: 0 0.5rem;
      }

      /* Cards */
      .expanding-options {
        padding: 0.5rem !important;
      }

      #expandingCardsContainer {
        gap: 0.375rem !important;
        padding: 0.375rem !important;
        display: flex !important;
        flex-direction: row !important;
        overflow-x: auto !important;
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch;
      }

      .expanding-card {
        min-width: 100px !important;
        height: 280px !important;
        flex-shrink: 0 !important;
        scroll-snap-align: start;
        border-radius: 0.75rem !important;
      }

      .expanding-card.active {
        min-width: 160px !important;
      }

      /* Touch optimization */
      .expanding-card {
        touch-action: manipulation !important;
      }
    }

    /* Mobile Small (320px - 479px) */
    @media (max-width: 479px) {
      .max-w-7xl {
        padding-left: 0.25rem;
        padding-right: 0.25rem;
        margin-top: 15px !important;
        margin-bottom: 15px !important;
      }

      /* Header */
      .text-center.mb-8 {
        margin-bottom: 1rem !important;
        padding: 0 0.25rem;
      }

      .inline-flex.items-center.px-5 {
        padding: 0.4rem 0.6rem !important;
        font-size: 0.7rem !important;
        margin-bottom: 0.75rem !important;
      }

      .fas.fa-bullhorn.mr-2 {
        margin-right: 0.25rem !important;
        font-size: 0.7rem !important;
      }

      .text-4xl.md\\:text-6xl {
        font-size: 1.5rem !important;
        line-height: 1.2;
        margin-bottom: 0.75rem !important;
      }

      .text-xl.md\\:text-2xl {
        font-size: 0.9rem !important;
        line-height: 1.4;
        margin-bottom: 0.5rem !important;
      }

      .text-base {
        font-size: 0.8rem !important;
        line-height: 1.3;
      }

      /* Container */
      .bg-gradient-to-br.shadow-2xl {
        height: 350px !important;
        border-radius: 0.75rem !important;
        margin-left: 0.25rem;
        margin-right: 0.25rem;
      }

      /* Header controls - simplified for mobile */
      .flex.items-center.justify-between.p-6 {
        padding: 0.5rem !important;
        flex-direction: column !important;
        gap: 0.375rem !important;
      }

      .flex.items-center.space-x-3 {
        display: none !important; /* Hide decorative dots on small mobile */
      }

      .text-sm.text-gray-500 {
        font-size: 0.65rem !important;
        line-height: 1.2;
        text-align: center;
        padding: 0 0.25rem;
      }

      /* Cards optimized for small screens */
      .expanding-options {
        padding: 0.25rem !important;
      }

      #expandingCardsContainer {
        gap: 0.25rem !important;
        padding: 0.25rem !important;
        display: flex !important;
        flex-direction: row !important;
        overflow-x: auto !important;
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch;
      }

      .expanding-card {
        min-width: 85px !important;
        height: 240px !important;
        flex-shrink: 0 !important;
        scroll-snap-align: center;
        border-radius: 0.5rem !important;
        border-width: 1px !important;
      }

      .expanding-card.active {
        min-width: 140px !important;
      }

      /* Loading state adjustments */
      #cardsLoading .w-16.h-16 {
        width: 2.5rem !important;
        height: 2.5rem !important;
      }

      #cardsLoading .text-lg {
        font-size: 0.9rem !important;
      }

      #cardsLoading .text-sm {
        font-size: 0.75rem !important;
      }
    }

    /* High DPI displays */
    @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
      .expanding-card {
        image-rendering: -webkit-optimize-contrast;
        image-rendering: crisp-edges;
      }
    }

    /* Landscape orientation adjustments */
    @media (max-width: 767px) and (orientation: landscape) {
      .bg-gradient-to-br.shadow-2xl {
        height: 300px !important;
      }

      .text-4xl.md\\:text-6xl {
        font-size: 1.5rem !important;
        margin-bottom: 0.5rem !important;
      }

      .text-center.mb-8 {
        margin-bottom: 1rem !important;
      }

      .expanding-card {
        height: 200px !important;
      }
    }

    /* Print styles */
    @media print {
      .image-modal-overlay,
      .expanding-card::before,
      .expanding-card::after {
        display: none !important;
      }

      .expanding-card {
        break-inside: avoid;
        page-break-inside: avoid;
      }
    }

    /* Reduced motion preferences */
    @media (prefers-reduced-motion: reduce) {
      .expanding-card,
      .image-modal-container,
      .image-modal-overlay {
        transition: none !important;
        animation: none !important;
      }

      .expanding-card:hover {
        transform: none !important;
      }
    }
  </style>

  <!-- Modal de Buzón de Mensajes - Diseño Half Screen Mejorado -->
  <div id="messageModal" class="fixed inset-0 z-50 hidden" style="z-index: 99999;">
    <!-- Backdrop con desvanecido suave -->
    <div class="fixed inset-0 bg-black/50 backdrop-blur-md transition-all duration-300"></div>

    <!-- Modal Container - Half Screen from Bottom -->
    <div class="fixed bottom-0 left-0 right-0 w-full transform transition-all duration-500 translate-y-full"
      id="messageContainer" style="z-index: 100000; height: 50vh; min-height: 500px; max-height: none;">
      <!-- Main Container with Claut Theme -->
      <div class="relative h-full overflow-hidden"
        style="background: var(--claut-bg-surface); border-radius: 20px 20px 0 0; border-top: 4px solid var(--claut-red); box-shadow: 0 -25px 60px rgba(0, 0, 0, 0.4);">

        <!-- Top Handle for Visual Feedback -->
        <div class="absolute top-0 left-0 right-0 flex justify-center py-3 z-20">
          <div class="w-12 h-1.5 bg-gray-400/50 rounded-full"></div>
        </div>

        <!-- Gradient Overlay -->
        <div class="absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-black/5 pointer-events-none">
        </div>

        <!-- Content Container -->
        <div class="relative h-full flex flex-col pt-8">
          <!-- Header -->
          <div class="px-8 pb-6 border-b border-gray-200/20">
            <div class="flex items-center justify-between">
              <div class="flex items-center space-x-5">
                <!-- Icono del buzón -->
                <div class="w-16 h-16 rounded-xl flex items-center justify-center"
                  style="background: linear-gradient(135deg, var(--claut-red), #E8353B); box-shadow: 0 6px 20px rgba(199, 37, 43, 0.4);">
                  <i class="fas fa-envelope text-white text-2xl"></i>
                </div>
                <div>
                  <h3 class="text-2xl font-bold" style="color: var(--claut-text-primary);">Centro de Mensajes</h3>
                  <p class="text-base" style="color: var(--claut-text-secondary);">Sistema de notificaciones</p>
                </div>
              </div>

              <!-- Botón cerrar -->
              <button id="closeMessageModal"
                class="w-12 h-12 rounded-full flex items-center justify-center transition-all duration-200 hover:bg-gray-200/20 active:scale-95"
                style="background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px);">
                <i class="fas fa-times text-xl" style="color: var(--claut-text-primary);"></i>
              </button>
            </div>

            <!-- Botones de acción -->
            <div class="flex items-center justify-between mt-6">
              <button id="markAllRead"
                class="px-6 py-3 rounded-lg text-base font-medium transition-all duration-200 hover:bg-gray-200/20"
                style="background: rgba(199, 37, 43, 0.1); color: var(--claut-red); border: 1px solid rgba(199, 37, 43, 0.2);">
                <i class="fas fa-check-double mr-2"></i>
                Marcar como leído
              </button>
            </div>
          </div>

          <!-- Pestañas -->
          <div class="px-8 py-6">
            <div class="flex rounded-xl p-1.5" style="background: var(--claut-bg-secondary);">
              <button
                class="message-tab active flex-1 py-3 px-4 text-base font-medium rounded-lg transition-all duration-200"
                data-tab="all" style="background: var(--claut-red); color: white;">
                <i class="fas fa-inbox mr-2"></i>Todos
              </button>
              <button
                class="message-tab flex-1 py-3 px-4 text-base font-medium rounded-lg transition-all duration-200 hover:bg-gray-200/20"
                data-tab="unread" style="color: var(--claut-text-primary);">
                <i class="fas fa-envelope mr-2"></i>Sin leer
              </button>
              <button
                class="message-tab flex-1 py-3 px-4 text-base font-medium rounded-lg transition-all duration-200 hover:bg-gray-200/20"
                data-tab="important" style="color: var(--claut-text-primary);">
                <i class="fas fa-star mr-2"></i>Importantes
              </button>
            </div>
          </div>

          <!-- Contenedor de Mensajes -->
          <div class="flex-1 overflow-y-auto px-8 pb-8" id="messagesContainer" style="min-height: 250px;">
            <!-- Estado de carga -->
            <div class="text-center py-12" id="messagesLoading">
              <div class="w-12 h-12 mx-auto mb-6">
                <div class="w-12 h-12 rounded-full border-3 border-gray-300 border-t-3 animate-spin"
                  style="border-top-color: var(--claut-red);"></div>
              </div>
              <p class="font-medium text-lg" style="color: var(--claut-text-primary);">Cargando mensajes...</p>
              <p class="text-base mt-2" style="color: var(--claut-text-secondary);">Sincronizando datos</p>
            </div>

            <!-- Sin mensajes -->
            <div class="text-center py-12 hidden" id="noMessages">
              <div class="w-20 h-20 mx-auto mb-6 rounded-full flex items-center justify-center"
                style="background: linear-gradient(135deg, #10b981, #059669);">
                <i class="fas fa-check text-white text-2xl"></i>
              </div>
              <p class="font-bold text-xl" style="color: var(--claut-text-primary);">Todo al día</p>
              <p class="text-base mt-2" style="color: var(--claut-text-secondary);">No hay mensajes nuevos</p>
            </div>

            <!-- Lista de mensajes -->
            <div id="messagesList" class="space-y-4 hidden">
              <!-- Los mensajes se cargarán dinámicamente aquí -->
            </div>
          </div>

          <!-- Footer -->
          <div class="px-8 py-6 border-t border-gray-200/20">
            <button id="refreshMessages"
              class="w-full py-4 px-6 rounded-xl text-base font-medium transition-all duration-200 flex items-center justify-center space-x-3 hover:opacity-80"
              style="background: linear-gradient(135deg, var(--claut-red), #E8353B); color: white; box-shadow: 0 4px 12px rgba(199, 37, 43, 0.3);">
              <i class="fas fa-sync-alt text-lg"></i>
              <span>Actualizar mensajes</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- NUEVA SECCIÓN DE ESTADÍSTICAS GLOWING - FULL WIDTH CON EFECTOS SCROLL -->
  <section id="estadisticas" class="stats-scroll-section"
    style="margin: 0; padding: 60px 0; background: rgba(10, 10, 10, 0.4); position: relative; overflow: hidden;">

    <div class="w-full apple-space-responsive max-w-7xl mx-auto px-6 lg:px-8"
      style="position: relative; z-index: 1; transform: none !important; transition: none !important;">
      <!-- Título con efecto scroll reveal -->
      <div class="stats-header-reveal animate"
        style="text-align: center; margin-bottom: 60px; opacity: 1; transform: translateY(0px); position: relative; z-index: 5;">
        <h2
          style="color: var(--claut-text-primary); font-size: 2.8rem; font-weight: 800; margin-bottom: 20px; text-shadow: 0 0 30px rgba(255,255,255,0.2); background: linear-gradient(135deg, #fff, #C7252B, #6366f1); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
          Estadísticas en Tiempo Real
        </h2>
        <p
          style="color: var(--claut-text-secondary); max-width: 700px; margin: 0 auto; font-size: 1.2rem; line-height: 1.6; opacity: 0.9;">
          Monitorea el rendimiento y el crecimiento de tu organización con métricas actualizadas al instante.
        </p>
      </div>

      <!-- Contenedor principal de estadísticas con scroll reveal -->
      <div id="estadisticasContainer" class="glowing-stats-container stats-cards-reveal animate"
        style="opacity: 1 !important; transform: translateY(0px) !important; position: relative; z-index: 10;">
        <!-- Las tarjetas se generarán dinámicamente con JavaScript -->
      </div>
    </div>
  </section>
  <footer class="pt-4" style="background: rgba(10, 10, 10, 0.4); backdrop-filter: blur(1px);">
    <div class="w-full px-6 mx-auto">
      <div class="flex flex-wrap items-center -mx-3 lg:justify-between">
        <div class="w-full max-w-full px-3 mt-0 mb-6 shrink-0 lg:mb-0 lg:w-1/2 lg:flex-none">
          <div class="text-sm leading-normal text-center text-slate-500 lg:text-left">
            © 2025, Todos Los Derechos Reservados <i class=""></i>
            <a href="" class="font-semibold text-slate-700 dark:text-white" target="_blank">Clúster</a>
          </div>
        </div>
      </div>
    </div>
  </footer>
  <!-- Modal para Preview de Imágenes -->
  <div id="imagePreviewModal" class="image-preview-modal">
    <button class="image-preview-close" onclick="closeImagePreview()">
      <i class="fas fa-times"></i>
    </button>
    <img id="previewImage" src="" alt="Preview">
  </div>

  <!-- Modal de Detalle de Mensaje -->
  <div id="messageDetailModal" class="fixed inset-0 z-50 hidden" style="z-index: 999999;">
    <!-- Backdrop -->
    <div class="fixed inset-0 bg-black/50 backdrop-blur-md transition-all duration-300" id="messageDetailBackdrop">
    </div>

    <!-- Modal Container -->
    <div class="fixed inset-4 md:inset-8 lg:inset-16 xl:inset-24 flex items-center justify-center">
      <div class="rounded-2xl shadow-2xl max-w-4xl w-full max-h-full overflow-hidden transition-all duration-300"
        id="messageDetailContainer"
        style="background: var(--claut-bg-surface); border: 1px solid var(--claut-border-light);">

        <!-- Header -->
        <div class="px-8 py-6 flex items-center justify-between border-b border-gray-200/20"
          style="background: linear-gradient(135deg, var(--claut-red), #E8353B);">
          <div class="flex items-center space-x-4">
            <div class="w-12 h-12 rounded-xl flex items-center justify-center"
              style="background: rgba(255, 255, 255, 0.2); backdrop-filter: blur(10px);">
              <i id="messageDetailIcon" class="fas fa-envelope text-white text-lg"></i>
            </div>
            <div>
              <h3 class="text-xl font-bold text-white" id="messageDetailTitle">Detalle del Mensaje</h3>
              <p class="text-white/80 text-sm" id="messageDetailMeta">Información del mensaje</p>
            </div>
          </div>
          <button onclick="closeMessageDetail()"
            class="w-10 h-10 rounded-full flex items-center justify-center transition-all duration-200 hover:bg-white/20 active:scale-95"
            style="background: rgba(255, 255, 255, 0.1);">
            <i class="fas fa-times text-lg text-white"></i>
          </button>
        </div>

        <!-- Content -->
        <div class="flex-1 overflow-auto p-8" style="max-height: calc(100vh - 200px);">
          <div class="space-y-6">

            <!-- Message Info -->
            <div class="rounded-xl p-6"
              style="background: var(--claut-bg-secondary); border: 1px solid var(--claut-border-light);">
              <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                  <label class="text-sm font-medium mb-2 block"
                    style="color: var(--claut-text-secondary);">Fecha</label>
                  <p class="font-medium" style="color: var(--claut-text-primary);" id="messageDetailDate">-</p>
                </div>
                <div>
                  <label class="text-sm font-medium mb-2 block" style="color: var(--claut-text-secondary);">Tipo</label>
                  <p class="font-medium" style="color: var(--claut-text-primary);" id="messageDetailType">-</p>
                </div>
                <div>
                  <label class="text-sm font-medium mb-2 block"
                    style="color: var(--claut-text-secondary);">Estado</label>
                  <p id="messageDetailStatus">-</p>
                </div>
              </div>
            </div>

            <!-- Message Content -->
            <div>
              <label class="text-base font-medium mb-4 block" style="color: var(--claut-text-primary);">Contenido del
                Mensaje</label>
              <div class="rounded-xl p-6"
                style="background: var(--claut-bg-secondary); border: 1px solid var(--claut-border-light);"
                id="messageDetailContent">
                <!-- El contenido se cargará dinámicamente -->
              </div>
            </div>

            <!-- Committee Info (if applicable) -->
            <div id="messageDetailComiteSection" class="hidden">
              <label class="text-base font-medium mb-4 block" style="color: var(--claut-text-primary);">Información del
                Comité</label>
              <div class="rounded-xl p-6"
                style="background: linear-gradient(135deg, rgba(37, 99, 235, 0.1), rgba(59, 130, 246, 0.1)); border: 1px solid rgba(37, 99, 235, 0.2);">
                <div class="flex items-center space-x-4">
                  <div class="w-12 h-12 rounded-xl flex items-center justify-center"
                    style="background: linear-gradient(135deg, #2563eb, #3b82f6);">
                    <i class="fas fa-users text-white text-lg"></i>
                  </div>
                  <div>
                    <p class="font-semibold text-lg" style="color: var(--claut-text-primary);"
                      id="messageDetailComiteName">-</p>
                    <p class="text-sm" style="color: var(--claut-text-secondary);">Mensaje del comité</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Attachments (if applicable) -->
            <div id="messageDetailAttachments" class="hidden">
              <label class="text-base font-medium mb-4 block" style="color: var(--claut-text-primary);">Archivos
                Adjuntos</label>
              <div class="space-y-3" id="messageDetailAttachmentsList">
                <!-- Los adjuntos se cargarán dinámicamente -->
              </div>
            </div>

          </div>
        </div>

        <!-- Footer Actions -->
        <div class="px-8 py-6 border-t border-gray-200/20" style="background: var(--claut-bg-secondary);">
          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-3">
              <button onclick="markMessageAsRead()"
                class="px-6 py-3 rounded-lg font-medium transition-all duration-200 hover:opacity-80 flex items-center space-x-2"
                style="background: linear-gradient(135deg, #10b981, #059669); color: white;" id="markReadBtn">
                <i class="fas fa-check"></i>
                <span>Marcar como leído</span>
              </button>
              <button onclick="toggleMessageImportant()"
                class="px-6 py-3 rounded-lg font-medium transition-all duration-200 hover:opacity-80 flex items-center space-x-2"
                style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white;" id="toggleImportantBtn">
                <i class="fas fa-star"></i>
                <span>Marcar importante</span>
              </button>
            </div>
            <button onclick="closeMessageDetail()"
              class="px-6 py-3 rounded-lg font-medium transition-all duration-200 hover:bg-gray-200/20 flex items-center space-x-2"
              style="background: rgba(255, 255, 255, 0.1); color: var(--claut-text-primary); border: 1px solid var(--claut-border-light);">
              <i class="fas fa-times"></i>
              <span>Cerrar</span>
            </button>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- Script del Sistema de Mensajes -->
  <script>
    class MessageCenter {
      constructor() {
        console.log('🏗️ Creando nueva instancia de MessageCenter');
        this.isOpen = false;
        this.currentTab = 'all';
        this.messages = [];
        this.unreadCount = 0;

        // Forzar estado inicial limpio del modal
        this.forceCleanState();
        this.init();
      }

      forceCleanState() {
        console.log('🧹 Forzando estado inicial limpio del modal');

        const modal = document.getElementById('messageModal');
        const container = document.getElementById('messageContainer');

        if (modal) {
          // Forzar modal cerrado
          modal.classList.add('hidden');
          modal.style.display = 'none';
          modal.style.visibility = 'hidden';
          modal.style.zIndex = '';
          console.log('✅ Modal forzado a estado cerrado');
        }

        if (container) {
          // Resetear container
          container.style.transform = 'translateY(100%)';
          container.style.opacity = '0';
          console.log('✅ Container reseteado');
        }

        // Asegurar estado interno
        this.isOpen = false;
        console.log('✅ Estado interno limpio: isOpen =', this.isOpen);
      }

      init() {
        this.bindEvents();
        this.loadMessages();

        // Polling cada 30 segundos para nuevos mensajes
        setInterval(() => {
          if (!this.isOpen) {
            this.loadMessages(true); // Silent refresh
          }
        }, 30000);
      }

      bindEvents() {
        // Event listener duplicado removido para evitar conflictos
        console.log('ℹ️ Event listeners configurados solo en el botón principal');

        const closeButton = document.getElementById('closeMessageModal');
        if (closeButton) {
          closeButton.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            console.log('🔴 Botón cerrar clickeado');
            this.closeModal();
          });
          console.log('✅ Event listener agregado al botón cerrar');
        } else {
          console.error('❌ Botón cerrar modal no encontrado');
        }

        // Cerrar con click fuera
        const modal = document.getElementById('messageModal');
        if (modal) {
          modal.addEventListener('click', (e) => {
            // Solo cerrar si el click es exactamente en el backdrop, no en el botón
            if (e.target.id === 'messageModal' && this.isOpen) {
              console.log('🔴 Click en backdrop - cerrando modal');
              this.closeModal();
            }
          });
        } else {
          console.error('❌ Modal para event listener no encontrado');
        }

        // Tabs
        document.querySelectorAll('.message-tab').forEach(tab => {
          tab.addEventListener('click', () => {
            this.switchTab(tab.dataset.tab);
          });
        });

        // Botones de acción
        const markAllReadBtn = document.getElementById('markAllRead');
        if (markAllReadBtn) {
          markAllReadBtn.addEventListener('click', () => {
            this.markAllAsRead();
          });
        }

        const refreshBtn = document.getElementById('refreshMessages');
        if (refreshBtn) {
          refreshBtn.addEventListener('click', () => {
            this.loadMessages();
          });
        }
      }

      toggleModal() {
        console.log('🔄 toggleModal() - Estado actual:', this.isOpen);

        // Verificar estado visual real del modal
        const modal = document.getElementById('messageModal');
        const isVisuallyHidden = modal ? modal.classList.contains('hidden') : true;

        console.log('👁️ Estado visual (hidden):', isVisuallyHidden);
        console.log('📊 Debug completo:', {
          internalState: this.isOpen,
          hasHiddenClass: isVisuallyHidden,
          displayStyle: modal ? getComputedStyle(modal).display : 'N/A',
          visibilityStyle: modal ? getComputedStyle(modal).visibility : 'N/A'
        });

        // Sincronización más agresiva del estado
        const shouldBeOpen = !isVisuallyHidden && getComputedStyle(modal).display !== 'none';

        if (shouldBeOpen !== this.isOpen) {
          console.log('🔄 Estado desincronizado detectado. Corrigiendo:', {
            shouldBeOpen: shouldBeOpen,
            currentState: this.isOpen
          });
          this.isOpen = shouldBeOpen;
        }

        if (this.isOpen) {
          console.log('⬇️ Modal está abierto, cerrando...');
          this.closeModal();
        } else {
          console.log('⬆️ Modal está cerrado, abriendo...');
          this.openModal();
        }
      }

      forceOpen() {
        console.log('🔧 FORCE OPEN: Forzando apertura del modal');

        // Primero forzar cierre completo
        this.forceClose();

        // Esperar un momento y luego abrir
        setTimeout(() => {
          console.log('🚀 Ejecutando apertura después de forzar cierre');
          this.openModal();
        }, 100);
      }

      forceClose() {
        console.log('🔒 FORCE CLOSE: Forzando cierre del modal');

        const modal = document.getElementById('messageModal');
        const container = document.getElementById('messageContainer');

        if (modal) {
          // Limpiar todo completamente
          modal.classList.add('hidden');
          modal.style.display = '';
          modal.style.visibility = '';
          modal.style.zIndex = '';
          modal.style.position = '';
          modal.style.top = '';
          modal.style.left = '';
          modal.style.width = '';
          modal.style.height = '';
          modal.style.backgroundColor = '';
        }

        if (container) {
          container.style.position = '';
          container.style.right = '';
          container.style.top = '';
          container.style.width = '';
          container.style.height = '';
          container.style.backgroundColor = '';
          container.style.transform = 'translateY(100%)';
          container.style.opacity = '0';
        }

        this.isOpen = false;
        console.log('✅ Modal forzado a cerrar completamente y estilos limpiados');
      }

      openModal() {
        console.log('📧 Abriendo modal de mensajes...');

        // Prevenir apertura si ya está abierto
        if (this.isOpen) {
          console.log('⚠️ Modal ya está abierto');
          return;
        }

        this.isOpen = true;
        const modal = document.getElementById('messageModal');
        const container = document.getElementById('messageContainer');

        if (!modal) {
          console.error('❌ Modal #messageModal no encontrado');
          return;
        }

        if (!container) {
          console.error('❌ Container #messageContainer no encontrado');
          return;
        }

        console.log('✅ Elementos encontrados, mostrando modal');

        // Debug: Estado inicial del modal
        console.log('🔍 Estado inicial modal:', {
          display: getComputedStyle(modal).display,
          visibility: getComputedStyle(modal).visibility,
          zIndex: getComputedStyle(modal).zIndex,
          position: getComputedStyle(modal).position
        });

        // Mostrar modal conservando el diseño iOS 26
        modal.classList.remove('hidden');

        // Aplicar estilos inmediatamente
        container.style.transform = 'translateY(0)';
        container.style.opacity = '1';

        // Forzar visibilidad si está oculto
        if (getComputedStyle(modal).display === 'none') {
          console.log('🔧 Forzando display: block');
          modal.style.display = 'block';
        }

        if (getComputedStyle(modal).visibility === 'hidden') {
          console.log('🔧 Forzando visibility: visible');
          modal.style.visibility = 'visible';
        }

        // Asegurar z-index alto
        modal.style.zIndex = '9999';
        console.log('🔧 Z-index establecido a 9999');

        // FORZAR DIMENSIONES DEL MODAL (problema principal)
        modal.style.position = 'fixed';
        modal.style.top = '0';
        modal.style.left = '0';
        modal.style.width = '100vw';
        modal.style.height = '100vh';
        modal.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';

        console.log('🔧 Dimensiones forzadas: 100vw x 100vh');

        // FORZAR DIMENSIONES DEL CONTAINER
        if (container) {
          container.style.position = 'absolute';
          container.style.right = '0';
          container.style.top = '0';
          container.style.width = '400px';
          container.style.height = '100vh';
          container.style.backgroundColor = 'white';
          console.log('🔧 Container dimensiones: 400px x 100vh');
        }

        // Debug: Estado después de mostrar
        setTimeout(() => {
          const newRect = modal.getBoundingClientRect();
          console.log('🔍 Estado después de mostrar:', {
            modalDisplay: getComputedStyle(modal).display,
            modalVisibility: getComputedStyle(modal).visibility,
            modalZIndex: getComputedStyle(modal).zIndex,
            containerTransform: getComputedStyle(container).transform,
            containerOpacity: getComputedStyle(container).opacity,
            modalRect: newRect,
            hasSize: newRect.width > 0 && newRect.height > 0
          });

          if (newRect.width > 0 && newRect.height > 0) {
            console.log('🎉 ¡MODAL TIENE DIMENSIONES! Debería ser visible ahora');
          } else {
            console.log('❌ Modal sigue sin dimensiones, problema de CSS');
          }
        }, 100);

        console.log('✅ Modal iOS 26 mostrado correctamente');

        // Cargar mensajes al abrir
        this.loadMessages();
      }

      closeModal() {
        console.log('🔴 Ejecutando closeModal()');
        this.isOpen = false;
        const modal = document.getElementById('messageModal');
        const container = document.getElementById('messageContainer');

        if (!modal || !container) {
          console.error('❌ Modal o container no encontrado');
          return;
        }

        // Animar salida con los estilos actuales
        container.style.transform = 'translateY(100%)';
        container.style.opacity = '0';

        setTimeout(() => {
          // LIMPIAR COMPLETAMENTE TODOS LOS ESTILOS FORZADOS
          console.log('🧹 Limpiando estilos forzados del modal');

          // Remover clases y estilos del modal
          modal.classList.add('hidden');
          modal.style.display = '';
          modal.style.visibility = '';
          modal.style.zIndex = '';
          modal.style.position = '';
          modal.style.top = '';
          modal.style.left = '';
          modal.style.width = '';
          modal.style.height = '';
          modal.style.backgroundColor = '';

          // Limpiar container
          container.style.position = '';
          container.style.right = '';
          container.style.top = '';
          container.style.width = '';
          container.style.height = '';
          container.style.backgroundColor = '';
          container.style.transform = 'translateY(100%)';
          container.style.opacity = '0';

          console.log('✅ Modal cerrado y estilos limpiados');
        }, 500);
      }

      switchTab(tab) {
        this.currentTab = tab;

        // Actualizar tabs - remover estilos activos
        document.querySelectorAll('.message-tab').forEach(t => {
          t.classList.remove('active', 'text-white');
          t.classList.add('text-gray-700');
          t.style.backgroundColor = '';
          t.style.borderBottomColor = '';
        });

        // Aplicar estilos al tab activo
        const activeTab = document.querySelector(`[data-tab="${tab}"]`);
        activeTab.classList.add('active', 'text-white');
        activeTab.classList.remove('text-gray-700');
        activeTab.style.backgroundColor = '#C7252B';
        activeTab.style.borderBottomColor = '#C7252B';
        activeTab.classList.remove('text-gray-300');

        this.renderMessages();
      }

      async loadMessages(silent = false) {
        if (!silent) {
          this.showLoading();
        }

        try {
          // Cargar mensajes regulares
          const response = await fetch('./api/notificaciones.php?action=list');
          const data = await response.json();

          let allMessages = [];

          if (data.success) {
            allMessages = data.data || [];
          }

          // Cargar mensajes de comités
          const userData = this.getUserData();
          console.log('🔍 Debug - getUserData() result:', userData);

          if (userData && userData.email) {
            console.log('📧 Email del usuario:', userData.email);
            try {
              const url = `./api/comites.php?action=obtener_mensajes&email=${encodeURIComponent(userData.email)}`;
              console.log('🌐 URL del API:', url);

              const comitesResponse = await fetch(url);
              console.log('📡 Response status:', comitesResponse.status);

              const comitesData = await comitesResponse.json();
              console.log('📋 Datos del API:', comitesData);

              if (comitesData.success && comitesData.mensajes) {
                console.log('✅ Mensajes de comités encontrados:', comitesData.mensajes.length);
                // Transformar mensajes de comités al formato esperado
                const mensajesComites = comitesData.mensajes.map(mensaje => {
                  let contenidoParsed = mensaje.contenido;
                  try {
                    contenidoParsed = JSON.parse(mensaje.contenido);
                  } catch (e) {
                    // Si no es JSON, usar como texto plano
                  }

                  return {
                    id: `comite_${mensaje.id}`,
                    titulo: mensaje.asunto,
                    mensaje: this.formatearContenidoComite(mensaje.tipo_mensaje, contenidoParsed),
                    fecha: mensaje.fecha_envio,
                    tipo: `comite_${mensaje.tipo_mensaje}`,
                    leido: mensaje.estado === 'leido',
                    importante: false,
                    comite_nombre: mensaje.comite_nombre,
                    contenido_original: contenidoParsed,
                    tipo_original: mensaje.tipo_mensaje,
                    mensaje_id: mensaje.id
                  };
                });

                allMessages = [...allMessages, ...mensajesComites];
              }
            } catch (error) {
              console.error('❌ Error cargando mensajes de comités:', error);
            }

            // Cargar mensajes de usuarios del sistema de administración
            try {
              const urlUsuarios = `./api/usuarios_mensajes.php?action=obtener_mensajes&email=${encodeURIComponent(userData.email)}`;
              console.log('🌐 URL del API de usuarios:', urlUsuarios);
              const usuariosResponse = await fetch(urlUsuarios);
              console.log('📡 Response status usuarios:', usuariosResponse.status);
              const usuariosData = await usuariosResponse.json();
              console.log('📋 Datos del API de usuarios:', usuariosData);
              if (usuariosData.success && usuariosData.data && usuariosData.data.mensajes) {
                console.log('✅ Mensajes de usuarios encontrados:', usuariosData.data.mensajes.length);
                // Transformar mensajes de usuarios al formato esperado
                const mensajesUsuarios = usuariosData.data.mensajes.map(mensaje => {
                  let contenidoParsed = mensaje.contenido;
                  try {
                    contenidoParsed = JSON.parse(mensaje.contenido);
                  } catch (e) {
                    // Si no es JSON, usar como texto plano
                  }
                  return {
                    id: `usuario_${mensaje.id}`,
                    titulo: mensaje.asunto,
                    mensaje: this.formatearContenidoUsuario(mensaje.tipo_mensaje, contenidoParsed),
                    fecha: mensaje.fecha_envio,
                    tipo: `usuario_${mensaje.tipo_mensaje}`,
                    leido: mensaje.estado === 'leido',
                    importante: false,
                    comite_nombre: 'Sistema',
                    contenido_original: contenidoParsed,
                    tipo_original: mensaje.tipo_mensaje,
                    mensaje_id: mensaje.id
                  };
                });
                allMessages = [...allMessages, ...mensajesUsuarios];
              }
            } catch (error) {
              console.error('❌ Error cargando mensajes de usuarios:', error);
            }
          } else {
            console.warn('⚠️ No se encontró email del usuario para cargar mensajes de comités y usuarios');
            console.log('📊 Información disponible en localStorage:');
            console.log('  - userData:', localStorage.getItem('userData'));
            console.log('  - currentUser:', localStorage.getItem('currentUser'));
            console.log('  - userSession:', sessionStorage.getItem('userSession'));
          }

          // Ordenar por fecha
          allMessages.sort((a, b) => new Date(b.fecha) - new Date(a.fecha));

          this.messages = allMessages;
          this.updateUnreadCount();
          this.renderMessages();

        } catch (error) {
          console.error('Error cargando mensajes:', error);
          this.showNoMessages();
        }
      }

      formatearContenidoComite(tipo, contenido) {
        switch (tipo) {
          case 'texto':
            return contenido;

          case 'link':
            if (typeof contenido === 'object' && contenido.url) {
              return `<div class="comite-link-message">
                <p class="text-sm text-gray-600">${contenido.descripcion || ''}</p>
                <a href="${contenido.url}" target="_blank" class="inline-flex items-center mt-2 px-3 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition text-sm">
                  <i class="fas fa-external-link-alt mr-2"></i>
                  ${contenido.texto || 'Ver enlace'}
                </a>
              </div>`;
            }
            return contenido;

          case 'imagen':
            if (typeof contenido === 'object' && contenido.archivo) {
              return `<div class="comite-image-message">
                <p class="text-sm text-gray-600 mb-2">${contenido.descripcion || ''}</p>
                <img src="./${contenido.archivo}" alt="Imagen del comité" class="mailbox-image">
              </div>`;
            }
            return contenido;

          case 'documento':
            if (typeof contenido === 'object' && contenido.archivo) {
              const extension = contenido.nombre_original ? contenido.nombre_original.split('.').pop().toLowerCase() : 'file';
              const iconClass = this.getFileIcon(extension);
              return `<div class="comite-document-message">
                <p class="text-sm text-gray-600 mb-2">${contenido.descripcion || ''}</p>
                <a href="./${contenido.archivo}" target="_blank" class="inline-flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition">
                  <i class="${iconClass} text-2xl text-gray-300 mr-3"></i>
                  <div>
                    <p class="text-sm font-medium text-gray-800">${contenido.nombre_original || 'Documento'}</p>
                    <p class="text-xs text-gray-300">Haz clic para descargar</p>
                  </div>
                </a>
              </div>`;
            }
            return contenido;

          default:
            return contenido;
        }
      }

      formatearContenidoUsuario(tipo, contenido) {
        switch (tipo) {
          case 'texto':
            return contenido;
          case 'link':
            if (typeof contenido === 'object' && contenido.url) {
              return `<div class="usuario-link-message">
                <p class="text-sm text-gray-600">${contenido.descripcion || ''}</p>
                <a href="${contenido.url}" target="_blank" class="inline-flex items-center mt-2 px-3 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition text-sm">
                  <i class="fas fa-external-link-alt mr-2"></i>
                  ${contenido.texto || 'Ver enlace'}
                </a>
              </div>`;
            }
            return contenido;
          case 'imagen':
            if (typeof contenido === 'object' && contenido.archivo) {
              return `<div class="usuario-image-message">
                <p class="text-sm text-gray-600 mb-2">${contenido.descripcion || ''}</p>
                <img src="./${contenido.archivo}" alt="Imagen del sistema" class="mailbox-image">
              </div>`;
            }
            return contenido;
          case 'documento':
            if (typeof contenido === 'object' && contenido.archivo) {
              const extension = contenido.nombre ? contenido.nombre.split('.').pop().toLowerCase() : 'file';
              const iconClass = this.getFileIcon(extension);
              return `<div class="usuario-document-message">
                <p class="text-sm text-gray-600 mb-2">${contenido.descripcion || ''}</p>
                <a href="./${contenido.archivo}" target="_blank" class="inline-flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition">
                  <i class="${iconClass} text-2xl text-gray-300 mr-3"></i>
                  <div>
                    <p class="text-sm font-medium text-gray-800">${contenido.nombre || 'Documento'}</p>
                    <p class="text-xs text-gray-300">Haz clic para descargar</p>
                  </div>
                </a>
              </div>`;
            }
            return contenido;
          default:
            return contenido;
        }
      }

      getFileIcon(extension) {
        const iconMap = {
          pdf: 'fas fa-file-pdf text-red-500',
          doc: 'fas fa-file-word text-blue-500',
          docx: 'fas fa-file-word text-blue-500',
          xls: 'fas fa-file-excel text-green-500',
          xlsx: 'fas fa-file-excel text-green-500',
          ppt: 'fas fa-file-powerpoint text-orange-500',
          pptx: 'fas fa-file-powerpoint text-orange-500',
          txt: 'fas fa-file-alt text-gray-300'
        };
        return iconMap[extension] || 'fas fa-file text-gray-300';
      }

      renderMessages() {
        console.log('🎨 Renderizando mensajes...');
        const container = document.getElementById('messagesList');
        const loading = document.getElementById('messagesLoading');
        const noMessages = document.getElementById('noMessages');

        console.log('🔍 Elementos DOM:');
        console.log('- container (messagesList):', !!container);
        console.log('- loading:', !!loading);
        console.log('- noMessages:', !!noMessages);

        if (!container) {
          console.error('❌ Container messagesList no encontrado');
          return;
        }

        // Filtrar mensajes según tab activo
        let filteredMessages = this.messages;
        console.log(`📊 Total mensajes: ${this.messages.length}, Tab activo: ${this.currentTab}`);

        switch (this.currentTab) {
          case 'unread':
            filteredMessages = this.messages.filter(m => !m.leido);
            break;
          case 'important':
            filteredMessages = this.messages.filter(m => m.importante);
            break;
        }

        console.log(`📋 Mensajes filtrados: ${filteredMessages.length}`);

        // Ocultar estados
        if (loading) loading.classList.add('hidden');
        if (noMessages) noMessages.classList.add('hidden');
        container.classList.remove('hidden');

        if (filteredMessages.length === 0) {
          console.log('⚠️ No hay mensajes para mostrar');
          container.classList.add('hidden');
          if (noMessages) noMessages.classList.remove('hidden');
          return;
        }

        // Renderizar mensajes
        console.log('✅ Generando HTML para mensajes...');
        const messagesHTML = filteredMessages.map(message => this.renderMessage(message)).join('');
        container.innerHTML = messagesHTML;
        console.log(`✅ ${filteredMessages.length} mensajes renderizados en el DOM`);

        // Agregar event listeners para los botones después de renderizar
        this.attachEventListeners(container);
      }

      renderMessage(message) {
        const timeAgo = this.getTimeAgo(message.fecha_creacion || message.fecha);
        const isUnread = !message.leido;
        const isComiteMessage = message.id && message.id.toString().startsWith('comite_');

        // Determinar el contenido a mostrar
        const contenido = message.mensaje || message.contenido || '';

        return `
          <div class="message-item p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors ${isUnread ? 'bg-red-50 border-red-200' : ''}" data-message-id="${message.id}">
            <div class="flex items-start">
              <div class="flex-shrink-0 mr-3">
                <div class="w-10 h-10 rounded-full bg-gradient-to-r ${this.getTypeGradient(message.tipo)} flex items-center justify-center">
                  <i class="${this.getTypeIcon(message.tipo)} text-white text-sm"></i>
                </div>
              </div>
              <div class="flex-1 min-w-0">
                <div class="flex items-center justify-between">
                  <div class="flex-1">
                    <p class="text-sm font-medium text-gray-900 truncate">
                      ${message.titulo}
                      ${isUnread ? '<span class="ml-2 inline-block w-2 h-2 bg-red-500 rounded-full"></span>' : ''}
                    </p>
                    ${isComiteMessage ? `<p class="text-xs text-gray-300 mt-1">📧 Comité: ${message.comite_nombre || 'Sin nombre'}</p>` : ''}
                  </div>
                  <span class="text-xs text-gray-300">${timeAgo}</span>
                </div>
                <div class="text-sm text-gray-600 mt-2">${contenido}</div>
                ${message.importante ? '<div class="mt-2"><span class="inline-flex items-center px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-800"><i class="fas fa-star mr-1"></i>Importante</span></div>' : ''}

                <!-- Botón para abrir mensaje completo -->
                <div class="mt-3 flex items-center justify-end space-x-2">
                  <button data-action="open-message" data-message-id="${message.id}"
                          class="inline-flex items-center px-3 py-1.5 text-xs font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-1"
                          style="background-color: #C7252B; color: var(--claut-text-primary); border: none;"
                          onmouseover="this.style.backgroundColor='#A01E24'"
                          onmouseout="this.style.backgroundColor='#C7252B'">
                    <i class="fas fa-eye mr-1"></i>
                    Ver completo
                  </button>
                  ${!message.leido ? `
                    <button onclick="window.messageCenter.${this.getMarkAsReadMethod(message)}('${message.id}'${this.getMarkAsReadParams(message)})"
                            class="inline-flex items-center px-3 py-1.5 text-xs font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-1"
                            style="background-color: #059669; color: var(--claut-text-primary); border: none;"
                            onmouseover="this.style.backgroundColor='#047857'"
                            onmouseout="this.style.backgroundColor='#059669'">
                      <i class="fas fa-check mr-1"></i>
                      Marcar leído
                    </button>
                  ` : ''}
                </div>
              </div>
            </div>
          </div>
        `;
      }

      attachEventListeners(container) {
        console.log('🎯 Agregando event listeners a los botones...');

        // Remover event listeners existentes para evitar duplicados
        container.removeEventListener('click', this.clickHandler);

        // Crear el handler como método de la clase para poder removerlo
        this.clickHandler = (e) => {
          const button = e.target.closest('[data-action="open-message"]');
          if (button) {
            e.preventDefault();
            e.stopPropagation();

            const messageId = button.getAttribute('data-message-id');
            console.log('🔴 Event listener: Botón Ver completo clickeado:', messageId);

            if (window.openMessageDetail && typeof window.openMessageDetail === 'function') {
              console.log('✅ Llamando a window.openMessageDetail...');
              window.openMessageDetail(messageId);
            } else {
              console.error('❌ window.openMessageDetail no está disponible');
              alert('Error: Función openMessageDetail no disponible');
            }
          }
        };

        // Event delegation para los botones de abrir mensaje
        container.addEventListener('click', this.clickHandler);
      }

      getTypeIcon(tipo) {
        const icons = {
          'boletin': 'fas fa-newspaper',
          'evento': 'fas fa-calendar-alt',
          'documento': 'fas fa-file-alt',
          'comite': 'fas fa-users',
          'comite_texto': 'fas fa-comment-alt',
          'comite_link': 'fas fa-link',
          'comite_imagen': 'fas fa-image',
          'comite_documento': 'fas fa-file-pdf',
          'sistema': 'fas fa-cog',
          'general': 'fas fa-info-circle'
        };
        return icons[tipo] || icons['general'];
      }

      getTypeGradient(tipo) {
        const gradients = {
          'boletin': 'from-blue-400 to-blue-600',
          'evento': 'from-green-400 to-green-600',
          'documento': 'from-purple-400 to-purple-600',
          'comite': 'from-orange-400 to-orange-600',
          'comite_texto': 'from-blue-500 to-blue-700',
          'comite_link': 'from-green-500 to-green-700',
          'comite_imagen': 'from-yellow-500 to-yellow-700',
          'comite_documento': 'from-red-500 to-red-700',
          'sistema': 'from-gray-400 to-gray-600',
          'general': 'from-indigo-400 to-indigo-600'
        };
        return gradients[tipo] || gradients['general'];
      }

      getTimeAgo(dateString) {
        const date = new Date(dateString);
        const now = new Date();
        const diffInSeconds = Math.floor((now - date) / 1000);

        if (diffInSeconds < 60) return 'Ahora';
        if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)}m`;
        if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)}h`;
        if (diffInSeconds < 2592000) return `${Math.floor(diffInSeconds / 86400)}d`;
        return date.toLocaleDateString();
      }

      updateUnreadCount() {
        this.unreadCount = this.messages.filter(m => !m.leido).length;
        const badge = document.getElementById('messageCount');

        if (this.unreadCount > 0) {
          badge.textContent = this.unreadCount > 99 ? '99+' : this.unreadCount;
          badge.classList.remove('hidden');
        } else {
          badge.classList.add('hidden');
        }
      }

      getUserData() {
        // Intentar obtener datos del usuario de múltiples fuentes
        const sources = [
          localStorage.getItem('userData'),
          localStorage.getItem('currentUser'),
          sessionStorage.getItem('userSession'),
          localStorage.getItem('userInfo'),
          sessionStorage.getItem('loginData')
        ];

        // Buscar datos válidos en alguna fuente
        for (const source of sources) {
          if (source) {
            try {
              const parsed = JSON.parse(source);
              if (parsed && (parsed.email || parsed.user_email || parsed.correo)) {
                // Normalizar el objeto para asegurar que tenga la propiedad email
                return {
                  ...parsed,
                  email: parsed.email || parsed.user_email || parsed.correo
                };
              }
            } catch (e) {
              // Si no es JSON, intentar como string simple
              if (source.includes('@')) {
                return { email: source };
              }
            }
          }
        }

        // Si no se encuentra email en storage, intentar obtenerlo de elementos DOM
        const emailElement = document.querySelector('[data-user-email]') ||
          document.querySelector('.user-email') ||
          document.querySelector('#userEmail');

        if (emailElement) {
          const email = emailElement.textContent || emailElement.dataset.userEmail;
          if (email && email.includes('@')) {
            return { email: email.trim() };
          }
        }

        console.warn('No se pudo obtener el email del usuario para filtrar mensajes de comité');
        return null;
      }

      async markAsRead(messageId) {
        try {
          const response = await fetch('./api/notificaciones.php', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ action: 'mark_read', id: messageId })
          });

          const data = await response.json();
          if (data.success) {
            // Actualizar mensaje localmente
            const message = this.messages.find(m => m.id === messageId);
            if (message) {
              message.leido = true;
              this.updateUnreadCount();
              this.renderMessages();
            }
          }
        } catch (error) {
          console.error('Error marcando mensaje como leído:', error);
        }
      }

      async markComiteAsRead(messageId, comiteMessageId) {
        try {
          const response = await fetch('./api/comites.php', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              action: 'marcar_mensaje_leido',
              mensaje_id: comiteMessageId
            })
          });

          const data = await response.json();
          if (data.success) {
            // Actualizar mensaje localmente
            const message = this.messages.find(m => m.id === messageId);
            if (message) {
              message.leido = true;
              this.updateUnreadCount();
              this.renderMessages();
            }
          }
        } catch (error) {
          console.error('Error marcando mensaje de comité como leído:', error);
        }
      }

      async markUsuarioAsRead(messageId, usuarioMessageId) {
        try {
          const response = await fetch('./api/usuarios_mensajes.php', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              action: 'marcar_mensaje_leido',
              mensaje_id: usuarioMessageId
            })
          });

          const data = await response.json();
          if (data.success) {
            // Actualizar mensaje localmente
            const message = this.messages.find(m => m.id === messageId);
            if (message) {
              message.leido = true;
              this.updateUnreadCount();
              this.renderMessages();
            }
          }
        } catch (error) {
          console.error('Error marcando mensaje de usuario como leído:', error);
        }
      }

      getMarkAsReadMethod(message) {
        if (message.id && message.id.toString().startsWith('comite_')) {
          return 'markComiteAsRead';
        } else if (message.id && message.id.toString().startsWith('usuario_')) {
          return 'markUsuarioAsRead';
        }
        return 'markAsRead';
      }

      getMarkAsReadParams(message) {
        if (message.id && message.id.toString().startsWith('comite_')) {
          return `, ${message.mensaje_id}`;
        } else if (message.id && message.id.toString().startsWith('usuario_')) {
          return `, ${message.mensaje_id}`;
        }
        return '';
      }

      async markAllAsRead() {
        try {
          const response = await fetch('./api/notificaciones.php', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ action: 'mark_all_read' })
          });

          const data = await response.json();
          if (data.success) {
            this.messages.forEach(m => m.leido = true);
            this.updateUnreadCount();
            this.renderMessages();
          }
        } catch (error) {
          console.error('Error marcando todos los mensajes como leídos:', error);
        }
      }

      showLoading() {
        document.getElementById('messagesLoading').classList.remove('hidden');
        document.getElementById('noMessages').classList.add('hidden');
        document.getElementById('messagesList').classList.add('hidden');
      }

      showNoMessages() {
        document.getElementById('messagesLoading').classList.add('hidden');
        document.getElementById('noMessages').classList.remove('hidden');
        document.getElementById('messagesList').classList.add('hidden');
      }
    }

    // Inicializar el centro de mensajes cuando el usuario esté autenticado
    let messageCenter;

    function initializeMessageCenter() {
      const messageCenterButton = document.getElementById('messageCenterButton');
      const userData = localStorage.getItem('userData') || sessionStorage.getItem('userData');
      const sessionData = window.sessionStorage || {};

      console.log('🔔 Inicializando centro de mensajes...');
      console.log('📧 Botón buzón:', !!messageCenterButton);
      console.log('👤 Datos usuario:', !!userData);

      // Verificar si hay sesión activa por cualquier método
      const hasSession = userData ||
        sessionData.user_email ||
        document.querySelector('.user-name') ||
        document.querySelector('[data-user]') ||
        window.currentUser;

      // Mostrar el botón siempre que haya una sesión detectada
      if (messageCenterButton && hasSession) {
        messageCenterButton.classList.remove('hidden');
        console.log('✅ Botón de buzón mostrado');

        if (!messageCenter) {
          messageCenter = new MessageCenter();
          window.messageCenter = messageCenter;
          console.log('✅ Centro de mensajes inicializado');
        }
      } else {
        console.log('❌ No se pudo inicializar:', {
          hasButton: !!messageCenterButton,
          hasUserData: !!userData,
          hasSession: !!hasSession
        });
      }
    }

    // Hacer disponible globalmente
    window.messageCenter = messageCenter;
    window.initializeMessageCenter = initializeMessageCenter;

    // Inicialización resiliente con múltiples intentos
    function attemptMessageCenterInit() {
      console.log('🔄 Intentando inicializar centro de mensajes...');

      // Intentar inicializar inmediatamente
      initializeMessageCenter();

      // Si no funcionó, intentar después de un tiempo
      setTimeout(() => {
        if (!window.messageCenter) {
          console.log('🔄 Reintentando inicialización...');
          initializeMessageCenter();
        }
      }, 1000);

      // Último intento después de 3 segundos
      setTimeout(() => {
        if (!window.messageCenter) {
          console.log('🔄 Último intento de inicialización...');
          // Forzar mostrar el botón si el usuario está logueado
          const messageCenterButton = document.getElementById('messageCenterButton');
          const userData = localStorage.getItem('userData') || sessionStorage.getItem('userData');

          // Verificar múltiples métodos de detección de sesión
          const hasSession = userData ||
            document.querySelector('.user-name') ||
            document.querySelector('[data-user]') ||
            window.currentUser ||
            document.body.classList.contains('authenticated');

          if (messageCenterButton && hasSession) {
            messageCenterButton.classList.remove('hidden');
            if (!window.messageCenter) {
              window.messageCenter = new MessageCenter();
              console.log('✅ Centro de mensajes forzado');
            }
          }
        }
      }, 3000);
    }

    // Función global para abrir el centro de mensajes
    window.openMessageCenter = function () {
      console.log('🔔 Función openMessageCenter llamada');

      // Verificar elementos críticos
      const modal = document.getElementById('messageModal');
      const container = document.getElementById('messageContainer');
      console.log('🔍 Modal exists:', !!modal);
      console.log('🔍 Container exists:', !!container);

      if (!window.messageCenter) {
        console.log('📧 Creando centro de mensajes on-demand');
        window.messageCenter = new MessageCenter();
      }

      if (window.messageCenter) {
        window.messageCenter.openModal();
      } else {
        console.error('❌ No se pudo crear MessageCenter');
      }
    };

    // Función global para toggle del centro de mensajes (compatibilidad)
    window.toggleMessageCenter = function () {
      console.log('🔔 Función toggleMessageCenter llamada');

      if (window.messageCenter) {
        console.log('✅ Usando messageCenter.toggleModal()');
        window.messageCenter.toggleModal();
      } else if (window.openMessageCenter) {
        console.log('✅ Fallback a openMessageCenter()');
        window.openMessageCenter();
      } else {
        console.log('⚠️ Creando messageCenter desde toggleMessageCenter');
        window.messageCenter = new MessageCenter();
        window.messageCenter.openModal();
      }
    };

    // Ejecutar cuando se carga el DOM
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', attemptMessageCenterInit);
    } else {
      attemptMessageCenterInit();
    }

    // Forzar inicialización después de 2 segundos como fallback
    setTimeout(() => {
      if (!window.messageCenter) {
        console.log('🔧 Forzando inicialización de MessageCenter...');
        try {
          window.messageCenter = new MessageCenter();
          console.log('✅ MessageCenter forzado creado exitosamente');
        } catch (error) {
          console.error('❌ Error forzando MessageCenter:', error);
        }
      }
    }, 2000);

    // ========== FUNCIONES PARA DETALLE DE MENSAJES ==========

    // Variable global para almacenar el mensaje actual
    let currentDetailMessage = null;
    let isModalOpen = false; // Prevenir apertura múltiple

    // Función para abrir el detalle de un mensaje
    window.openMessageDetail = function (messageId) {
      console.log('🔍 Abriendo detalle del mensaje:', messageId);

      // Prevenir apertura múltiple
      if (isModalOpen) {
        console.log('⚠️ Modal ya está abierto, ignorando...');
        return;
      }

      if (!window.messageCenter || !window.messageCenter.messages) {
        console.error('❌ MessageCenter no disponible');
        console.log('🔍 Debug: window.messageCenter existe:', !!window.messageCenter);
        console.log('🔍 Debug: messageCenter.messages existe:', !!(window.messageCenter && window.messageCenter.messages));
        return;
      }

      console.log('📋 Mensajes disponibles:', window.messageCenter.messages.length);

      // Buscar el mensaje
      const message = window.messageCenter.messages.find(m => m.id === messageId);
      if (!message) {
        console.error('❌ Mensaje no encontrado:', messageId);
        console.log('🔍 IDs disponibles:', window.messageCenter.messages.map(m => m.id));
        return;
      }

      console.log('✅ Mensaje encontrado:', message.titulo);
      currentDetailMessage = message;

      // Actualizar el modal con la información del mensaje
      console.log('📝 Poblando detalle del mensaje...');
      populateMessageDetail(message);

      // Mostrar el modal
      const modal = document.getElementById('messageDetailModal');
      const container = document.getElementById('messageDetailContainer');

      console.log('🔍 Elementos del modal:');
      console.log('- modal existe:', !!modal);
      console.log('- container existe:', !!container);

      if (modal && container) {
        console.log('👁️ Mostrando modal...');
        console.log('🔍 Estado inicial del modal:', {
          classList: Array.from(modal.classList),
          display: getComputedStyle(modal).display,
          visibility: getComputedStyle(modal).visibility,
          opacity: getComputedStyle(modal).opacity,
          zIndex: getComputedStyle(modal).zIndex
        });

        modal.classList.remove('hidden');
        modal.style.display = 'block !important';
        modal.style.visibility = 'visible !important';
        modal.style.opacity = '1 !important';
        modal.style.zIndex = '999999';
        modal.style.position = 'fixed';
        modal.style.top = '0';
        modal.style.left = '0';
        modal.style.right = '0';
        modal.style.bottom = '0';

        // Marcar modal como abierto
        isModalOpen = true;

        // Forzar reflow antes de añadir la clase show
        setTimeout(() => {
          console.log('✨ Agregando clase show...');
          modal.classList.add('show');

          // Forzar visibilidad del contenedor interno también
          if (container) {
            container.style.transform = 'scale(1) !important';
            container.style.opacity = '1 !important';
            container.style.display = 'block !important';
            container.style.visibility = 'visible !important';
          }

          console.log('🔍 Estado después de show:', {
            classList: Array.from(modal.classList),
            display: getComputedStyle(modal).display,
            visibility: getComputedStyle(modal).visibility,
            opacity: getComputedStyle(modal).opacity
          });
        }, 10);
      } else {
        console.error('❌ No se encontraron elementos del modal');
        isModalOpen = false;
      }

      // Marcar como leído al abrir
      if (!message.leido) {
        markCurrentMessageAsRead();
      }
    };

    // Función para cerrar el detalle del mensaje
    window.closeMessageDetail = function () {
      console.log('🚪 Cerrando detalle del mensaje');

      const modal = document.getElementById('messageDetailModal');

      if (modal) {
        modal.classList.remove('show');
        setTimeout(() => {
          modal.classList.add('hidden');
          currentDetailMessage = null;
          isModalOpen = false; // Permitir abrir modal de nuevo
          console.log('🔓 Modal cerrado, isModalOpen = false');
        }, 300);
      } else {
        isModalOpen = false; // Asegurar que se libere el flag
      }
    };

    // Función para rellenar el modal con los datos del mensaje
    function populateMessageDetail(message) {
      console.log('📝 Poblando detalle del mensaje:', message);

      const isComiteMessage = message.id && message.id.toString().startsWith('comite_');

      // Verificar elementos existentes
      const titleElement = document.getElementById('messageDetailTitle');
      const iconElement = document.getElementById('messageDetailIcon');
      const dateElement = document.getElementById('messageDetailDate');

      console.log('🔍 Verificando elementos del modal:', {
        title: !!titleElement,
        icon: !!iconElement,
        date: !!dateElement
      });

      // Título y metainformación
      if (titleElement) {
        titleElement.textContent = message.titulo || 'Sin título';
        console.log('✅ Título establecido:', message.titulo);
      }

      if (iconElement && window.messageCenter) {
        iconElement.className = window.messageCenter.getTypeIcon(message.tipo);
        console.log('✅ Icono establecido para tipo:', message.tipo);
      }

      // Fecha formateada
      if (dateElement) {
        const fecha = new Date(message.fecha_creacion || message.fecha);
        dateElement.textContent = fecha.toLocaleString('es-ES');
        console.log('✅ Fecha establecida:', fecha.toLocaleString('es-ES'));
      }

      // Tipo de mensaje
      const tipoTexto = {
        'boletin': 'Boletín Informativo',
        'evento': 'Evento',
        'documento': 'Documento',
        'comite': 'Mensaje del Comité',
        'comite_texto': 'Mensaje de Texto del Comité',
        'comite_link': 'Enlace del Comité',
        'comite_imagen': 'Imagen del Comité',
        'comite_documento': 'Documento del Comité',
        'sistema': 'Mensaje del Sistema',
        'general': 'Mensaje General'
      };
      document.getElementById('messageDetailType').textContent = tipoTexto[message.tipo] || 'Desconocido';

      // Estado
      const statusElement = document.getElementById('messageDetailStatus');
      if (message.leido) {
        statusElement.innerHTML = '<span class="inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-100 text-green-800"><i class="fas fa-check mr-1"></i>Leído</span>';
      } else {
        statusElement.innerHTML = '<span class="inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-800"><i class="fas fa-envelope mr-1"></i>Sin leer</span>';
      }

      // Metainformación
      const metaInfo = [];
      if (isComiteMessage && message.comite_nombre) {
        metaInfo.push(`Comité: ${message.comite_nombre}`);
      }
      if (message.importante) {
        metaInfo.push('⭐ Importante');
      }
      document.getElementById('messageDetailMeta').textContent = metaInfo.join(' • ') || 'Información del mensaje';

      // Contenido del mensaje
      const contentElement = document.getElementById('messageDetailContent');
      let contenidoHTML = '';

      if (isComiteMessage) {
        // Formato especial para mensajes de comité
        const contenido = message.contenido_original || message.mensaje || message.contenido || '';

        switch (message.tipo_original) {
          case 'texto':
            contenidoHTML = `<div class="whitespace-pre-wrap">${contenido}</div>`;
            break;

          case 'link':
            if (typeof contenido === 'object' && contenido.url) {
              contenidoHTML = `
                <div class="space-y-3">
                  <h4 class="font-medium">${contenido.titulo || 'Enlace compartido'}</h4>
                  <p class="text-gray-600">${contenido.descripcion || ''}</p>
                  <a href="${contenido.url}" target="_blank" class="message-content-link inline-flex items-center">
                    <i class="fas fa-external-link-alt mr-2"></i>
                    ${contenido.url}
                  </a>
                </div>
              `;
            } else {
              contenidoHTML = `<a href="${contenido}" target="_blank" class="message-content-link">${contenido}</a>`;
            }
            break;

          case 'imagen':
            if (typeof contenido === 'object' && contenido.imagen) {
              contenidoHTML = `
                <div class="space-y-3">
                  <h4 class="font-medium">${contenido.titulo || 'Imagen compartida'}</h4>
                  <p class="text-gray-600">${contenido.descripcion || ''}</p>
                  <img src="${contenido.imagen}" alt="Imagen del mensaje" class="detail-modal-image max-w-full h-auto rounded-lg border">
                </div>
              `;
            } else {
              contenidoHTML = `<img src="${contenido}" alt="Imagen del mensaje" class="detail-modal-image max-w-full h-auto rounded-lg border">`;
            }
            break;

          case 'documento':
            if (typeof contenido === 'object' && contenido.archivo) {
              contenidoHTML = `
                <div class="space-y-3">
                  <h4 class="font-medium">${contenido.titulo || 'Documento compartido'}</h4>
                  <p class="text-gray-600">${contenido.descripcion || ''}</p>
                  <div class="message-attachment-item">
                    <div class="flex items-center space-x-3">
                      <i class="fas fa-file-pdf text-red-500 text-xl"></i>
                      <div>
                        <p class="font-medium">${contenido.nombre || 'Documento'}</p>
                        <p class="text-sm text-gray-300">${contenido.tamaño || ''}</p>
                      </div>
                    </div>
                    <a href="${contenido.archivo}" target="_blank" class="text-red-600 hover:text-blue-700">
                      <i class="fas fa-download"></i>
                    </a>
                  </div>
                </div>
              `;
            }
            break;

          default:
            contenidoHTML = `<div class="whitespace-pre-wrap">${contenido}</div>`;
        }
      } else {
        // Mensaje regular
        contenidoHTML = `<div class="whitespace-pre-wrap">${message.mensaje || message.contenido || 'Sin contenido'}</div>`;
      }

      contentElement.innerHTML = contenidoHTML;

      // Mostrar/ocultar sección del comité
      const comiteSection = document.getElementById('messageDetailComiteSection');
      if (isComiteMessage && message.comite_nombre) {
        document.getElementById('messageDetailComiteName').textContent = message.comite_nombre;
        comiteSection.classList.remove('hidden');
      } else {
        comiteSection.classList.add('hidden');
      }

      // Actualizar botones
      updateMessageDetailButtons(message);
    }

    // Función para actualizar los botones del modal
    function updateMessageDetailButtons(message) {
      const markReadBtn = document.getElementById('markReadBtn');
      const toggleImportantBtn = document.getElementById('toggleImportantBtn');

      // Botón marcar como leído
      if (message.leido) {
        markReadBtn.innerHTML = '<i class="fas fa-check mr-2"></i>Ya leído';
        markReadBtn.disabled = true;
        markReadBtn.classList.add('opacity-50', 'cursor-not-allowed');
      } else {
        markReadBtn.innerHTML = '<i class="fas fa-check mr-2"></i>Marcar como leído';
        markReadBtn.disabled = false;
        markReadBtn.classList.remove('opacity-50', 'cursor-not-allowed');
      }

      // Botón importante
      if (message.importante) {
        toggleImportantBtn.innerHTML = '<i class="fas fa-star mr-2"></i>Quitar importante';
        toggleImportantBtn.classList.remove('bg-yellow-500', 'hover:bg-yellow-600');
        toggleImportantBtn.classList.add('bg-gray-500', 'hover:bg-gray-600');
      } else {
        toggleImportantBtn.innerHTML = '<i class="fas fa-star mr-2"></i>Marcar importante';
        toggleImportantBtn.classList.remove('bg-gray-500', 'hover:bg-gray-600');
        toggleImportantBtn.classList.add('bg-yellow-500', 'hover:bg-yellow-600');
      }
    }

    // Función para marcar el mensaje actual como leído
    window.markMessageAsRead = function () {
      if (!currentDetailMessage) return;

      markCurrentMessageAsRead();
      currentDetailMessage.leido = true;
      updateMessageDetailButtons(currentDetailMessage);

      // Actualizar la lista de mensajes
      if (window.messageCenter) {
        window.messageCenter.updateUnreadCount();
        window.messageCenter.renderMessages();
      }
    };

    // Función para toggle importante del mensaje actual
    window.toggleMessageImportant = function () {
      if (!currentDetailMessage) return;

      currentDetailMessage.importante = !currentDetailMessage.importante;
      updateMessageDetailButtons(currentDetailMessage);

      // Actualizar la lista de mensajes
      if (window.messageCenter) {
        window.messageCenter.renderMessages();
      }
    };

    // Función interna para marcar como leído
    function markCurrentMessageAsRead() {
      if (!currentDetailMessage) return;

      const isComiteMessage = currentDetailMessage.id && currentDetailMessage.id.toString().startsWith('comite_');

      if (isComiteMessage) {
        window.messageCenter.markComiteAsRead(currentDetailMessage.id, currentDetailMessage.mensaje_id);
      } else {
        window.messageCenter.markAsRead(currentDetailMessage.id);
      }
    }

    // Event listeners para cerrar el modal
    document.addEventListener('DOMContentLoaded', function () {
      // Cerrar con backdrop
      const backdrop = document.getElementById('messageDetailBackdrop');
      if (backdrop) {
        backdrop.addEventListener('click', closeMessageDetail);
      }

      // Cerrar con tecla Escape
      document.addEventListener('keydown', function (e) {
        if (e.key === 'Escape' && currentDetailMessage) {
          closeMessageDetail();
        }
      });
    });
  </script>

  <!-- Claut Premium GSAP Scroll Animations -->
  <script>
    // Registrar ScrollTrigger plugin
    gsap.registerPlugin(ScrollTrigger);

    // Animaciones GSAP similares a empresas-convenio.html
    function initClautScrollAnimations() {
      // Background image motion scroll effect
      gsap.set('.image-motion', {
        rotateX: 90,
        transformOrigin: '50% 0%'
      });

      gsap.to('.image-motion', {
        rotateX: 0,
        scrollTrigger: {
          trigger: 'body',
          start: 'top top',
          end: 'bottom bottom',
          scrub: 1,
          markers: false
        }
      });

      // Hero section animation
      gsap.fromTo(".claut-hero h1", {
        opacity: 0,
        y: 50,
        scale: 0.9
      }, {
        opacity: 1,
        y: 0,
        scale: 1,
        duration: 1.2,
        ease: "power3.out"
      });

      gsap.fromTo(".claut-hero p", {
        opacity: 0,
        y: 30
      }, {
        opacity: 1,
        y: 0,
        duration: 1,
        delay: 0.3,
        ease: "power2.out"
      });

      // Hero stats staggered animation
      gsap.fromTo(".claut-hero .grid > div", {
        opacity: 0,
        y: 40,
        scale: 0.8
      }, {
        opacity: 1,
        y: 0,
        scale: 1,
        duration: 0.8,
        stagger: 0.2,
        delay: 0.6,
        ease: "back.out(1.7)"
      });

      // Scroll-triggered animations para elementos con claut-scroll-reveal
      gsap.utils.toArray(".claut-scroll-reveal").forEach((element, index) => {
        gsap.fromTo(element, {
          opacity: 0,
          y: 60,
          scale: 0.95
        }, {
          opacity: 1,
          y: 0,
          scale: 1,
          duration: 1,
          delay: index * 0.1,
          ease: "power3.out",
          scrollTrigger: {
            trigger: element,
            start: "top 85%",
            end: "bottom 15%",
            toggleActions: "play none none reverse"
          }
        });
      });

      // Cards hover animations con GSAP
      gsap.utils.toArray(".claut-card, .claut-stat-card").forEach((card) => {
        card.addEventListener("mouseenter", () => {
          gsap.to(card, {
            y: -8,
            scale: 1.02,
            duration: 0.4,
            ease: "power2.out"
          });
        });

        card.addEventListener("mouseleave", () => {
          gsap.to(card, {
            y: 0,
            scale: 1,
            duration: 0.4,
            ease: "power2.out"
          });
        });
      });

      // Enhanced Header Scroll Behavior
      let lastScrollY = window.scrollY;
      let ticking = false;

      function updateHeaderState(self) {
        const header = document.querySelector('.claut-header');
        const currentScrollY = window.scrollY;

        // Add scrolled class for enhanced styling
        if (currentScrollY > 50) {
          header.classList.add('scrolled');
        } else {
          header.classList.remove('scrolled');
        }

        // Keep header always visible - no hide/show behavior
        // Ensure header stays fixed at top
        gsap.set(header, {
          y: 0,
          position: "fixed",
          top: 0
        });

        lastScrollY = currentScrollY;
        ticking = false;
      }

      ScrollTrigger.create({
        trigger: "body",
        start: "top top",
        end: "bottom bottom",
        onUpdate: (self) => {
          if (!ticking) {
            requestAnimationFrame(() => updateHeaderState(self));
            ticking = true;
          }
        }
      });

      // Background parallax effect
      ScrollTrigger.create({
        trigger: ".claut-hero",
        start: "top bottom",
        end: "bottom top",
        scrub: 1,
        onUpdate: (self) => {
          gsap.to(".claut-hero .text-center", {
            y: self.progress * -50,
            ease: "none"
          });
        }
      });
    }

    // Fallback para IntersectionObserver si GSAP no está disponible
    function initAppleScrollAnimations() {
      // Crear observer con configuración optimizada
      const observerOptions = {
        threshold: [0.1, 0.5], // Múltiples thresholds para mejor control
        rootMargin: '0px 0px -80px 0px' // Trigger un poco antes
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry, index) => {
          if (entry.isIntersecting) {
            // Añadir delay natural basado en posición
            const delay = entry.target.dataset.delay || index * 100;

            setTimeout(() => {
              entry.target.classList.add('revealed');

              // Efecto cascade para elementos hijos
              const children = entry.target.querySelectorAll('.apple-card, .apple-stat-card');
              children.forEach((child, childIndex) => {
                setTimeout(() => {
                  child.style.opacity = '1';
                  child.style.transform = 'translateY(0) scale(1)';
                }, childIndex * 100);
              });
            }, delay);

            // Una vez revelado, dejar de observar para performance
            observer.unobserve(entry.target);
          }
        });
      }, observerOptions);

      // Observar elementos con mejor configuración inicial
      document.querySelectorAll('.apple-scroll-reveal').forEach((el, index) => {
        // Estado inicial mejorado
        el.style.opacity = '0';
        el.style.transform = 'translateY(30px)';
        el.style.transition = `all 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) ${index * 50}ms`;

        observer.observe(el);
      });

      // También aplicar a cards individuales
      document.querySelectorAll('.apple-card, .apple-stat-card').forEach((card, index) => {
        if (!card.closest('.apple-scroll-reveal')) {
          card.style.opacity = '0';
          card.style.transform = 'translateY(20px) scale(0.95)';
          card.style.transition = `all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) ${index * 80}ms`;
        }
      });
    }

    // Animaciones adicionales para elementos que se cargan dinámicamente
    function animateNewElements(container) {
      const newElements = container.querySelectorAll('.apple-card, .apple-stat-card');
      newElements.forEach((element, index) => {
        element.style.opacity = '0';
        element.style.transform = 'translateY(20px) scale(0.95)';

        setTimeout(() => {
          element.style.transition = 'all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
          element.style.opacity = '1';
          element.style.transform = 'translateY(0) scale(1)';
        }, index * 100);
      });
    }

    // Apple-style premium statistics cards
    function createAppleStatCard(stat) {
      const gradientColors = {
        'from-blue-500 to-cyan-500': { bg: '#C7252B', light: 'rgba(199, 37, 43, 0.1)' },
        'from-purple-500 to-pink-500': { bg: '#af52de', light: 'rgba(175, 82, 222, 0.1)' },
        'from-green-500 to-emerald-500': { bg: '#34c759', light: 'rgba(52, 199, 89, 0.1)' },
        'from-orange-500 to-red-500': { bg: '#ff9500', light: 'rgba(255, 149, 0, 0.1)' }
      };

      const colors = gradientColors[stat.gradient] || { bg: '#C7252B', light: 'rgba(199, 37, 43, 0.1)' };

      return `
        <div class="apple-stat-card apple-scroll-reveal" style="transition-delay: ${stat.delay || 0}ms">
          <div class="apple-card-content">
            <!-- Header de la card -->
            <div class="flex items-center justify-between" style="margin-bottom: var(--space-6);">
              <div class="flex items-center" style="gap: var(--space-4);">
                <div style="
                  width: 48px;
                  height: 48px;
                  background: ${colors.bg};
                  border-radius: var(--radius-lg);
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  box-shadow: var(--apple-shadow-soft);
                ">
                  <i class="${stat.icon}" style="color: var(--claut-text-primary); font-size: 1.25rem;"></i>
                </div>
                <div>
                  <h3 class="apple-headline" style="margin: 0 0 4px 0;">${stat.title}</h3>
                  <p class="apple-caption" style="margin: 0;">${stat.description}</p>
                </div>
              </div>
            </div>

            <!-- Valor principal -->
            <div class="text-right" style="margin-bottom: var(--space-4);">
              <div class="apple-title-large" style="
                color: ${colors.bg};
                margin-bottom: var(--space-2);
                font-weight: var(--apple-font-bold);
              ">
                ${stat.value}
              </div>

              <!-- Indicador de tendencia -->
              <div class="flex items-center justify-end" style="gap: var(--space-2);">
                <div class="flex items-center" style="
                  font-size: 0.875rem;
                  color: ${stat.trend === 'up' ? 'var(--apple-accent-secondary)' : stat.trend === 'down' ? 'var(--apple-accent-error)' : 'var(--apple-text-tertiary)'};
                  font-weight: var(--apple-font-medium);
                  gap: var(--space-1);
                ">
                  ${stat.trend === 'up' ? '<i class="fas fa-arrow-up"></i>' : stat.trend === 'down' ? '<i class="fas fa-arrow-down"></i>' : ''}
                  <span>${stat.change}</span>
                </div>
              </div>
            </div>

            <!-- Barra de progreso sutil -->
            <div style="
              width: 100%;
              height: 4px;
              background: ${colors.light};
              border-radius: 2px;
              overflow: hidden;
            ">
              <div style="
                height: 100%;
                background: ${colors.bg};
                border-radius: 2px;
                width: 75%;
                transition: width var(--transition-slow);
              "></div>
            </div>
          </div>
        </div>
      `;
    }

    // Enhanced statistics loading function
    async function loadAppleStyleStats() {
      const container = document.getElementById('estadisticasContainer');
      if (!container) return;

      try {
        const response = await fetch('./api/estadisticas.php');
        const data = await response.json();

        if (data.success && data.estadisticas) {
          const gradients = [
            'from-blue-500 to-cyan-500',
            'from-purple-500 to-pink-500',
            'from-green-500 to-emerald-500',
            'from-orange-500 to-red-500'
          ];

          let html = '';
          data.estadisticas.forEach((stat, index) => {
            const appleStatData = {
              title: stat.titulo,
              description: stat.descripcion || 'Métrica',
              value: stat.valor,
              icon: stat.icono || 'fas fa-chart-line',
              gradient: gradients[index % gradients.length],
              change: stat.cambio || '+0%',
              trend: stat.tendencia || 'neutral',
              delay: index * 100
            };
            html += createAppleStatCard(appleStatData);
          });

          container.innerHTML = html;

          // Re-initialize scroll animations for new elements
          setTimeout(() => {
            initAppleScrollAnimations();
          }, 100);
        }
      } catch (error) {
        console.error('Error loading statistics:', error);
        // Show error message instead of fallback data
        showErrorMessage(error.message);
      }
    }


    // Claut Premium Integration y Responsive
    document.addEventListener('DOMContentLoaded', function () {
      // 1. Initialize GSAP scroll animations
      if (typeof gsap !== 'undefined') {
        initClautScrollAnimations();
      } else {
        initAppleScrollAnimations(); // fallback
      }

      // 2. Integrar header actions con funcionalidad existente
      setupClautHeaderIntegration();

      // 3. Load statistics con nuevo styling
      setTimeout(() => {
        loadClautStyleStats();
      }, 300);

      // 4. Aplicar clases Claut a elementos existentes
      setTimeout(() => {
        convertToClautElements();
      }, 500);

      // 5. Setup responsive behaviors
      setupClautResponsiveBehaviors();

      // 6. Setup mobile menu toggle
      setupMobileMenu();
    });

    // Integración del header Claut con funcionalidad existente
    function setupClautHeaderIntegration() {
      // Conectar botón mensajes del header
      const headerMessagesBtn = document.getElementById('headerMessagesBtn');
      if (headerMessagesBtn) {
        headerMessagesBtn.addEventListener('click', () => {
          if (window.messageCenter) {
            window.messageCenter.forceOpen();
          } else if (window.toggleMessageCenter) {
            window.toggleMessageCenter();
          }
        });
      }


      // Menu usuario - Redirigir al perfil
      const headerUserMenuBtn = document.getElementById('headerUserMenuBtn');
      if (headerUserMenuBtn) {
        headerUserMenuBtn.addEventListener('click', () => {
          window.location.href = 'https://intranet.clautmetropolitano.mx/build/profile.html';
        });
      }
    }

    // Setup mobile menu toggle
    function setupMobileMenu() {
      const mobileMenuBtn = document.getElementById('mobileMenuBtn');

      if (mobileMenuBtn) {
        mobileMenuBtn.addEventListener('click', (e) => {
          e.preventDefault();

          // Crear o mostrar menú de cerrar sesión
          let mobileDropdown = document.getElementById('mobileDropdownMenu');

          if (!mobileDropdown) {
            // Crear el menú desplegable
            mobileDropdown = document.createElement('div');
            mobileDropdown.id = 'mobileDropdownMenu';
            mobileDropdown.className = 'absolute right-0 top-full mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-50';
            mobileDropdown.style.display = 'none';

            mobileDropdown.innerHTML = `
              <div class="py-2">
                <button id="mobileLogoutBtn" class=" text-red w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-red-50 hover:text-red-600 flex items-center">
                  <i class="text-red fas fa-sign-out-alt mr-3 "></i>
                  Cerrar Sesión
                </button>
              </div>
            `;

            // Agregar el menú al contenedor del botón
            mobileMenuBtn.parentElement.style.position = 'relative';
            mobileMenuBtn.parentElement.appendChild(mobileDropdown);

            // Agregar evento de cerrar sesión
            const logoutBtn = mobileDropdown.querySelector('#mobileLogoutBtn');
            logoutBtn.addEventListener('click', () => {
              if (window.authSessionManager) {
                window.authSessionManager.logout();
              } else if (window.logout) {
                window.logout();
              } else {
                // Fallback: logout manual
                sessionStorage.clear();
                localStorage.clear();
                window.location.href = 'https://intranet.clautmetropolitano.mx/build/';
              }
              mobileDropdown.style.display = 'none';
            });
          }

          // Toggle del menú
          if (mobileDropdown.style.display === 'none') {
            mobileDropdown.style.display = 'block';
            const icon = mobileMenuBtn.querySelector('i');
            icon.classList.remove('fa-bars');
            icon.classList.add('fa-times');
          } else {
            mobileDropdown.style.display = 'none';
            const icon = mobileMenuBtn.querySelector('i');
            icon.classList.remove('fa-times');
            icon.classList.add('fa-bars');
          }
        });

        // Cerrar menú al hacer clic afuera
        document.addEventListener('click', (e) => {
          const mobileDropdown = document.getElementById('mobileDropdownMenu');
          if (mobileDropdown && !mobileMenuBtn.contains(e.target) && !mobileDropdown.contains(e.target)) {
            mobileDropdown.style.display = 'none';
            const icon = mobileMenuBtn.querySelector('i');
            icon.classList.remove('fa-times');
            icon.classList.add('fa-bars');
          }
        });
      }
    }

    // Convertir elementos existentes al tema Claut
    function convertToClautElements() {
      // Cards
      document.querySelectorAll('.porsche-card, .apple-card').forEach(el => {
        el.classList.add('claut-card');
      });

      // Typography
      document.querySelectorAll('.porsche-title, .apple-title').forEach(el => {
        el.classList.add('claut-title');
      });

      document.querySelectorAll('.porsche-subtitle, .apple-headline').forEach(el => {
        el.classList.add('claut-headline');
      });

      document.querySelectorAll('.porsche-body, .apple-body').forEach(el => {
        el.classList.add('claut-body');
      });

      document.querySelectorAll('.apple-scroll-reveal').forEach(el => {
        el.classList.add('claut-scroll-reveal');
      });

      // Update existing stat cards
      document.querySelectorAll('.apple-stat-card').forEach(el => {
        el.classList.add('claut-stat-card');
      });

      // Fix layout responsive
      fixResponsiveLayout();
    }

    // Fix responsive layout function - minimal changes to preserve original layout
    function fixResponsiveLayout() {
      // Only apply minimal fixes for mobile
      if (window.innerWidth <= 768) {
        const navbar = document.querySelector('.porsche-navbar');
        if (navbar) {
          navbar.style.marginLeft = '0';
          navbar.style.marginRight = '0';
        }

        // Prevent horizontal overflow on cards only if needed
        document.querySelectorAll('.bg-white, .porsche-card').forEach(card => {
          if (card.scrollWidth > card.clientWidth) {
            card.style.maxWidth = '100%';
            card.style.boxSizing = 'border-box';
          }
        });
      }
    }

    // Load statistics con tema Claut
    async function loadClautStyleStats() {
      const container = document.getElementById('estadisticasContainer');
      if (!container) return;

      try {
        const response = await fetch('./api/estadisticas.php');
        const data = await response.json();

        if (data.success && data.estadisticas) {
          const colors = [
            { bg: '#C7252B', light: 'rgba(199, 37, 43, 0.2)' },
            { bg: '#28a745', light: 'rgba(40, 167, 69, 0.2)' },
            { bg: '#17a2b8', light: 'rgba(23, 162, 184, 0.2)' },
            { bg: '#ffc107', light: 'rgba(255, 193, 7, 0.2)' }
          ];

          let html = '';
          data.estadisticas.forEach((stat, index) => {
            const color = colors[index % colors.length];
            html += createClautStatCard({
              ...stat,
              color: color,
              delay: index * 100
            });
          });

          container.innerHTML = html;

          // Re-initialize animations
          setTimeout(() => {
            if (typeof gsap !== 'undefined') {
              initClautScrollAnimations();
            }
          }, 100);
        }
      } catch (error) {
        console.error('Error loading statistics:', error);
        showErrorMessage(error.message);
      }
    }

    // Create Claut-style stat cards
    function createClautStatCard(stat) {
      return `
        <div class="claut-stat-card claut-scroll-reveal" style="transition-delay: ${stat.delay || 0}ms">
          <div class="flex items-center justify-between mb-6">
            <div class="flex items-center gap-4">
              <div style="
                width: 48px;
                height: 48px;
                background: ${stat.color.bg};
                border-radius: var(--radius-lg);
                display: flex;
                align-items: center;
                justify-content: center;
                box-shadow: var(--claut-shadow-red);
              ">
                <i class="${stat.icono || 'fas fa-chart-line'}" style="color: var(--claut-text-primary); font-size: 1.25rem;"></i>
              </div>
              <div>
                <h3 class="claut-headline" style="margin: 0 0 4px 0;">${stat.titulo}</h3>
                <p class="claut-caption" style="margin: 0;">${stat.descripcion || 'Métrica'}</p>
              </div>
            </div>
          </div>

          <div class="text-right mb-4">
            <div class="claut-title-large" style="
              color: ${stat.color.bg};
              margin-bottom: 8px;
              font-weight: var(--apple-font-bold);
            ">
              ${stat.valor}
            </div>

            <div class="flex items-center justify-end gap-2">
              <div class="flex items-center" style="
                font-size: 0.875rem;
                color: var(--claut-accent-secondary);
                font-weight: var(--apple-font-medium);
                gap: 4px;
              ">
                <i class="fas fa-arrow-up"></i>
                <span>${stat.cambio || '+5%'}</span>
              </div>
            </div>
          </div>

          <div style="
            width: 100%;
            height: 4px;
            background: ${stat.color.light};
            border-radius: 2px;
            overflow: hidden;
          ">
            <div style="
              height: 100%;
              background: ${stat.color.bg};
              border-radius: 2px;
              width: 75%;
              transition: width var(--transition-slow);
            "></div>
          </div>
        </div>
      `;
    }


    // Comportamientos responsive para tema Claut
    function setupClautResponsiveBehaviors() {
      const main = document.querySelector('.claut-main');

      // Ajustar main content (sin sidebar lateral)
      if (main) {
        function adjustMainLayout() {
          main.style.marginLeft = '0'; // Sin sidebar lateral
          main.style.width = '100%';
        }

        window.addEventListener('resize', adjustMainLayout);
        adjustMainLayout();
      }

      // Header responsive behavior con GSAP
      if (typeof gsap !== 'undefined') {
        // Ya manejado en initClautScrollAnimations
        console.log('Header behavior handled by GSAP');
      } else {
        // Enhanced Fallback without GSAP
        let lastScrollY = window.scrollY;
        let ticking = false;
        const header = document.querySelector('.claut-header');

        function updateHeaderFallback() {
          const currentScrollY = window.scrollY;

          if (header) {
            // Add scrolled class for enhanced styling
            if (currentScrollY > 50) {
              header.classList.add('scrolled');
            } else {
              header.classList.remove('scrolled');
            }

            // Keep header always visible and fixed at top
            header.style.transform = 'translateY(0)';
            header.style.position = 'fixed';
            header.style.top = '0';
            lastScrollY = currentScrollY;
          }
          ticking = false;
        }

        window.addEventListener('scroll', () => {
          if (!ticking) {
            requestAnimationFrame(updateHeaderFallback);
            ticking = true;
          }
        });
      }

      // Navigation active states
      const navItems = document.querySelectorAll('.claut-nav-item');
      navItems.forEach(item => {
        item.addEventListener('click', (e) => {
          // Remove active from all
          navItems.forEach(nav => nav.classList.remove('active'));
          // Add active to clicked
          e.currentTarget.classList.add('active');

          // Close mobile menu if open
          const mobileNav = document.getElementById('clautMainNav');
          if (mobileNav && mobileNav.classList.contains('show')) {
            mobileNav.classList.remove('show');
            const menuBtn = document.getElementById('mobileMenuBtn');
            if (menuBtn) {
              const icon = menuBtn.querySelector('i');
              icon.classList.remove('fa-times');
              icon.classList.add('fa-bars');
            }
          }
        });
      });
    }

    // Smooth scroll polyfill for older browsers
    function smoothScrollTo(element) {
      if (element) {
        element.scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });
      }
    }

    // Apple-style page transitions
    window.addEventListener('beforeunload', function () {
      document.body.style.opacity = '0.8';
      document.body.style.transform = 'scale(0.98)';
      document.body.style.transition = 'all 0.3s var(--apple-transition)';
    });
  </script>

  <!-- Menú curvo animado en la parte inferior -->
  <nav class="claut-bottom-nav">
    <div class="claut-nav-container">
      <div class="claut-nav-curve"></div>

      <a href="dashboard.html" class="claut-nav-link authenticated active" data-section="inicio">
        <i class="fas fa-home"></i>
        <span>Inicio</span>
      </a>

      <a href="./descuentos.html" class="claut-nav-link authenticated" data-section="descuentos">
        <i class="fas fa-tags"></i>
        <span>Descuentos</span>
      </a>

      <a href="./boletines.html" class="claut-nav-link authenticated" data-section="boletines">
        <i class="fas fa-newspaper"></i>
        <span>Boletines</span>
      </a>

      <a href="./comites.html" class="claut-nav-link authenticated" data-section="comite">
        <i class="fas fa-users"></i>
        <span>Comité</span>
      </a>

      <a href="./contacto.html" class="claut-nav-link authenticated" data-section="contacto">
        <i class="fas fa-headset"></i>
        <span>Contacto</span>
      </a>

      <a href="./eventos.html" class="claut-nav-link authenticated" data-section="eventos">
        <i class="fas fa-calendar-alt"></i>
        <span>Eventos</span>
      </a>

      <a href="./empresas-convenio.html" class="claut-nav-link authenticated" data-section="convenios">
        <i class="fas fa-handshake"></i>
        <span>Convenios</span>
      </a>

      <a href="./admin-panel.html" class="claut-nav-link authenticated" data-section="admin" id="adminNavItemBottom"
        style="display: none;">
        <i class="fas fa-cogs"></i>
        <span>Admin</span>
      </a>
    </div>
  </nav>

  <script>
    // JavaScript para el menú curvo animado
    document.addEventListener('DOMContentLoaded', function () {
      const bottomNavLinks = document.querySelectorAll('.claut-bottom-nav .claut-nav-link');
      const headerNavLinks = document.querySelectorAll('.claut-header-nav .claut-nav-item');
      const navCurve = document.querySelector('.claut-nav-curve');

      function setActiveNav(activeLink) {
        // Remover clase active de todos los enlaces del bottom nav
        bottomNavLinks.forEach(link => link.classList.remove('active'));

        // Agregar clase active al enlace clickeado
        activeLink.classList.add('active');

        // Calcular la posición de la curva
        if (navCurve) {
          const linkRect = activeLink.getBoundingClientRect();
          const navRect = activeLink.parentElement.getBoundingClientRect();
          const relativePosition = ((linkRect.left + linkRect.width / 2 - navRect.left) / navRect.width) * 100;

          // Actualizar la posición de la curva
          navCurve.style.setProperty('--curve-position', relativePosition + '%');
        }

        // Animación suave de los iconos
        if (typeof gsap !== 'undefined') {
          gsap.fromTo(activeLink.querySelector('i'), {
            scale: 1,
            rotation: 0
          }, {
            scale: 1.2,
            rotation: 5,
            duration: 0.3,
            ease: "back.out(1.7)",
            yoyo: true,
            repeat: 1
          });
        }
      }

      // Event listeners para cada enlace del menú inferior
      bottomNavLinks.forEach((link, index) => {
        link.addEventListener('click', function (e) {
          // No prevenir el default para permitir navegación real
          setActiveNav(this);

          const section = this.getAttribute('data-section');
          console.log('Navegando a:', section);
        });

        // Hover effects
        link.addEventListener('mouseenter', function () {
          if (!this.classList.contains('active')) {
            if (typeof gsap !== 'undefined') {
              gsap.to(this.querySelector('i'), {
                scale: 1.1,
                duration: 0.2,
                ease: "power2.out"
              });
            }
          }
        });

        link.addEventListener('mouseleave', function () {
          if (!this.classList.contains('active')) {
            if (typeof gsap !== 'undefined') {
              gsap.to(this.querySelector('i'), {
                scale: 1,
                duration: 0.2,
                ease: "power2.out"
              });
            }
          }
        });
      });

      // Sincronizar navegación entre header y bottom nav
      function syncNavigation() {
        const currentPage = window.location.pathname.split('/').pop() || 'dashboard.html';

        // Remover todas las clases active
        bottomNavLinks.forEach(link => link.classList.remove('active'));
        headerNavLinks.forEach(link => link.classList.remove('active'));

        // Determinar cual debe estar activo basado en la página actual
        let activeBottomLink = null;
        let activeHeaderLink = null;

        if (currentPage.includes('dashboard')) {
          activeBottomLink = document.querySelector('.claut-bottom-nav .claut-nav-link[data-section="inicio"]');
          activeHeaderLink = document.querySelector('.claut-header-nav .claut-nav-item[href*="dashboard"]');
        } else if (currentPage.includes('descuentos')) {
          activeBottomLink = document.querySelector('.claut-bottom-nav .claut-nav-link[data-section="descuentos"]');
          activeHeaderLink = document.querySelector('.claut-header-nav .claut-nav-item[href*="descuentos"]');
        } else if (currentPage.includes('boletines')) {
          activeBottomLink = document.querySelector('.claut-bottom-nav .claut-nav-link[data-section="boletines"]');
          activeHeaderLink = document.querySelector('.claut-header-nav .claut-nav-item[href*="boletines"]');
        } else if (currentPage.includes('comite')) {
          activeBottomLink = document.querySelector('.claut-bottom-nav .claut-nav-link[data-section="comite"]');
          activeHeaderLink = document.querySelector('.claut-header-nav .claut-nav-item[href*="comite"]');
        } else if (currentPage.includes('contacto')) {
          activeBottomLink = document.querySelector('.claut-bottom-nav .claut-nav-link[data-section="contacto"]');
          activeHeaderLink = document.querySelector('.claut-header-nav .claut-nav-item[href*="contacto"]');
        } else if (currentPage.includes('eventos')) {
          activeBottomLink = document.querySelector('.claut-bottom-nav .claut-nav-link[data-section="eventos"]');
          activeHeaderLink = document.querySelector('.claut-header-nav .claut-nav-item[href*="eventos"]');
        } else if (currentPage.includes('convenio')) {
          activeBottomLink = document.querySelector('.claut-bottom-nav .claut-nav-link[data-section="convenios"]');
          activeHeaderLink = document.querySelector('.claut-header-nav .claut-nav-item[href*="convenio"]');
        } else if (currentPage.includes('admin-panel')) {
          activeBottomLink = document.querySelector('.claut-bottom-nav .claut-nav-link[data-section="admin"]');
          activeHeaderLink = document.querySelector('.claut-header-nav .claut-nav-item[href*="admin-panel"]');
        }

        // Activar los enlaces correspondientes
        if (activeBottomLink) {
          activeBottomLink.classList.add('active');
          setActiveNav(activeBottomLink);
        }
        if (activeHeaderLink) {
          activeHeaderLink.classList.add('active');
        }
      }

      // Inicializar navegación sincronizada
      syncNavigation();

      // Animaciones de entrada solo si GSAP está disponible
      if (typeof gsap !== 'undefined') {
        // Animación de entrada del menú
        gsap.fromTo('.claut-bottom-nav', {
          y: 100,
          opacity: 0
        }, {
          y: 0,
          opacity: 1,
          duration: 0.8,
          ease: "back.out(1.7)",
          delay: 0.5
        });

        // Animación escalonada de los iconos
        gsap.fromTo('.claut-bottom-nav .claut-nav-link i', {
          scale: 0,
          rotation: -180
        }, {
          scale: 1,
          rotation: 0,
          duration: 0.5,
          ease: "back.out(1.7)",
          stagger: 0.1,
          delay: 0.8
        });
      }
    });
  </script>

  <script>
    // NUEVO JAVASCRIPT PARA ESTADÍSTICAS EXPANDIBLES - CREADO DESDE CERO
    document.addEventListener('DOMContentLoaded', function () {

      // Configuración de mapeo para estadísticas dinámicas
      const statsConfig = {
        'usuarios': {
          icon: 'fas fa-users',
          label: 'Usuarios Activos',
          class: 'usuarios'
        },
        'empresas': {
          icon: 'fas fa-building',
          label: 'Empresas',
          class: 'empresas'
        },
        'convenios': {
          icon: 'fas fa-handshake',
          label: 'Convenios',
          class: 'convenios'
        },
        'mensajes': {
          icon: 'fas fa-comments',
          label: 'Mensajes',
          class: 'mensajes'
        },
        'crecimiento': {
          icon: 'fas fa-chart-line',
          label: 'Crecimiento',
          class: 'crecimiento'
        },
        'empleados': {
          icon: 'fas fa-user-tie',
          label: 'Empleados',
          class: 'empleados'
        },
        'admin': {
          icon: 'fas fa-user-shield',
          label: 'Administradores',
          class: 'admin'
        }
      };

      // Cargar estadísticas dinámicas desde la API
      async function loadDynamicStats() {
        const container = document.getElementById('estadisticasContainer');
        if (!container) {
          console.error('Contenedor estadisticasContainer no encontrado');
          return;
        }

        // Mostrar loading state
        container.innerHTML = `
          <div style="display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; color: var(--claut-text-secondary);">
            <div style="text-align: center;">
              <div style="width: 40px; height: 40px; border: 3px solid var(--claut-border-light); border-top: 3px solid var(--claut-red); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 10px;"></div>
              <p>Cargando estadísticas...</p>
            </div>
          </div>
        `;

        try {
          console.log('🔄 Cargando estadísticas desde API...');
          const response = await fetch('./api/estadisticas-simple.php');

          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }

          const data = await response.json();
          console.log('📊 Respuesta de la API:', data);

          if (data && typeof data === 'object') {
            // Transformar los datos de la API al formato esperado por el frontend
            const transformedStats = transformApiDataToStats(data);

            if (transformedStats.length > 0) {
              createStatsCards(transformedStats);
            } else {
              showNoDataMessage();
            }
          } else {
            showNoDataMessage();
          }

        } catch (error) {
          console.error('❌ Error cargando estadísticas:', error);
          showErrorMessage(error.message);
        }
      }

      // Transformar datos de API al formato esperado por el frontend
      function transformApiDataToStats(apiData) {
        const stats = [];

        // Usuarios
        if (apiData.usuarios) {
          stats.push({
            key: 'usuarios',
            titulo: 'Usuarios Activos',
            valor: apiData.usuarios.total,
            extra: apiData.usuarios
          });
        }

        // Empresas
        if (apiData.empresas) {
          stats.push({
            key: 'empresas',
            titulo: 'Empresas',
            valor: apiData.empresas.total,
            extra: apiData.empresas
          });
        }

        // Comités
        if (apiData.comites) {
          stats.push({
            key: 'comites',
            titulo: 'Comités Activos',
            valor: apiData.comites.total,
            extra: apiData.comites
          });
        }

        // Eventos
        if (apiData.eventos) {
          stats.push({
            key: 'eventos',
            titulo: 'Eventos',
            valor: apiData.eventos.total,
            extra: apiData.eventos
          });
        }

        // Descuentos
        if (apiData.descuentos) {
          stats.push({
            key: 'descuentos',
            titulo: 'Descuentos Activos',
            valor: apiData.descuentos.total,
            extra: apiData.descuentos
          });
        }

        // Boletines
        if (apiData.boletines) {
          stats.push({
            key: 'boletines',
            titulo: 'Boletines',
            valor: apiData.boletines.total,
            extra: apiData.boletines
          });
        }

        console.log('🔄 Datos transformados:', stats);
        return stats;
      }

      // Crear tarjetas con datos reales
      function createStatsCards(statsData) {
        const container = document.getElementById('estadisticasContainer');
        container.innerHTML = ''; // Limpiar contenedor

        // Aplicar estilos de contenedor para el nuevo diseño glowing
        container.className = 'glowing-stats-container';
        container.style.background = 'transparent';

        statsData.forEach((stat, index) => {
          // Determinar la clave del stat basado en el título o key
          const statKey = stat.key || stat.titulo?.toLowerCase() || `stat_${index}`;
          const config = statsConfig[statKey] || {
            icon: 'fas fa-chart-bar',
            label: stat.titulo || 'Estadística',
            class: statKey
          };

          const cardHTML = `
            <div class="glowing-stat-card ${config.class}" data-stat="${statKey}" role="button">
              <span class="glow"></span>
              <div class="stat-content">
                <span class="stat-number-badge">${stat.valor || '0'}</span>${config.label}
              </div>
            </div>
          `;
          container.innerHTML += cardHTML;
        });

        console.log('✅ Tarjetas de estadísticas creadas con diseño glowing:', statsData.length);

        // Inicializar interacciones después de crear las tarjetas
        initializeGlowingStatsInteraction();

        // Animar números después de un delay
        setTimeout(() => {
          animateNumbers();
        }, 500);
      }

      // Mostrar mensaje cuando no hay datos
      function showNoDataMessage() {
        const container = document.getElementById('estadisticasContainer');
        container.innerHTML = `
          <div style="display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; color: var(--claut-text-secondary); text-align: center;">
            <div>
              <i class="fas fa-chart-line" style="font-size: 3rem; margin-bottom: 15px; opacity: 0.5;"></i>
              <p style="margin: 0; font-size: 1.1rem;">No hay estadísticas disponibles</p>
              <p style="margin: 5px 0 0 0; font-size: 0.9rem; opacity: 0.7;">Verifique la configuración de la base de datos</p>
            </div>
          </div>
        `;
      }

      // Mostrar mensaje de error
      function showErrorMessage(errorMsg) {
        const container = document.getElementById('estadisticasContainer');
        container.innerHTML = `
          <div style="display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; color: var(--claut-text-secondary); text-align: center;">
            <div>
              <i class="fas fa-exclamation-triangle" style="font-size: 3rem; margin-bottom: 15px; color: #ff6b6b;"></i>
              <p style="margin: 0; font-size: 1.1rem;">Error al cargar estadísticas</p>
              <p style="margin: 5px 0 0 0; font-size: 0.8rem; opacity: 0.7;">${errorMsg}</p>
              <button onclick="location.reload()" style="margin-top: 15px; padding: 8px 16px; background: var(--claut-red); color: white; border: none; border-radius: 4px; cursor: pointer;">
                Reintentar
              </button>
            </div>
          </div>
        `;
      }

      // Funcionalidad de interacción para tarjetas glowing
      function initializeGlowingStatsInteraction() {
        const container = document.getElementById('estadisticasContainer');
        if (!container) return;

        container.addEventListener('click', function (e) {
          const clickedCard = e.target.closest('.glowing-stat-card');
          if (!clickedCard) return;

          // Agregar efecto de click
          clickedCard.style.transform = 'translateY(-2px) scale(0.98)';
          setTimeout(() => {
            clickedCard.style.transform = 'translateY(-2px) scale(1)';
          }, 150);

          console.log('🎯 Tarjeta glowing clickeada:', clickedCard.dataset.stat);
        });

        // Añadir efectos de hover mejorados con GSAP si está disponible
        if (typeof gsap !== 'undefined') {
          const cards = container.querySelectorAll('.glowing-stat-card');
          cards.forEach(card => {
            card.addEventListener('mouseenter', () => {
              gsap.to(card, {
                y: -8,
                scale: 1.02,
                duration: 0.3,
                ease: "power2.out"
              });
            });

            card.addEventListener('mouseleave', () => {
              gsap.to(card, {
                y: 0,
                scale: 1,
                duration: 0.3,
                ease: "power2.out"
              });
            });
          });
        }
      }

      // Funcionalidad de click para expandir tarjetas (legacy)
      function initializeStatsInteraction() {
        const container = document.getElementById('estadisticasContainer');
        if (!container) return;

        container.addEventListener('click', function (e) {
          const clickedOption = e.target.closest('.stats-option');
          if (!clickedOption) return;

          // Remover active de todas las opciones
          container.querySelectorAll('.stats-option').forEach(option => {
            option.classList.remove('active');
          });

          // Agregar active a la opción clickeada
          clickedOption.classList.add('active');

          console.log('🎯 Tarjeta clickeada:', clickedOption.dataset.stat);
        });
      }

      // Animación de números (mejorada para datos dinámicos)
      function animateNumbers() {
        const numbers = document.querySelectorAll('.stat-number-badge');

        numbers.forEach((numberElement, index) => {
          const finalValue = numberElement.textContent;

          // Solo animar si el valor no está vacío o es diferente de 0
          if (finalValue && finalValue !== '0' && finalValue !== 'undefined') {
            numberElement.textContent = '0';

            setTimeout(() => {
              animateCountUp(numberElement, finalValue);
            }, index * 200 + 500);
          }
        });
      }

      // Función de animación de conteo
      function animateCountUp(element, finalValue) {
        const duration = 1500;
        const steps = 60;
        const stepDuration = duration / steps;

        const isPercentage = finalValue.includes('%');
        const isPositive = finalValue.includes('+');
        const isNegative = finalValue.includes('-');

        let numericValue = parseFloat(finalValue.replace(/[^0-9.-]/g, '')) || 0;

        let currentStep = 0;

        const timer = setInterval(() => {
          currentStep++;
          const progress = currentStep / steps;
          const easedProgress = 1 - Math.pow(1 - progress, 3);
          const currentValue = Math.round(numericValue * easedProgress);

          let displayValue = currentValue.toLocaleString();

          if (isPercentage) {
            displayValue = (isPositive ? '+' : isNegative ? '-' : '') + displayValue + '%';
          } else if (isPositive) {
            displayValue = '+' + displayValue;
          } else if (isNegative) {
            displayValue = '-' + displayValue;
          }

          element.textContent = displayValue;

          if (currentStep >= steps) {
            clearInterval(timer);
            element.textContent = finalValue;
          }
        }, stepDuration);
      }

      // Animaciones de entrada
      function initializeEntryAnimations() {
        if (typeof gsap !== 'undefined') {
          // Eliminamos la animación de scale que causa el "agrandamiento"
          gsap.fromTo('.stats-option', {
            y: 60,
            opacity: 0
          }, {
            y: 0,
            opacity: 1,
            duration: 0.6,
            ease: "power2.out",
            stagger: 0.1,
            delay: 0.3
          });
        }
      }

      // Inicializar todo
      function initializeStats() {
        console.log('🚀 Inicializando estadísticas expandibles con datos dinámicos...');

        // 1. Cargar datos dinámicos desde la API
        loadDynamicStats();

        // 2. Animaciones de entrada
        setTimeout(() => {
          initializeEntryAnimations();
        }, 200);

        console.log('✅ Estadísticas dinámicas inicializadas correctamente');

        // Inicializar efectos de scroll después de cargar estadísticas
        setTimeout(() => {
          initializeScrollEffects();
        }, 100);
      }

      // Función para inicializar efectos de scroll
      function initializeScrollEffects() {
        console.log('🎬 Inicializando efectos de scroll...');

        // Intersection Observer para activar animaciones
        const observerOptions = {
          threshold: 0.2,
          rootMargin: '0px 0px -50px 0px'
        };

        const scrollObserver = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('animate');
            }
          });
        }, observerOptions);

        // Observar elementos para animación
        const headerReveal = document.querySelector('.stats-header-reveal');
        const cardsReveal = document.querySelector('.stats-cards-reveal');

        if (headerReveal) {
          scrollObserver.observe(headerReveal);
        }

        if (cardsReveal) {
          scrollObserver.observe(cardsReveal);
        }

        // Inicializar GSAP ScrollTrigger si está disponible
        if (typeof gsap !== 'undefined' && gsap.ScrollTrigger) {
          initializeGSAPScrollEffects();
        }

        console.log('✅ Efectos de scroll inicializados');
      }

      // Efectos avanzados con GSAP ScrollTrigger
      function initializeGSAPScrollEffects() {
        console.log('🚀 Inicializando efectos GSAP...');

        // Animación del título con gradiente
        gsap.fromTo('.stats-header-reveal h2', {
          backgroundPosition: '0% 50%'
        }, {
          backgroundPosition: '100% 50%',
          duration: 3,
          ease: 'power2.inOut',
          repeat: -1,
          yoyo: true
        });

        // Animación de las tarjetas con stagger
        const statCards = document.querySelectorAll('.glowing-stats-container .stat-card');

        gsap.set(statCards, {
          y: 60,
          opacity: 0,
          scale: 0.9
        });

        ScrollTrigger.create({
          trigger: '.stats-cards-reveal',
          start: 'top 80%',
          onEnter: () => {
            gsap.to(statCards, {
              y: 0,
              opacity: 1,
              scale: 1,
              duration: 0.8,
              stagger: 0.15,
              ease: 'power3.out'
            });
          }
        });

        // Efecto parallax en el fondo
        gsap.to('.stats-gradient-overlay', {
          y: -100,
          scrollTrigger: {
            trigger: '#estadisticas',
            start: 'top bottom',
            end: 'bottom top',
            scrub: 1
          }
        });

        // Main Gradient Background Scroll Effects
        const mainGradientBg = document.querySelector('.main-gradient-background');
        const mainParticles = document.querySelector('.main-particles-overlay');

        if (mainGradientBg && mainParticles) {
          // Parallax effect on main gradient background
          gsap.to(mainGradientBg, {
            backgroundPosition: '50% 100%',
            scale: 1.1,
            scrollTrigger: {
              trigger: '.main-scroll-container',
              start: 'top top',
              end: 'bottom bottom',
              scrub: 1
            }
          });

          // Interactive particles movement
          gsap.to(mainParticles, {
            backgroundPosition: '100px 50px',
            rotation: 5,
            scrollTrigger: {
              trigger: '.main-scroll-container',
              start: 'top top',
              end: 'bottom bottom',
              scrub: 1.5
            }
          });

          // Content sections fade in on scroll
          const contentSections = document.querySelectorAll('.main-content-wrapper > *');
          contentSections.forEach((section, index) => {
            if (section) {
              gsap.fromTo(section, {
                y: 50,
                opacity: 0.8
              }, {
                y: 0,
                opacity: 1,
                scrollTrigger: {
                  trigger: section,
                  start: 'top 85%',
                  end: 'top 20%',
                  scrub: 1,
                  toggleActions: 'play none none reverse'
                }
              });
            }
          });

          console.log('✅ Main gradient scroll effects initialized');
        }

        // Unified Content Gradient Animation
        const unifiedGradient = document.querySelector('.unified-gradient-background');
        if (unifiedGradient) {
          // Animate gradient position and opacity based on scroll
          gsap.to(unifiedGradient, {
            backgroundPosition: '200% 200%',
            scrollTrigger: {
              trigger: '.content-gradient-container',
              start: 'top bottom',
              end: 'bottom top',
              scrub: 2,
              onUpdate: (self) => {
                // Dynamic opacity based on scroll progress
                const opacity = 0.7 + (self.progress * 0.3);
                gsap.set(unifiedGradient, { opacity: opacity });
              }
            }
          });

          console.log('✅ Unified gradient scroll effects initialized');
        }

        console.log('✅ Efectos GSAP configurados');
      }

      // Initialize Swiper Carousel for Banners
      function initializeBannersSwiper() {
        console.log('🎠 Initializing Banners Swiper...');

        const swiperContainer = document.querySelector('.banners-swiper');
        if (!swiperContainer) {
          console.warn('Swiper container not found');
          return;
        }

        // Initialize expanding cards only
        window.loadBannersForExpandingCards();
      }

      // Force initialization for expanding cards
      window.addEventListener('load', () => {
        console.log('🌐 Window loaded - initializing expanding cards...');
        setTimeout(() => {
          initializeExpandingCards();
        }, 1000);
      });

      // Add to initialization
      document.addEventListener('DOMContentLoaded', () => {
        // ... existing initialization code ...
        console.log('🚀 DOM Content Loaded - starting initialization...');
        setTimeout(() => {
          console.log('⏰ Timeout reached, initializing components...');
          initializeBannersSwiper();
          initializeExpandingCards();
        }, 500);
      });

      // Initialize Expanding Cards for Banners
      function initializeExpandingCards() {
        console.log('🃏 Initializing Expanding Cards...');

        const cardsContainer = document.getElementById('expandingCardsContainer');
        if (!cardsContainer) {
          console.error('❌ Expanding cards container not found!');
          return;
        }

        console.log('✅ Container found:', cardsContainer);

        // Test API first
        testBannersAPI();

        // Only load banners from database
        loadBannersForExpandingCards();
      }

      // Test function to debug API
      async function testBannersAPI() {
        try {
          console.log('🔍 Testing banners API...');
          const response = await fetch('./api/banners.php?action=active');
          console.log('📡 API Response status:', response.status);

          const text = await response.text();
          console.log('📄 API Response text:', text.substring(0, 200) + '...');

        } catch (error) {
          console.error('❌ API Test failed:', error);
        }
      }


      function hideCardsLoading() {
        console.log('🚫 Hiding cards loading screen...');
        const loading = document.getElementById('cardsLoading');
        if (loading) {
          loading.style.display = 'none';
          console.log('✅ Cards loading screen hidden');
        } else {
          console.warn('⚠️ Cards loading screen not found');
        }
      }

      function createExpandingCards(bannersData) {
        const container = document.getElementById('expandingCardsContainer');
        if (!container) return;

        // Clear loading
        container.innerHTML = '';

        const icons = ['fas fa-star', 'fas fa-crown', 'fas fa-gem', 'fas fa-fire', 'fas fa-bolt'];

        bannersData.forEach((banner, index) => {
          console.log(`🖼️ Creating card ${index + 1} with banner:`, {
            titulo: banner.titulo,
            imagen_url: banner.imagen_url,
            descripcion: banner.descripcion
          });

          const card = document.createElement('div');
          card.className = `expanding-card ${index === 0 ? 'active' : ''}`;
          card.style.setProperty('--optionBackground', `url("${banner.imagen_url}")`);
          card.style.backgroundImage = `url("${banner.imagen_url}")`;

          card.innerHTML = ``;

          // Add double-click to expand image and single click to activate
          card.addEventListener('click', (e) => {
            if (e.detail === 1) {
              // Single click - activate card
              setActiveCard(card);
            }
          });

          card.addEventListener('dblclick', () => {
            // Double click - expand image
            openImageModal(banner.imagen_url, banner.titulo || `Banner ${index + 1}`);
          });

          container.appendChild(card);
        });

        console.log(`✅ Created ${bannersData.length} expanding cards`);
      }

      function showNoBannersMessage(message) {
        console.log(`ℹ️ Showing no banners message: ${message}`);
        const container = document.getElementById('expandingCardsContainer');
        if (!container) {
          console.error('❌ Container not found for expanding cards!');
          return;
        }

        container.innerHTML = `
          <div class="no-banners-message flex items-center justify-center h-full w-full">
            <div class="text-center">
              <div class="w-16 h-16 mx-auto mb-4 bg-gray-700/50 rounded-full flex items-center justify-center">
                <i class="fas fa-images text-2xl text-gray-400"></i>
              </div>
              <h3 class="text-lg font-semibold text-gray-300 mb-2">Sin Banners</h3>
              <p class="text-sm text-gray-400">${message}</p>
              <button onclick="window.loadBannersForExpandingCards()" class="mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all duration-200">
                <i class="fas fa-sync-alt mr-2"></i>
                Reintentar
              </button>
            </div>
          </div>
        `;

        console.log('✅ No banners message displayed');
      }

      function setActiveCard(selectedCard) {
        const allCards = document.querySelectorAll('.expanding-card');
        allCards.forEach(card => {
          card.classList.remove('active');
        });
        selectedCard.classList.add('active');
      }

      // Manual function for debugging
      window.debugExpandingCards = function () {
        console.log('🔧 Manual debug of expanding cards...');
        const container = document.getElementById('expandingCardsContainer');
        console.log('Container:', container);

        if (container) {
          console.log('Container innerHTML:', container.innerHTML.substring(0, 100));
          initializeExpandingCards();
        }
      };

      // Manual function to force show test cards
      window.forceTestCards = function () {
        console.log('🧪 Forcing test cards...');
        const container = document.getElementById('expandingCardsContainer');
        if (container) {
          container.innerHTML = `
            <div class="expanding-card active" style="background-image: url('https://picsum.photos/400/300?random=1'); min-width: 200px; flex-grow: 1;">
              <div class="card-shadow"></div>
              <div class="card-label">
                <div class="card-icon">
                  <i class="fas fa-star"></i>
                </div>
                <div class="card-info">
                  <div class="card-main">Test Card 1</div>
                  <div class="card-sub">Testing</div>
                </div>
              </div>
            </div>
          `;
        }
      };

      console.log('✅ Efectos GSAP configurados');
    }

      // Ejecutar inicialización
      initializeStats();

    });
  </script>

  <!-- Expanding Cards Functionality - INDEPENDENT SCRIPT -->
  <script>
    console.log('🎬 Starting Expanding Cards Script...');

    // Global functions for expanding cards
    window.debugExpandingCards = function () {
      console.log('🔧 Manual debug of expanding cards...');
      const container = document.getElementById('expandingCardsContainer');
      console.log('Container:', container);

      if (container) {
        console.log('Container innerHTML:', container.innerHTML.substring(0, 100));
        window.initializeExpandingCards();
      }
    };

    // Manual function to force show test cards
    window.forceTestCards = function () {
      console.log('🧪 Forcing test cards...');
      const container = document.getElementById('expandingCardsContainer');
      if (container) {
        container.innerHTML = `
          <div class="expanding-card active" style="background-image: url('https://picsum.photos/400/300?random=1'); min-width: 200px; flex-grow: 1;">
            <div class="card-shadow"></div>
            <div class="card-label">
              <div class="card-icon">
                <i class="fas fa-star"></i>
              </div>
              <div class="card-info">
                <div class="card-main">Test Card 1</div>
                <div class="card-sub">Testing</div>
              </div>
            </div>
          </div>
          <div class="expanding-card" style="background-image: url('https://picsum.photos/400/300?random=2'); min-width: 80px; flex-grow: 1;">
            <div class="card-shadow"></div>
            <div class="card-label">
              <div class="card-icon">
                <i class="fas fa-crown"></i>
              </div>
              <div class="card-info">
                <div class="card-main">Test Card 2</div>
                <div class="card-sub">Testing</div>
              </div>
            </div>
          </div>
        `;
        document.getElementById('cardsLoading').style.display = 'none';

        // Add click events
        document.querySelectorAll('.expanding-card').forEach(card => {
          card.addEventListener('click', () => {
            document.querySelectorAll('.expanding-card').forEach(c => c.classList.remove('active'));
            card.classList.add('active');
          });
        });
      }
    };

    // Initialize Expanding Cards for Banners
    window.initializeExpandingCards = function () {
      console.log('🃏 Initializing Expanding Cards...');

      const cardsContainer = document.getElementById('expandingCardsContainer');
      if (!cardsContainer) {
        console.error('❌ Expanding cards container not found!');
        return;
      }

      console.log('✅ Container found:', cardsContainer);

      // Load banners from database
      window.loadBannersForExpandingCards();

      // Minimal responsive fixes only for mobile
      setTimeout(() => {
        fixResponsiveLayout();
      }, 500);

      // Also fix on window resize
      window.addEventListener('resize', fixResponsiveLayout);
    };

    // Load banners function
    window.loadBannersForExpandingCards = async function () {
      try {
        console.log('📸 Loading banners for Expanding Cards...');
        const timestamp = Date.now();
        const response = await fetch(`./api/banners.php?action=active&t=${timestamp}`, {
          cache: 'no-cache',
          headers: {
            'Cache-Control': 'no-cache',
            'Pragma': 'no-cache'
          }
        });

        if (!response.ok) {
          console.warn(`HTTP error! status: ${response.status}`);
          window.showNoBannersMessage('Error al cargar banners del servidor');
          window.hideCardsLoading();
          return;
        }

        const responseText = await response.text();
        console.log('📄 Raw API response:', responseText.substring(0, 200) + '...');

        // Clean PHP warnings if they exist
        let cleanedResponse = responseText;
        if (responseText.includes('<br />')) {
          const jsonStart = responseText.indexOf('{');
          if (jsonStart !== -1) {
            cleanedResponse = responseText.substring(jsonStart);
          }
        }

        const result = JSON.parse(cleanedResponse);
        console.log('📊 Parsed result:', result);

        if (result.success && result.data && result.data.length > 0) {
          console.log('✅ Got real banners from database');
          window.createExpandingCards(result.data);
          window.hideCardsLoading();
        } else {
          console.warn('No banners found in database');
          window.showNoBannersMessage('No hay banners activos en la base de datos');
          window.hideCardsLoading();
        }
      } catch (error) {
        console.error('Error loading banners for Expanding Cards:', error);
        window.showNoBannersMessage('Error al procesar banners de la base de datos');
        window.hideCardsLoading();
      }
    };

    window.hideCardsLoading = function () {
      console.log('🚫 Hiding cards loading screen...');
      const loading = document.getElementById('cardsLoading');
      if (loading) {
        loading.style.display = 'none';
        console.log('✅ Cards loading screen hidden');
      } else {
        console.warn('⚠️ Cards loading screen not found');
      }
    };

    window.createExpandingCards = function (bannersData) {
      console.log('🎨 Creating expanding cards with data:', bannersData);
      const container = document.getElementById('expandingCardsContainer');
      if (!container) {
        console.error('❌ Container not found!');
        return;
      }

      // Clear loading
      container.innerHTML = '';

      const icons = ['fas fa-star', 'fas fa-crown', 'fas fa-gem', 'fas fa-fire', 'fas fa-bolt'];

      bannersData.forEach((banner, index) => {
        const card = document.createElement('div');
        card.className = `expanding-card ${index === 0 ? 'active' : ''}`;
        card.style.backgroundImage = `url("${banner.imagen_url}")`;

        card.innerHTML = ``;

        // Add double-click to expand image and single click to activate
        card.addEventListener('click', (e) => {
          if (e.detail === 1) {
            // Single click - activate card
            window.setActiveCard(card);
          }
        });

        card.addEventListener('dblclick', () => {
          // Double click - expand image
          window.openImageModal(banner.imagen_url, banner.titulo || `Banner ${index + 1}`);
        });

        container.appendChild(card);
        console.log(`📇 Added card: ${banner.titulo}`);
      });

      console.log(`✅ Created ${bannersData.length} expanding cards`);
    };

    window.showNoBannersMessage = function (message) {
      console.log(`ℹ️ Showing no banners message: ${message}`);
      const container = document.getElementById('expandingCardsContainer');
      if (!container) {
        console.error('❌ Container not found for expanding cards!');
        return;
      }

      container.innerHTML = `
        <div class="no-banners-message flex items-center justify-center h-full w-full">
          <div class="text-center">
            <div class="w-16 h-16 mx-auto mb-4 bg-gray-700/50 rounded-full flex items-center justify-center">
              <i class="fas fa-images text-2xl text-gray-400"></i>
            </div>
            <h3 class="text-lg font-semibold text-gray-300 mb-2">Sin Banners</h3>
            <p class="text-sm text-gray-400">${message}</p>
            <button onclick="window.loadBannersForExpandingCards()" class="mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all duration-200">
              <i class="fas fa-sync-alt mr-2"></i>
              Reintentar
            </button>
          </div>
        </div>
      `;

      console.log('✅ No banners message displayed');
    };

    window.setActiveCard = function (selectedCard) {
      const allCards = document.querySelectorAll('.expanding-card');
      allCards.forEach(card => {
        card.classList.remove('active');
      });
      selectedCard.classList.add('active');
    };

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', function () {
        console.log('📋 DOM ready - initializing expanding cards...');
        setTimeout(() => {
          window.initializeExpandingCards();
        }, 1000);
      });
    } else {
      console.log('📋 DOM already ready - initializing expanding cards...');
      setTimeout(() => {
        window.initializeExpandingCards();
      }, 1000);
    }

    console.log('✅ Expanding Cards Script Loaded');
    console.log('🔧 Available global functions:', {
      initializeExpandingCards: typeof window.initializeExpandingCards,
      loadBannersForExpandingCards: typeof window.loadBannersForExpandingCards,
      createExpandingCards: typeof window.createExpandingCards,
      showNoBannersMessage: typeof window.showNoBannersMessage,
      hideCardsLoading: typeof window.hideCardsLoading,
      setActiveCard: typeof window.setActiveCard,
      debugExpandingCards: typeof window.debugExpandingCards,
      forceTestCards: typeof window.forceTestCards
    });
  </script>

  <!-- Script para Preview de Imágenes del Buzón -->
  <script>
    // Función para abrir preview de imagen
    window.openImagePreview = function (imageSrc) {
      const modal = document.getElementById('imagePreviewModal');
      const previewImg = document.getElementById('previewImage');

      if (modal && previewImg) {
        previewImg.src = imageSrc;
        modal.classList.add('show');

        // Prevenir scroll del body
        document.body.style.overflow = 'hidden';
      }
    };

    // Función para cerrar preview de imagen
    window.closeImagePreview = function () {
      const modal = document.getElementById('imagePreviewModal');

      if (modal) {
        modal.classList.remove('show');

        // Restaurar scroll del body
        document.body.style.overflow = '';
      }
    };

    // Cerrar con escape o click fuera
    document.addEventListener('keydown', function (e) {
      if (e.key === 'Escape') {
        closeImagePreview();
      }
    });

    document.addEventListener('click', function (e) {
      const modal = document.getElementById('imagePreviewModal');
      if (e.target === modal) {
        closeImagePreview();
      }
    });

    // Funciones del modal de expansión de imagen para banners
    window.openImageModal = function (imageSrc, title) {
      const modal = document.getElementById('imageExpansionModal');
      const modalImg = document.getElementById('modalImage');
      const modalTitle = document.getElementById('modalImageTitle');

      if (modal && modalImg && modalTitle) {
        modalImg.src = imageSrc;
        modalTitle.textContent = title;
        modal.classList.add('show');

        // Store current image for download/share
        window.currentModalImage = {
          src: imageSrc,
          title: title
        };

        // Prevenir scroll del body
        document.body.style.overflow = 'hidden';

        // Add click outside to close
        modal.addEventListener('click', function(e) {
          if (e.target === modal) {
            closeImageModal();
          }
        });
      }
    };

    window.closeImageModal = function () {
      const modal = document.getElementById('imageExpansionModal');

      if (modal) {
        modal.classList.remove('show');

        // Restaurar scroll del body
        document.body.style.overflow = '';

        // Clear current image
        window.currentModalImage = null;
      }
    };

    window.downloadModalImage = function () {
      if (window.currentModalImage) {
        const link = document.createElement('a');
        link.href = window.currentModalImage.src;
        link.download = `${window.currentModalImage.title}.jpg`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      }
    };

    window.shareModalImage = function () {
      if (window.currentModalImage && navigator.share) {
        navigator.share({
          title: window.currentModalImage.title,
          text: `Mira esta imagen: ${window.currentModalImage.title}`,
          url: window.currentModalImage.src
        }).catch(err => console.log('Error sharing:', err));
      } else if (window.currentModalImage) {
        // Fallback - copy to clipboard
        navigator.clipboard.writeText(window.currentModalImage.src).then(() => {
          alert('URL de imagen copiada al portapapeles');
        }).catch(err => {
          console.log('Error copying to clipboard:', err);
          alert('No se pudo copiar la URL');
        });
      }
    };

    // Cerrar modal con escape
    document.addEventListener('keydown', function (e) {
      if (e.key === 'Escape') {
        closeImageModal();
        closeImagePreview();
      }
    });

    // Añadir event listeners a las imágenes del buzón
    document.addEventListener('DOMContentLoaded', function () {
      // Usar event delegation para imágenes dinámicas
      document.body.addEventListener('click', function (e) {
        if (e.target.classList.contains('mailbox-image')) {
          e.preventDefault();
          openImagePreview(e.target.src);
        }
      });
    });
  </script>

  <!-- Sistema de Seguridad de Sesión -->
  <script src="./js/session-security.js"></script>
  <script>
    // Inicializar sistema de seguridad con timeout de 5 minutos
    document.addEventListener('DOMContentLoaded', function () {
      // Configurar seguridad de sesión
      window.enableSessionSecurity();

      console.log('🔒 Sistema de seguridad de sesión activado:');
      console.log('   - Timeout de inactividad: 5 minutos');
      console.log('   - Verificación de sesión: cada 30 segundos');
      console.log('   - Detección de actividad: mouse, teclado, scroll, touch');
    });
  </script>

  <!-- FORCE FULL WIDTH LAYOUT - MODIFICADO PARA RESPETAR max-w-7xl -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Esperar un poco más para asegurar que todo esté cargado
      setTimeout(function () {
        // Aplicar estilos que RESPETEN nuestro sistema de contenedores centrados
        const style = document.createElement('style');
        style.innerHTML = `
          @media (min-width: 1025px) {
            /* RESPETAMOS max-w-7xl mx-auto - NO OVERRIDE */
            body main,
            body .claut-main {
              margin: 0 !important;
              width: 100% !important;
            }

            body .porsche-navbar {
              margin: 0 !important;
              width: 100% !important;
            }

            /* EXCLUIMOS elementos con max-w-7xl del override */
            body .px-6:not(.max-w-7xl *),
            body .px-4:not(.max-w-7xl *),
            body .px-3:not(.max-w-7xl *) {
              padding-left: 0 !important;
              padding-right: 0 !important;
            }

            /* NO tocamos mx-auto que es parte del diseño centrado */
          }
        `;
        document.head.appendChild(style);

        // JavaScript que RESPETA nuestro diseño centrado
        if (window.innerWidth >= 1025) {
          // SOLO aplicar a elementos que NO tengan max-w-7xl como padre
          const elements = document.querySelectorAll('.main-content-wrapper:not(.max-w-7xl):not(.max-w-7xl *), .content-gradient-container:not(.max-w-7xl):not(.max-w-7xl *)');
          elements.forEach(el => {
            if (el) {
              el.style.paddingLeft = '0';
              el.style.paddingRight = '0';
              el.style.marginLeft = '0';
              el.style.marginRight = '0';
              el.style.width = '100%';
            }
          });

          // Solo modificar main si NO contiene elementos max-w-7xl
          const main = document.querySelector('main, .claut-main');
          if (main && !main.querySelector('.max-w-7xl')) {
            main.style.paddingLeft = '0';
            main.style.paddingRight = '0';
            main.style.marginLeft = '0';
            main.style.marginRight = '0';
            main.style.width = '100%';
          }

          console.log('🎯 Selective layout applied - respecting max-w-7xl containers');
        }

        console.log('✅ Layout applied without breaking centered design');
      }, 1000);
    });

    // Helper function to validate image URL
    function validateImageUrl(url) {
      return new Promise((resolve, reject) => {
        if (!url) {
          reject(new Error('No URL provided'));
          return;
        }

        const img = new Image();
        img.onload = () => {
          console.log('✅ Image URL validation successful:', url);
          resolve(url);
        };
        img.onerror = () => {
          console.error('❌ Image URL validation failed:', url);
          reject(new Error(`Failed to load image: ${url}`));
        };
        img.src = url;
      });
    }

    // Banner Preview Modal Function
    window.openBannerPreview = function (imageUrl, title, description) {
      console.log(`🖼️ openBannerPreview called with:`, { imageUrl, title, description });

      // Create modal if it doesn't exist
      let modal = document.getElementById('bannerPreviewModal');
      if (!modal) {
        console.log('🆕 Creating new banner preview modal');
        modal = document.createElement('div');
        modal.id = 'bannerPreviewModal';
        modal.className = 'banner-preview-modal';
        modal.innerHTML = `
          <div class="banner-preview-content">
            <div class="banner-preview-header">
              <h3 class="banner-preview-title" id="previewTitle">Banner Preview</h3>
              <button class="banner-preview-close" onclick="closeBannerPreview()">
                <i class="fas fa-times"></i>
              </button>
            </div>
            <div class="banner-preview-image-wrapper" style="position: relative; width: 100%; height: 60vh; min-height: 400px; max-height: 600px; background: #f8f9fa; display: flex; align-items: center; justify-content: center; overflow: hidden;">
              <img class="banner-preview-image" id="previewImage" src="" alt="Banner Preview" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); max-width: 100%; max-height: 100%; width: auto; height: auto; object-fit: contain; display: none; z-index: 2;">
              <div id="bannerErrorMessage" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); display: none; text-align: center; color: #6c757d; font-size: 1.1rem; z-index: 1;">
                <div class="text-center">
                  <i class="fas fa-image fa-3x mb-3" style="opacity: 0.5;"></i>
                  <p>Imagen no disponible</p>
                  <small id="imageErrorUrl" style="font-size: 0.8rem; opacity: 0.7; word-break: break-all;"></small>
                  <br>
                  <small style="font-size: 0.7rem; opacity: 0.5; margin-top: 0.5rem;">
                    Puede ser un problema de ruta o permisos de acceso
                  </small>
                </div>
              </div>
              <div id="bannerLoadingMessage" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: #6c757d; z-index: 1;">
                <i class="fas fa-spinner fa-spin fa-2x mb-3"></i>
                <p>Cargando imagen...</p>
              </div>
            </div>
            <div class="banner-preview-info">
              <p class="banner-preview-description" id="previewDescription">Descripción del banner</p>
            </div>
          </div>
        `;
        document.body.appendChild(modal);

        // Add click outside to close
        modal.addEventListener('click', function (e) {
          if (e.target === modal) {
            closeBannerPreview();
          }
        });
      }

      // Update modal content
      const titleEl = document.getElementById('previewTitle');
      const imageEl = document.getElementById('previewImage');
      const descEl = document.getElementById('previewDescription');

      if (titleEl) titleEl.textContent = title || 'Banner Preview';
      if (imageEl) {
        console.log('🔗 Setting image URL - Original:', imageUrl);
        console.log('🔗 Type of imageUrl:', typeof imageUrl);
        console.log('🔗 Current page location:', window.location.href);

        // Use the URL exactly as it comes from the database if it's absolute
        let finalUrl = '';
        if (imageUrl && typeof imageUrl === 'string') {
          // For absolute URLs, use them directly without modification
          if (imageUrl.startsWith('http://') || imageUrl.startsWith('https://')) {
            finalUrl = imageUrl;
          } else {
            // For relative URLs, construct properly
            finalUrl = window.location.origin + (imageUrl.startsWith('/') ? imageUrl : '/' + imageUrl);
          }
        }

        console.log('🎯 Final URL to be used:', finalUrl);

        // Test the URL with fetch first to see if it's accessible
        if (finalUrl) {
          console.log('🧪 Testing image URL accessibility...');

          // Create a fetch with timeout
          const fetchWithTimeout = Promise.race([
            fetch(finalUrl, { method: 'HEAD' }),
            new Promise((_, reject) =>
              setTimeout(() => reject(new Error('Timeout')), 5000)
            )
          ]);

          fetchWithTimeout
            .then(response => {
              console.log('🌐 Fetch test result:', response.status, response.statusText);
              console.log('🌐 Response URL after fetch:', response.url);
              console.log('🌐 Response headers:', Object.fromEntries(response.headers.entries()));

              if (response.ok) {
                console.log('✅ Image URL is accessible via fetch');

                // Since fetch works but img element doesn't, fetch the image as blob
                console.log('🔄 Since img element has URL rewriting issues, loading image as blob...');
                return fetch(finalUrl).then(resp => resp.blob());
              } else {
                console.warn('⚠️ Image URL returned error:', response.status);
                if (response.status === 404) {
                  console.log('📂 File not found - image may have been deleted or moved');
                } else if (response.status === 403) {
                  console.log('🔐 Access forbidden - permission denied');
                } else if (response.status === 301 || response.status === 302) {
                  console.log('🔄 Redirect detected to:', response.url);
                }
                throw new Error(`HTTP ${response.status}`);
              }
            })
            .then(blob => {
              if (blob) {
                console.log('🎉 Image loaded as blob successfully, size:', blob.size, 'bytes');
                const blobUrl = URL.createObjectURL(blob);
                console.log('🔗 Created blob URL:', blobUrl);

                // Clear loading state and set the blob URL
                imageEl.style.background = '';
                imageEl.style.backgroundSize = '';
                imageEl.style.backgroundPosition = '';
                imageEl.style.animation = '';

                // Show image and hide loading/error messages
                console.log('🔄 Showing image and hiding other elements...');
                imageEl.style.display = 'block';

                // Hide loading message
                const loadingDiv = document.getElementById('bannerLoadingMessage');
                if (loadingDiv) {
                  loadingDiv.style.display = 'none';
                  console.log('✅ Loading message hidden');
                }

                // Hide error message
                const errorDiv = document.getElementById('bannerErrorMessage');
                if (errorDiv) {
                  errorDiv.style.display = 'none';
                  console.log('✅ Error message hidden');
                }

                // Add onload handler to confirm successful display
                imageEl.onload = function () {
                  console.log('🎯 Image element onload fired - image is now visible!');
                  console.log('🖼️ Image dimensions:', this.naturalWidth + 'x' + this.naturalHeight);

                  // The image is positioned absolutely with CSS, so just show it
                  this.style.display = 'block';
                  console.log('✅ Image displayed using absolute positioning approach');

                  // Debug to verify it's working
                  setTimeout(() => {
                    const rect = this.getBoundingClientRect();
                    console.log('📐 Image final position:', {
                      top: rect.top,
                      left: rect.left,
                      width: rect.width,
                      height: rect.height,
                      visible: rect.width > 0 && rect.height > 0
                    });
                  }, 100);
                };

                imageEl.onerror = function () {
                  console.error('❌ Blob image failed to load in img element');
                };

                // Set the blob URL
                imageEl.src = blobUrl;

                console.log('✅ Image successfully loaded via blob!');
                console.log('🔍 Image element src set to:', imageEl.src);
                console.log('🔍 Image element display:', imageEl.style.display);

                // Double-check after a short delay to ensure it's visible
                setTimeout(() => {
                  console.log('🔍 Final check - Image visible?', imageEl.style.display !== 'none');
                  console.log('🔍 Final check - Error div hidden?', errorDiv ? errorDiv.style.display === 'none' : 'N/A');
                  if (imageEl.style.display === 'none') {
                    console.warn('⚠️ Image is still hidden, forcing display...');
                    imageEl.style.display = 'block';
                  }
                }, 100);

                // Clean up the blob URL when modal closes
                const modal = document.getElementById('bannerPreviewModal');
                const cleanup = () => {
                  URL.revokeObjectURL(blobUrl);
                  console.log('🧹 Blob URL cleaned up');
                };

                // Add cleanup listener
                modal.addEventListener('transitionend', cleanup, { once: true });
              }
            })
            .catch(error => {
              console.error('❌ Fetch test failed:', error.message);

              // Clear loading state
              imageEl.style.background = '';
              imageEl.style.backgroundSize = '';
              imageEl.style.backgroundPosition = '';
              imageEl.style.animation = '';

              if (error.message.includes('CORS')) {
                console.log('🌐 CORS issue detected - trying different approach');
              } else if (error.message === 'Timeout') {
                console.log('⏱️ Request timed out - server may be slow');
              }

              console.log('❌ Showing error message instead');

              // Hide image and loading, show error
              imageEl.style.display = 'none';

              // Hide loading message
              const loadingDiv = document.getElementById('bannerLoadingMessage');
              if (loadingDiv) {
                loadingDiv.style.display = 'none';
              }

              // Show error message
              const errorDiv = document.getElementById('bannerErrorMessage');
              if (errorDiv) {
                errorDiv.style.display = 'block';
              }
            });
        } else {
          // If no URL, show error immediately
          imageEl.style.display = 'none';

          // Hide loading message
          const loadingDiv = document.getElementById('bannerLoadingMessage');
          if (loadingDiv) {
            loadingDiv.style.display = 'none';
          }

          // Show error message
          const errorDiv = document.getElementById('bannerErrorMessage');
          if (errorDiv) {
            errorDiv.style.display = 'block';
          }
        }

        // DON'T set src here - it will be set by the fetch blob logic above
        imageEl.alt = title || 'Banner Preview';

        // Set a temporary loading state
        imageEl.style.display = 'block';
        imageEl.style.background = 'linear-gradient(45deg, #f0f0f0 25%, transparent 25%), linear-gradient(-45deg, #f0f0f0 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #f0f0f0 75%), linear-gradient(-45deg, transparent 75%, #f0f0f0 75%)';
        imageEl.style.backgroundSize = '20px 20px';
        imageEl.style.backgroundPosition = '0 0, 0 10px, 10px -10px, -10px 0px';
        imageEl.style.animation = 'slide 1s linear infinite';
        console.log('🔄 Image element prepared, waiting for blob load...');

        // Reset error message display initially
        const errorDiv = imageEl.nextElementSibling;
        if (errorDiv) {
          errorDiv.style.display = 'none';
          const errorUrl = document.getElementById('imageErrorUrl');
          if (errorUrl) errorUrl.textContent = finalUrl || 'URL no disponible';
        }
      }
      if (descEl) descEl.textContent = description || 'Sin descripción disponible';

      // Show modal with animation
      modal.classList.add('show');
      document.body.style.overflow = 'hidden'; // Prevent background scrolling

      console.log(`✅ Banner preview modal opened for: ${title}`);
    };

    window.closeBannerPreview = function () {
      console.log('🔒 closeBannerPreview called');
      const modal = document.getElementById('bannerPreviewModal');
      if (modal) {
        modal.classList.remove('show');
        document.body.style.overflow = ''; // Restore scrolling
        console.log('✅ Banner preview modal closed successfully');
      } else {
        console.warn('⚠️ Banner preview modal not found');
      }
    };

    // Add ESC key and click outside handlers for banner preview
    document.addEventListener('keydown', function (e) {
      if (e.key === 'Escape') {
        const modal = document.getElementById('bannerPreviewModal');
        if (modal && modal.classList.contains('show')) {
          closeBannerPreview();
        }
      }
    });
  </script>
</body>

</html>